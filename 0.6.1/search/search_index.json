{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Home","text":""},{"location":"#freecad-robust-mcp-suite","title":"FreeCAD Robust MCP Suite","text":"<p>Welcome to the FreeCAD Robust MCP Suite documentation.</p> <p>This project provides an MCP (Model Context Protocol) server, FreeCAD workbench, and standalone macros that enable integration between AI assistants (Claude, GPT, and other MCP-compatible tools) and FreeCAD, allowing AI-assisted development and debugging of 3D models, macros, and workbenches.</p>"},{"location":"#features","title":"Features","text":"<ul> <li>82+ MCP Tools - Comprehensive CAD operations including primitives, PartDesign, booleans, export</li> <li>Multiple Connection Modes - XML-RPC (recommended), JSON-RPC socket, or embedded (Linux only)</li> <li>GUI &amp; Headless Support - Full modeling in headless mode, plus screenshots/colors in GUI mode</li> <li>Macro Development - Create, edit, run, and template FreeCAD macros via MCP</li> <li>Standalone Macros - Useful FreeCAD macros that work independently of the Robust MCP Server</li> </ul>"},{"location":"#quick-start","title":"Quick Start","text":"<pre><code># Install the Robust MCP Server\npip install freecad-robust-mcp\n\n# Install the workbench via FreeCAD Addon Manager\n# (search for \"Robust MCP\" - the package is \"FreeCAD Robust MCP Suite\")\n\n# Start FreeCAD and switch to the \"Robust MCP Bridge\" workbench\n# Click \"Start Bridge\" in the toolbar\n\n# Configure your MCP client and start building!\n</code></pre> <p>See Installation for detailed setup instructions.</p>"},{"location":"#connection-modes","title":"Connection Modes","text":"Mode Description Platform <code>xmlrpc</code> XML-RPC protocol (port 9875) All platforms (recommended) <code>socket</code> JSON-RPC socket (port 9876) All platforms <code>embedded</code> In-process FreeCAD Linux only <p>See Connection Modes for details on choosing the right mode.</p>"},{"location":"#gui-vs-headless-mode","title":"GUI vs Headless Mode","text":"<p>The Robust MCP Server works with FreeCAD in both GUI and headless mode:</p> Feature Headless GUI Object creation Yes Yes Boolean operations Yes Yes Export (STEP, STL, etc.) Yes Yes Screenshots No Yes Object colors/visibility No Yes Camera control No Yes"},{"location":"#freecad-macros","title":"FreeCAD Macros","text":"<p>This project includes standalone FreeCAD macros:</p> <ul> <li>CutObjectForMagnets - Cuts objects along planes with automatic magnet hole placement</li> <li>MultiExport - Export objects to multiple formats simultaneously</li> </ul>"},{"location":"#documentation","title":"Documentation","text":"Section Description Getting Started Installation, configuration, and quick start User Guide Connection modes, workbench, macros, and tools Tools Reference Complete API reference for all 82+ MCP tools API Reference Python API documentation Development Contributing, architecture, and development setup Comparison Compare with other FreeCAD MCP implementations"},{"location":"#links","title":"Links","text":"<ul> <li>GitHub Repository - Source code and issue tracker</li> <li>PyPI Package - Python package for pip installation</li> <li>Docker Hub - Pre-built Docker images</li> </ul> <p>Share This Documentation</p> <p>Direct link: https://spkane.github.io/freecad-robust-mcp-and-more/</p>"},{"location":"COMPARISON/","title":"Other Implementations","text":""},{"location":"COMPARISON/#freecad-robust-mcp-server-comparison-analysis","title":"FreeCAD Robust MCP Server Comparison Analysis","text":"<p>This document analyzes existing FreeCAD Robust MCP server implementations to identify best practices and improvements for our architecture.</p>"},{"location":"COMPARISON/#existing-implementations","title":"Existing Implementations","text":""},{"location":"COMPARISON/#1-neka-natfreecad-mcp-380-stars","title":"1. neka-nat/freecad-mcp (380+ stars)","text":"<p>Architecture:</p> <ul> <li>XML-RPC server running inside FreeCAD (port 9875)</li> <li>Queue-based GUI communication for thread safety</li> <li>FastMCP-based MCP server connecting via XML-RPC</li> </ul> <p>Key Features:</p> <ul> <li><code>create_object()</code> supports Part::, Draft::, PartDesign::, Fem:: types</li> <li><code>get_view()</code> captures screenshots with multiple perspectives</li> <li><code>insert_part_from_library()</code> for part library access</li> <li>Smart screenshot handling (detects unsupported views like TechDraw)</li> </ul> <p>Strengths:</p> <ul> <li>Thread-safe queue system for GUI operations</li> <li>Comprehensive object type support</li> <li>Screenshot capabilities with view selection</li> <li>Parts library integration</li> </ul> <p>Weaknesses:</p> <ul> <li>XML-RPC only (no embedded/headless mode)</li> <li>No macro development tools</li> <li>Limited debugging capabilities</li> </ul>"},{"location":"COMPARISON/#2-jango-blockchainedmcp-freecad","title":"2. jango-blockchained/mcp-freecad","text":"<p>Architecture:</p> <ul> <li>6 connection modes: Launcher, Server, Bridge, RPC, Wrapper, Mock</li> <li>FastMCP 2.13.0+ with FastAPI integration</li> <li>Multi-provider AI support (Claude, OpenAI, Google, OpenRouter)</li> </ul> <p>Key Features:</p> <ul> <li>AppImage/AppRun launcher integration</li> <li>Connection recovery mechanisms</li> <li>Resource caching and performance diagnostics</li> <li>Modern GUI addon with real-time diagnostics</li> </ul> <p>Strengths:</p> <ul> <li>Most flexible connection options</li> <li>Multi-AI provider support</li> <li>Performance monitoring</li> <li>Connection recovery/resilience</li> </ul> <p>Weaknesses:</p> <ul> <li>Complex setup with many moving parts</li> <li>Heavier dependency footprint</li> </ul>"},{"location":"COMPARISON/#3-contextformfreecad-mcp","title":"3. contextform/freecad-mcp","text":"<p>Architecture:</p> <ul> <li>Node.js-based MCP bridge (<code>working_bridge.py</code>)</li> <li>AICopilot workbench integrated into FreeCAD</li> <li>Cross-platform installer (<code>freecad-mcp-setup</code>)</li> </ul> <p>Key Features:</p> <ul> <li>13 PartDesign operations (Pad, Revolution, Fillet, Chamfer, etc.)</li> <li>18 Part operations (Primitives, Booleans, Transforms)</li> <li>14 View control tools</li> <li>Automated installer with OS detection</li> </ul> <p>Strengths:</p> <ul> <li>Most comprehensive CAD operation coverage</li> <li>Excellent PartDesign/Part workbench integration</li> <li>Easy installation process</li> <li>Demo showcasing full workflow (house modeling)</li> </ul> <p>Weaknesses:</p> <ul> <li>Node.js dependency adds complexity</li> <li>Less focus on debugging/development workflows</li> </ul>"},{"location":"COMPARISON/#4-atoi-mingfreecad-mcp","title":"4. ATOI-Ming/FreeCAD-MCP","text":"<p>Architecture:</p> <ul> <li>Server-client with stdio/TCP (port 9876)</li> <li>GUI control panel inside FreeCAD</li> <li>Macro-centric workflow</li> </ul> <p>Key Features:</p> <ul> <li>Macro templates (default, basic, part, sketch)</li> <li>Automatic import injection in macros</li> <li>Macro validation before execution</li> <li>View control (front, top, right, axonometric)</li> <li>Log management and report browser</li> </ul> <p>Strengths:</p> <ul> <li>Focus on macro development workflow</li> <li>GUI panel for easy control</li> <li>Automatic boilerplate injection</li> <li>Comprehensive logging</li> </ul> <p>Weaknesses:</p> <ul> <li>Macro-only focus (no direct object creation)</li> <li>Windows-centric paths in documentation</li> </ul>"},{"location":"COMPARISON/#5-bonninrfreecad_mcp","title":"5. bonninr/freecad_mcp","text":"<p>Architecture:</p> <ul> <li>Simple socket-based server</li> <li>Two primary tools: <code>get_scene_info</code> and <code>run_script</code></li> </ul> <p>Key Features:</p> <ul> <li>Comprehensive scene information retrieval</li> <li>Arbitrary Python code execution</li> <li>Minimal, focused API</li> </ul> <p>Strengths:</p> <ul> <li>Simple, easy to understand</li> <li>Full Python access via <code>run_script</code></li> <li>Lightweight</li> </ul> <p>Weaknesses:</p> <ul> <li>Very minimal tool set</li> <li>No specialized CAD operations</li> </ul>"},{"location":"COMPARISON/#feature-comparison-matrix","title":"Feature Comparison Matrix","text":"Feature neka-nat jango contextform ATOI-Ming bonninr Ours Headless mode No Yes No No No Yes GUI mode Yes Yes Yes Yes Yes Yes XML-RPC Yes Yes No No No Yes Socket/TCP No Yes No Yes Yes Yes Embedded Python No No No No No Yes Screenshot capture Yes Yes Yes No No Yes Parts library Yes No No No No Yes Macro support No No No Yes No Yes PartDesign tools Basic Yes Yes Via macro No Yes Boolean operations Yes Yes Yes Via macro No Yes FEM support Yes No No No No Yes Multi-AI provider No Yes No No No No Connection recovery No Yes No No No Yes Thread-safe GUI ops Yes Yes Unknown Unknown Unknown Yes MCP Resources No No No No No Yes MCP Prompts No No No No No Yes"},{"location":"COMPARISON/#key-learnings-improvements-for-our-architecture","title":"Key Learnings &amp; Improvements for Our Architecture","text":""},{"location":"COMPARISON/#1-communication-protocol","title":"1. Communication Protocol","text":"<p>Learning: neka-nat uses XML-RPC which is proven and reliable.</p> <p>Improvement: Support both XML-RPC (for compatibility) and JSON-RPC over sockets (simpler, more modern). Add embedded mode for true headless operation.</p>"},{"location":"COMPARISON/#2-thread-safe-gui-operations","title":"2. Thread-Safe GUI Operations","text":"<p>Learning: neka-nat's queue-based system is essential for GUI stability.</p> <p>Improvement: Implement similar queue system with Qt timer for main thread execution:</p> <pre><code># Queue-based GUI communication\nrpc_request_queue = queue.Queue()\nrpc_response_queue = queue.Queue()\n\ndef process_gui_tasks():\n    \"\"\"Execute queued operations on main GUI thread.\"\"\"\n    while not rpc_request_queue.empty():\n        task = rpc_request_queue.get()\n        result = task()\n        rpc_response_queue.put(result)\n</code></pre>"},{"location":"COMPARISON/#3-screenshot-capabilities","title":"3. Screenshot Capabilities","text":"<p>Learning: neka-nat handles unsupported view types gracefully.</p> <p>Improvement: Add comprehensive view support with intelligent fallbacks:</p> <ul> <li>Multiple view angles (Isometric, Front, Top, Right, etc.)</li> <li>View type detection (skip TechDraw, Spreadsheet)</li> <li>Configurable resolution and format</li> </ul>"},{"location":"COMPARISON/#4-macro-development-focus","title":"4. Macro Development Focus","text":"<p>Learning: ATOI-Ming's macro-centric approach is unique and valuable.</p> <p>Improvement: Add dedicated macro tools:</p> <ul> <li><code>create_macro</code> with templates</li> <li><code>validate_macro</code> for syntax checking</li> <li><code>run_macro</code> with parameter passing</li> <li>Automatic import injection</li> </ul>"},{"location":"COMPARISON/#5-partdesign-integration","title":"5. PartDesign Integration","text":"<p>Learning: contextform has the most comprehensive PartDesign coverage.</p> <p>Improvement: Add specialized PartDesign tools:</p> <ul> <li>Pad, Pocket, Revolution, Groove</li> <li>Fillet, Chamfer</li> <li>Hole (with standards support)</li> <li>LinearPattern, PolarPattern</li> <li>Mirrored</li> </ul>"},{"location":"COMPARISON/#6-connection-resilience","title":"6. Connection Resilience","text":"<p>Learning: jango-blockchained has connection recovery mechanisms.</p> <p>Improvement: Add connection health monitoring and auto-reconnect:</p> <pre><code>async def maintain_connection(self):\n    \"\"\"Background task to maintain connection health.\"\"\"\n    while self._running:\n        if not await self.is_connected():\n            await self.reconnect()\n        await asyncio.sleep(5)\n</code></pre>"},{"location":"COMPARISON/#7-parts-library-integration","title":"7. Parts Library Integration","text":"<p>Learning: neka-nat provides access to FreeCAD parts library.</p> <p>Improvement: Expose parts library with search and filtering.</p>"},{"location":"COMPARISON/#8-comprehensive-logging","title":"8. Comprehensive Logging","text":"<p>Learning: ATOI-Ming has excellent logging with GUI browser.</p> <p>Improvement: Add structured logging with levels, rotation, and optional GUI viewer in plugin.</p>"},{"location":"COMPARISON/#updated-architecture-decisions","title":"Updated Architecture Decisions","text":"<p>Based on this analysis, our architecture will:</p> <ol> <li> <p>Support 3 connection modes:</p> </li> <li> <p>Embedded (headless, in-process FreeCAD)</p> </li> <li>XML-RPC (proven, compatible with neka-nat addon)</li> <li> <p>JSON-RPC over socket (modern, simpler)</p> </li> <li> <p>Implement queue-based GUI thread safety following neka-nat's pattern</p> </li> <li> <p>Provide comprehensive tool coverage:</p> </li> <li> <p>Execution: Python, macros</p> </li> <li>Documents: create, open, save, list</li> <li>Objects: create, edit, delete, query</li> <li>PartDesign: pad, pocket, fillet, chamfer, patterns</li> <li>Part: primitives, booleans, transforms</li> <li>Export: STEP, STL, OBJ, FreeCAD native</li> <li> <p>View: screenshot, camera control</p> </li> <li> <p>Add unique features:</p> </li> <li> <p>MCP Resources for document introspection</p> </li> <li>MCP Prompts for guided workflows</li> <li>Macro development toolkit</li> <li> <p>Workbench-specific tools</p> </li> <li> <p>Focus on developer experience:</p> </li> <li> <p>Debugging tools</p> </li> <li>Error introspection</li> <li>Console history access</li> <li>Constraint validation</li> </ol>"},{"location":"COMPARISON/#sources","title":"Sources","text":"<ul> <li>neka-nat/freecad-mcp</li> <li>jango-blockchained/mcp-freecad</li> <li>contextform/freecad-mcp</li> <li>ATOI-Ming/FreeCAD-MCP</li> <li>bonninr/freecad_mcp</li> </ul>"},{"location":"MCP_TOOLS_REFERENCE/","title":"Tools Reference","text":""},{"location":"MCP_TOOLS_REFERENCE/#freecad-robust-mcp-server-tools-reference","title":"FreeCAD Robust MCP Server Tools Reference","text":"<p>This document provides a comprehensive reference for all MCP tools available in the FreeCAD Robust MCP Server.</p>"},{"location":"MCP_TOOLS_REFERENCE/#overview","title":"Overview","text":"<p>The FreeCAD Robust MCP Server exposes tools organized into the following categories:</p> Category Description Tool Count Execution Python execution and system info 5 Documents Document management 7 Objects Object creation and manipulation 22 PartDesign Parametric solid modeling 20 Export Import/export operations 7 View View control and screenshots 18 Macros Macro management 6 Total 85"},{"location":"MCP_TOOLS_REFERENCE/#execution-tools","title":"Execution Tools","text":"<p>Tools for executing Python code and getting system information.</p>"},{"location":"MCP_TOOLS_REFERENCE/#execute_python","title":"execute_python","text":"<p>Execute arbitrary Python code in FreeCAD's context.</p> <pre><code>execute_python(\n    code: str,\n    timeout_ms: int = 30000\n) -&gt; dict\n</code></pre> <p>Parameters:</p> <ul> <li><code>code</code>: Python code to execute. Use <code>_result_ = value</code> to return data.</li> <li><code>timeout_ms</code>: Maximum execution time in milliseconds.</li> </ul> <p>Returns: Execution result with stdout, stderr, and any assigned <code>_result_</code>.</p> <p>Example:</p> <pre><code>await execute_python('''\nimport Part\nbox = Part.makeBox(10, 20, 30)\n_result_ = {\"volume\": box.Volume}\n''')\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#get_freecad_version","title":"get_freecad_version","text":"<p>Get FreeCAD version and build information.</p> <pre><code>get_freecad_version() -&gt; dict\n</code></pre> <p>Returns: Version string, build date, Python version, GUI availability.</p>"},{"location":"MCP_TOOLS_REFERENCE/#get_connection_status","title":"get_connection_status","text":"<p>Get the current bridge connection status.</p> <pre><code>get_connection_status() -&gt; dict\n</code></pre> <p>Returns: Connection state, mode (xmlrpc/socket/embedded), latency.</p>"},{"location":"MCP_TOOLS_REFERENCE/#get_console_output","title":"get_console_output","text":"<p>Get recent FreeCAD console output.</p> <pre><code>get_console_output(lines: int = 100) -&gt; list[str]\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#get_mcp_server_environment","title":"get_mcp_server_environment","text":"<p>Get environment information about the Robust MCP Server process. Useful for identifying the Robust MCP Server instance via the unique <code>instance_id</code>.</p> <pre><code>get_mcp_server_environment() -&gt; dict\n</code></pre> <p>Returns: Dictionary containing:</p> <ul> <li><code>instance_id</code>: Unique UUID for this server instance (generated at startup)</li> <li><code>hostname</code>: Server hostname</li> <li><code>os_name</code>: Operating system name (e.g., \"Linux\", \"Darwin\", \"Windows\")</li> <li><code>os_version</code>: OS version/release</li> <li><code>platform</code>: Full platform string</li> <li><code>python_version</code>: Python version</li> <li><code>freecad</code>: FreeCAD connection information (connected, mode, version, gui_available, is_headless)</li> <li><code>env_vars</code>: Selected environment variables (FREECAD_MODE, ports, host)</li> </ul>"},{"location":"MCP_TOOLS_REFERENCE/#document-tools","title":"Document Tools","text":"<p>Tools for managing FreeCAD documents.</p>"},{"location":"MCP_TOOLS_REFERENCE/#list_documents","title":"list_documents","text":"<p>List all open documents.</p> <pre><code>list_documents() -&gt; list[dict]\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#get_active_document","title":"get_active_document","text":"<p>Get the currently active document.</p> <pre><code>get_active_document() -&gt; dict | None\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#create_document","title":"create_document","text":"<p>Create a new document.</p> <pre><code>create_document(\n    name: str = \"Unnamed\",\n    label: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#open_document","title":"open_document","text":"<p>Open an existing FreeCAD file.</p> <pre><code>open_document(path: str) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#save_document","title":"save_document","text":"<p>Save a document.</p> <pre><code>save_document(\n    doc_name: str | None = None,\n    path: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#close_document","title":"close_document","text":"<p>Close a document.</p> <pre><code>close_document(\n    doc_name: str | None = None,\n    save_changes: bool = False\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#recompute_document","title":"recompute_document","text":"<p>Recompute all objects in a document.</p> <pre><code>recompute_document(doc_name: str | None = None) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#object-tools","title":"Object Tools","text":"<p>Tools for creating and manipulating FreeCAD objects.</p>"},{"location":"MCP_TOOLS_REFERENCE/#primitive-creation","title":"Primitive Creation","text":""},{"location":"MCP_TOOLS_REFERENCE/#create_box","title":"create_box","text":"<p>Create a parametric box.</p> <pre><code>create_box(\n    length: float = 10.0,\n    width: float = 10.0,\n    height: float = 10.0,\n    name: str | None = None,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#create_cylinder","title":"create_cylinder","text":"<p>Create a parametric cylinder.</p> <pre><code>create_cylinder(\n    radius: float = 5.0,\n    height: float = 10.0,\n    angle: float = 360.0,  # For partial cylinders\n    name: str | None = None,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#create_sphere","title":"create_sphere","text":"<p>Create a parametric sphere.</p> <pre><code>create_sphere(\n    radius: float = 5.0,\n    name: str | None = None,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#create_cone","title":"create_cone","text":"<p>Create a parametric cone.</p> <pre><code>create_cone(\n    radius1: float = 5.0,   # Bottom radius\n    radius2: float = 0.0,   # Top radius (0 = pointed)\n    height: float = 10.0,\n    angle: float = 360.0,\n    name: str | None = None,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#create_torus","title":"create_torus","text":"<p>Create a torus (donut shape).</p> <pre><code>create_torus(\n    radius1: float = 10.0,  # Major radius\n    radius2: float = 2.0,   # Minor radius\n    angle1: float = -180.0,\n    angle2: float = 180.0,\n    angle3: float = 360.0,\n    name: str | None = None,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#create_wedge","title":"create_wedge","text":"<p>Create a tapered wedge shape.</p> <pre><code>create_wedge(\n    xmin: float = 0.0, ymin: float = 0.0, zmin: float = 0.0,\n    x2min: float = 2.0, z2min: float = 2.0,\n    xmax: float = 10.0, ymax: float = 10.0, zmax: float = 10.0,\n    x2max: float = 8.0, z2max: float = 8.0,\n    name: str | None = None,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#create_helix","title":"create_helix","text":"<p>Create a helix curve (for threads, springs).</p> <pre><code>create_helix(\n    pitch: float = 5.0,\n    height: float = 20.0,\n    radius: float = 5.0,\n    angle: float = 0.0,\n    left_handed: bool = False,\n    name: str | None = None,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#object-management","title":"Object Management","text":""},{"location":"MCP_TOOLS_REFERENCE/#list_objects","title":"list_objects","text":"<p>List all objects in a document.</p> <pre><code>list_objects(doc_name: str | None = None) -&gt; list[dict]\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#inspect_object","title":"inspect_object","text":"<p>Get detailed information about an object.</p> <pre><code>inspect_object(\n    object_name: str,\n    doc_name: str | None = None,\n    include_properties: bool = True,\n    include_shape: bool = True\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#create_object","title":"create_object","text":"<p>Create a generic FreeCAD object by type ID.</p> <pre><code>create_object(\n    type_id: str,  # e.g., \"Part::Box\", \"Sketcher::SketchObject\"\n    name: str | None = None,\n    properties: dict[str, Any] | None = None,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#edit_object","title":"edit_object","text":"<p>Modify object properties.</p> <pre><code>edit_object(\n    object_name: str,\n    properties: dict[str, Any],\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#delete_object","title":"delete_object","text":"<p>Delete an object.</p> <pre><code>delete_object(\n    object_name: str,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#boolean-operations","title":"Boolean Operations","text":""},{"location":"MCP_TOOLS_REFERENCE/#boolean_operation","title":"boolean_operation","text":"<p>Perform boolean operations (union, subtract, intersect).</p> <pre><code>boolean_operation(\n    operation: str,      # \"fuse\", \"cut\", or \"common\"\n    object1_name: str,\n    object2_name: str,\n    result_name: str | None = None,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre> <p>Operations:</p> <ul> <li><code>fuse</code> - Union/combine shapes</li> <li><code>cut</code> - Subtract object2 from object1</li> <li><code>common</code> - Intersection of shapes</li> </ul>"},{"location":"MCP_TOOLS_REFERENCE/#transformations","title":"Transformations","text":""},{"location":"MCP_TOOLS_REFERENCE/#set_placement","title":"set_placement","text":"<p>Set object position and rotation.</p> <pre><code>set_placement(\n    object_name: str,\n    position: list[float] | None = None,  # [x, y, z]\n    rotation: list[float] | None = None,  # [yaw, pitch, roll] in degrees\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#rotate_object","title":"rotate_object","text":"<p>Rotate object around an axis.</p> <pre><code>rotate_object(\n    object_name: str,\n    axis: list[float],      # [x, y, z] rotation axis\n    angle: float,           # Degrees\n    center: list[float] | None = None,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#scale_object","title":"scale_object","text":"<p>Scale an object (creates new copy).</p> <pre><code>scale_object(\n    object_name: str,\n    scale: float | list[float],  # Uniform or [sx, sy, sz]\n    result_name: str | None = None,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#copy_object","title":"copy_object","text":"<p>Create a copy of an object.</p> <pre><code>copy_object(\n    object_name: str,\n    new_name: str | None = None,\n    offset: list[float] | None = None,  # [x, y, z]\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#mirror_object","title":"mirror_object","text":"<p>Mirror object across a plane.</p> <pre><code>mirror_object(\n    object_name: str,\n    plane: str = \"XY\",  # \"XY\", \"XZ\", or \"YZ\"\n    result_name: str | None = None,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#selection-gui-mode","title":"Selection (GUI Mode)","text":""},{"location":"MCP_TOOLS_REFERENCE/#get_selection","title":"get_selection","text":"<p>Get currently selected objects.</p> <pre><code>get_selection(doc_name: str | None = None) -&gt; list[dict]\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#set_selection","title":"set_selection","text":"<p>Select objects programmatically.</p> <pre><code>set_selection(\n    object_names: list[str],\n    clear_existing: bool = True,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#clear_selection","title":"clear_selection","text":"<p>Clear the current selection.</p> <pre><code>clear_selection() -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#partdesign-tools","title":"PartDesign Tools","text":"<p>Tools for parametric solid modeling using the PartDesign workbench.</p>"},{"location":"MCP_TOOLS_REFERENCE/#bodies-and-sketches","title":"Bodies and Sketches","text":""},{"location":"MCP_TOOLS_REFERENCE/#create_partdesign_body","title":"create_partdesign_body","text":"<p>Create a PartDesign Body container.</p> <pre><code>create_partdesign_body(\n    name: str | None = None,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#create_sketch","title":"create_sketch","text":"<p>Create a sketch attached to a plane or body.</p> <pre><code>create_sketch(\n    body_name: str | None = None,\n    plane: str = \"XY_Plane\",  # \"XY_Plane\", \"XZ_Plane\", \"YZ_Plane\", or \"FaceN\"\n    name: str | None = None,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#sketch-geometry","title":"Sketch Geometry","text":""},{"location":"MCP_TOOLS_REFERENCE/#add_sketch_rectangle","title":"add_sketch_rectangle","text":"<p>Add a rectangle to a sketch.</p> <pre><code>add_sketch_rectangle(\n    sketch_name: str,\n    x: float, y: float,       # Bottom-left corner\n    width: float, height: float,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#add_sketch_circle","title":"add_sketch_circle","text":"<p>Add a circle to a sketch.</p> <pre><code>add_sketch_circle(\n    sketch_name: str,\n    center_x: float, center_y: float,\n    radius: float,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#add_sketch_line","title":"add_sketch_line","text":"<p>Add a line to a sketch.</p> <pre><code>add_sketch_line(\n    sketch_name: str,\n    x1: float, y1: float,  # Start point\n    x2: float, y2: float,  # End point\n    construction: bool = False,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#add_sketch_arc","title":"add_sketch_arc","text":"<p>Add an arc to a sketch.</p> <pre><code>add_sketch_arc(\n    sketch_name: str,\n    center_x: float, center_y: float,\n    radius: float,\n    start_angle: float,  # Degrees\n    end_angle: float,    # Degrees\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#add_sketch_point","title":"add_sketch_point","text":"<p>Add a point to a sketch (useful for hole centers).</p> <pre><code>add_sketch_point(\n    sketch_name: str,\n    x: float, y: float,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#additive-features","title":"Additive Features","text":""},{"location":"MCP_TOOLS_REFERENCE/#pad_sketch","title":"pad_sketch","text":"<p>Extrude a sketch to create material.</p> <pre><code>pad_sketch(\n    sketch_name: str,\n    length: float,\n    symmetric: bool = False,\n    reversed: bool = False,\n    name: str | None = None,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#revolution_sketch","title":"revolution_sketch","text":"<p>Revolve a sketch around an axis.</p> <pre><code>revolution_sketch(\n    sketch_name: str,\n    angle: float = 360.0,\n    axis: str = \"Base_X\",  # \"Base_X/Y/Z\" or \"Sketch_V/H\"\n    symmetric: bool = False,\n    reversed: bool = False,\n    name: str | None = None,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#loft_sketches","title":"loft_sketches","text":"<p>Loft through multiple sketches.</p> <pre><code>loft_sketches(\n    sketch_names: list[str],\n    ruled: bool = False,\n    closed: bool = False,\n    name: str | None = None,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#sweep_sketch","title":"sweep_sketch","text":"<p>Sweep a profile along a path.</p> <pre><code>sweep_sketch(\n    profile_sketch: str,\n    spine_sketch: str,\n    transition: str = \"Transformed\",  # \"Transformed\", \"Right\", \"Round\"\n    name: str | None = None,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#subtractive-features","title":"Subtractive Features","text":""},{"location":"MCP_TOOLS_REFERENCE/#pocket_sketch","title":"pocket_sketch","text":"<p>Cut material by extruding a sketch.</p> <pre><code>pocket_sketch(\n    sketch_name: str,\n    length: float,\n    type: str = \"Length\",  # \"Length\", \"ThroughAll\", \"UpToFirst\", \"UpToFace\"\n    name: str | None = None,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#groove_sketch","title":"groove_sketch","text":"<p>Cut material by revolving a sketch.</p> <pre><code>groove_sketch(\n    sketch_name: str,\n    angle: float = 360.0,\n    axis: str = \"Base_X\",\n    symmetric: bool = False,\n    reversed: bool = False,\n    name: str | None = None,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#create_hole","title":"create_hole","text":"<p>Create parametric holes with optional threading.</p> <pre><code>create_hole(\n    sketch_name: str,        # Sketch with center point(s)\n    diameter: float = 6.0,\n    depth: float = 10.0,\n    hole_type: str = \"Dimension\",  # \"Dimension\", \"ThroughAll\", \"UpToFirst\"\n    threaded: bool = False,\n    thread_type: str = \"ISO\",  # \"ISO\", \"UNC\", \"UNF\"\n    thread_size: str = \"M6\",\n    name: str | None = None,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#edge-operations","title":"Edge Operations","text":""},{"location":"MCP_TOOLS_REFERENCE/#fillet_edges","title":"fillet_edges","text":"<p>Add rounded edges.</p> <pre><code>fillet_edges(\n    object_name: str,\n    radius: float,\n    edges: list[str] | None = None,  # [\"Edge1\", \"Edge2\"] or None for all\n    name: str | None = None,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#chamfer_edges","title":"chamfer_edges","text":"<p>Add beveled edges.</p> <pre><code>chamfer_edges(\n    object_name: str,\n    size: float,\n    edges: list[str] | None = None,\n    name: str | None = None,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#patterns","title":"Patterns","text":""},{"location":"MCP_TOOLS_REFERENCE/#linear_pattern","title":"linear_pattern","text":"<p>Repeat a feature in a linear direction.</p> <pre><code>linear_pattern(\n    feature_name: str,\n    direction: str = \"X\",  # \"X\", \"Y\", \"Z\"\n    length: float = 50.0,\n    occurrences: int = 3,\n    name: str | None = None,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#polar_pattern","title":"polar_pattern","text":"<p>Repeat a feature around an axis.</p> <pre><code>polar_pattern(\n    feature_name: str,\n    axis: str = \"Z\",  # \"X\", \"Y\", \"Z\"\n    angle: float = 360.0,\n    occurrences: int = 6,\n    name: str | None = None,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#mirrored_feature","title":"mirrored_feature","text":"<p>Mirror a feature across a plane.</p> <pre><code>mirrored_feature(\n    feature_name: str,\n    plane: str = \"XY\",  # \"XY\", \"XZ\", \"YZ\"\n    name: str | None = None,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#export-tools","title":"Export Tools","text":"<p>Tools for importing and exporting CAD files.</p>"},{"location":"MCP_TOOLS_REFERENCE/#export_step","title":"export_step","text":"<p>Export objects to STEP format.</p> <pre><code>export_step(\n    file_path: str,\n    object_names: list[str] | None = None,  # None = all visible\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#export_stl","title":"export_stl","text":"<p>Export objects to STL format (for 3D printing).</p> <pre><code>export_stl(\n    file_path: str,\n    object_names: list[str] | None = None,\n    doc_name: str | None = None,\n    mesh_tolerance: float = 0.1\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#export_3mf","title":"export_3mf","text":"<p>Export objects to 3MF format (modern 3D printing format).</p> <p>3MF (3D Manufacturing Format) supports richer data than STL, including colors, materials, and print settings. It is increasingly preferred over STL for 3D printing.</p> <pre><code>export_3mf(\n    file_path: str,\n    object_names: list[str] | None = None,\n    doc_name: str | None = None,\n    mesh_tolerance: float = 0.1\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#export_obj","title":"export_obj","text":"<p>Export objects to OBJ format.</p> <pre><code>export_obj(\n    file_path: str,\n    object_names: list[str] | None = None,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#export_iges","title":"export_iges","text":"<p>Export objects to IGES format.</p> <pre><code>export_iges(\n    file_path: str,\n    object_names: list[str] | None = None,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#import_step","title":"import_step","text":"<p>Import a STEP file.</p> <pre><code>import_step(\n    file_path: str,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#import_stl","title":"import_stl","text":"<p>Import an STL file.</p> <pre><code>import_stl(\n    file_path: str,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#view-tools","title":"View Tools","text":"<p>Tools for controlling the 3D view and capturing screenshots.</p>"},{"location":"MCP_TOOLS_REFERENCE/#screenshots","title":"Screenshots","text":""},{"location":"MCP_TOOLS_REFERENCE/#get_screenshot","title":"get_screenshot","text":"<p>Capture a screenshot of the 3D view.</p> <p>Requires GUI mode.</p> <pre><code>get_screenshot(\n    view_angle: str = \"Isometric\",\n    width: int = 800,\n    height: int = 600,\n    doc_name: str | None = None\n) -&gt; dict  # Returns base64-encoded PNG\n</code></pre> <p>View angles: <code>Isometric</code>, <code>Front</code>, <code>Back</code>, <code>Top</code>, <code>Bottom</code>, <code>Left</code>, <code>Right</code>, <code>FitAll</code></p>"},{"location":"MCP_TOOLS_REFERENCE/#view-control","title":"View Control","text":""},{"location":"MCP_TOOLS_REFERENCE/#set_view_angle","title":"set_view_angle","text":"<p>Set the 3D view angle.</p> <pre><code>set_view_angle(\n    view_angle: str,  # Same options as get_screenshot\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#fit_all","title":"fit_all","text":"<p>Fit all objects in the view.</p> <pre><code>fit_all(doc_name: str | None = None) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#zoom_in-zoom_out","title":"zoom_in / zoom_out","text":"<p>Zoom the view.</p> <p>Requires GUI mode.</p> <pre><code>zoom_in(factor: float = 1.5, doc_name: str | None = None) -&gt; dict\nzoom_out(factor: float = 1.5, doc_name: str | None = None) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#set_camera_position","title":"set_camera_position","text":"<p>Set custom camera position.</p> <p>Requires GUI mode.</p> <pre><code>set_camera_position(\n    position: list[float],     # [x, y, z]\n    look_at: list[float] | None = None,  # Default: origin\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#object-appearance","title":"Object Appearance","text":""},{"location":"MCP_TOOLS_REFERENCE/#set_object_visibility","title":"set_object_visibility","text":"<p>Show or hide an object.</p> <p>Requires GUI mode.</p> <pre><code>set_object_visibility(\n    object_name: str,\n    visible: bool,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#set_display_mode","title":"set_display_mode","text":"<p>Set object display mode.</p> <p>Requires GUI mode.</p> <pre><code>set_display_mode(\n    object_name: str,\n    mode: str,  # \"Flat Lines\", \"Shaded\", \"Wireframe\", \"Points\"\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#set_object_color","title":"set_object_color","text":"<p>Set object color.</p> <p>Requires GUI mode.</p> <pre><code>set_object_color(\n    object_name: str,\n    color: list[float],  # [r, g, b] where values are 0.0-1.0\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#workbenches","title":"Workbenches","text":""},{"location":"MCP_TOOLS_REFERENCE/#list_workbenches","title":"list_workbenches","text":"<p>List available workbenches.</p> <pre><code>list_workbenches() -&gt; list[dict]\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#activate_workbench","title":"activate_workbench","text":"<p>Activate a workbench.</p> <pre><code>activate_workbench(workbench_name: str) -&gt; dict\n</code></pre> <p>Common workbenches:</p> <ul> <li><code>PartWorkbench</code> - Part modeling</li> <li><code>PartDesignWorkbench</code> - Parametric design</li> <li><code>SketcherWorkbench</code> - 2D sketching</li> <li><code>DraftWorkbench</code> - 2D drafting</li> <li><code>MeshWorkbench</code> - Mesh operations</li> </ul>"},{"location":"MCP_TOOLS_REFERENCE/#undoredo","title":"Undo/Redo","text":""},{"location":"MCP_TOOLS_REFERENCE/#undo-redo","title":"undo / redo","text":"<p>Undo or redo operations.</p> <pre><code>undo(doc_name: str | None = None) -&gt; dict\nredo(doc_name: str | None = None) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#get_undo_redo_status","title":"get_undo_redo_status","text":"<p>Get undo/redo availability.</p> <pre><code>get_undo_redo_status(doc_name: str | None = None) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#parts-library","title":"Parts Library","text":""},{"location":"MCP_TOOLS_REFERENCE/#list_parts_library","title":"list_parts_library","text":"<p>List available library parts.</p> <pre><code>list_parts_library() -&gt; list[dict]\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#insert_part_from_library","title":"insert_part_from_library","text":"<p>Insert a part from the library.</p> <pre><code>insert_part_from_library(\n    part_path: str,\n    name: str | None = None,\n    position: list[float] | None = None,\n    doc_name: str | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#utility","title":"Utility","text":""},{"location":"MCP_TOOLS_REFERENCE/#get_console_log","title":"get_console_log","text":"<p>Get FreeCAD console output.</p> <pre><code>get_console_log(lines: int = 50) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#recompute","title":"recompute","text":"<p>Force recompute of all objects.</p> <pre><code>recompute(doc_name: str | None = None) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#macro-tools","title":"Macro Tools","text":"<p>Tools for managing FreeCAD macros.</p>"},{"location":"MCP_TOOLS_REFERENCE/#list_macros","title":"list_macros","text":"<p>List available macros.</p> <pre><code>list_macros() -&gt; list[dict]\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#run_macro","title":"run_macro","text":"<p>Execute a macro by name.</p> <pre><code>run_macro(\n    macro_name: str,\n    args: dict[str, Any] | None = None\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#create_macro","title":"create_macro","text":"<p>Create a new macro.</p> <pre><code>create_macro(\n    name: str,\n    code: str,\n    description: str = \"\"\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#read_macro","title":"read_macro","text":"<p>Read macro contents.</p> <pre><code>read_macro(macro_name: str) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#delete_macro","title":"delete_macro","text":"<p>Delete a user macro.</p> <pre><code>delete_macro(macro_name: str) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#create_macro_from_template","title":"create_macro_from_template","text":"<p>Create macro from a predefined template.</p> <pre><code>create_macro_from_template(\n    name: str,\n    template: str = \"basic\",  # \"basic\", \"part\", \"sketch\", \"gui\", \"selection\"\n    description: str = \"\"\n) -&gt; dict\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#gui-vs-headless-mode","title":"GUI vs Headless Mode","text":"<p>Some tools require FreeCAD to be running in GUI mode. When running in headless mode, these tools will return an error instead of crashing.</p> <p>GUI-only tools:</p> <ul> <li><code>get_screenshot</code></li> <li><code>set_object_visibility</code></li> <li><code>set_display_mode</code></li> <li><code>set_object_color</code></li> <li><code>zoom_in</code> / <code>zoom_out</code></li> <li><code>set_camera_position</code></li> <li><code>get_selection</code> / <code>set_selection</code> / <code>clear_selection</code></li> </ul> <p>To check mode programmatically:</p> <pre><code>result = await execute_python(\"_result_ = FreeCAD.GuiUp\")\nis_gui_mode = result[\"result\"]\n</code></pre>"},{"location":"MCP_TOOLS_REFERENCE/#error-handling","title":"Error Handling","text":"<p>All tools return dictionaries with consistent error handling:</p> <p>Success:</p> <pre><code>{\n    \"success\": True,\n    \"name\": \"Box\",\n    \"volume\": 6000.0,\n    # ... other fields\n}\n</code></pre> <p>Failure:</p> <pre><code>{\n    \"success\": False,\n    \"error\": \"Object not found: MissingBox\"\n}\n</code></pre> <p>For tools that raise exceptions, wrap calls in try/except or check the returned error field.</p>"},{"location":"USER_GUIDE/","title":"Detailed User Guide","text":""},{"location":"USER_GUIDE/#freecad-robust-mcp-user-guide","title":"FreeCAD Robust MCP User Guide","text":"<p>This guide explains how to use AI assistants with FreeCAD via the MCP (Model Context Protocol) server to create and manipulate 3D CAD models.</p>"},{"location":"USER_GUIDE/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Getting Started</li> <li>Running Modes</li> <li>Basic Workflows</li> <li>Object Creation Examples</li> <li>PartDesign Workflow</li> <li>Complete Example: Mounting Bracket</li> <li>Tips and Best Practices</li> </ol>"},{"location":"USER_GUIDE/#getting-started","title":"Getting Started","text":""},{"location":"USER_GUIDE/#prerequisites","title":"Prerequisites","text":"<ol> <li>FreeCAD installed - Version 1.0.x or later</li> <li>An MCP client (Claude Code, or other MCP-compatible AI assistant) configured</li> <li>Python 3.11 - Must match FreeCAD's bundled Python version</li> </ol>"},{"location":"USER_GUIDE/#starting-freecad-with-mcp-bridge","title":"Starting FreeCAD with MCP Bridge","text":"<p>You have two options depending on your workflow:</p>"},{"location":"USER_GUIDE/#headless-mode-command-line-only","title":"Headless Mode (Command-line only)","text":"<p>Best for automated workflows, batch processing, or when you don't need visual feedback.</p> <pre><code>just freecad::run-headless\n</code></pre> <p>Capabilities: All modeling operations, export, scripting. Limitations: No screenshots, no visual feedback, no color/visibility control.</p>"},{"location":"USER_GUIDE/#gui-mode-full-graphical-interface","title":"GUI Mode (Full graphical interface)","text":"<p>Best for interactive design work where you want to see results visually.</p> <pre><code>just freecad::run-gui\n</code></pre> <p>Capabilities: Everything headless mode can do, plus screenshots, colors, view control.</p>"},{"location":"USER_GUIDE/#verifying-connection","title":"Verifying Connection","text":"<p>Once FreeCAD is running with the MCP bridge, you can verify the connection:</p> <pre><code>\"Check the FreeCAD connection status\"\n</code></pre> <p>Claude will use the <code>get_connection_status</code> tool to confirm the bridge is working.</p>"},{"location":"USER_GUIDE/#running-modes","title":"Running Modes","text":""},{"location":"USER_GUIDE/#headless-vs-gui-mode","title":"Headless vs GUI Mode","text":"Feature Headless Mode GUI Mode Object creation Yes Yes Boolean operations Yes Yes Export (STEP, STL, etc.) Yes Yes Save documents Yes Yes Screenshots No Yes Object colors No Yes Object visibility No Yes Camera control No Yes Interactive selection No Yes"},{"location":"USER_GUIDE/#detecting-the-current-mode","title":"Detecting the Current Mode","text":"<p>When working with Claude, it will automatically detect whether FreeCAD is in GUI or headless mode and adapt accordingly. GUI-only operations will return informative errors in headless mode rather than crashing.</p>"},{"location":"USER_GUIDE/#basic-workflows","title":"Basic Workflows","text":""},{"location":"USER_GUIDE/#creating-a-document","title":"Creating a Document","text":"<p>Every FreeCAD project needs a document. You can ask Claude:</p> <pre><code>\"Create a new FreeCAD document called 'MyProject'\"\n</code></pre> <p>Claude will use the <code>create_document</code> tool.</p>"},{"location":"USER_GUIDE/#creating-simple-shapes","title":"Creating Simple Shapes","text":"<p>Ask Claude to create primitive shapes:</p> <pre><code>\"Create a box that's 50mm long, 30mm wide, and 10mm tall\"\n\"Add a cylinder with radius 5mm and height 20mm\"\n\"Create a sphere with 15mm radius\"\n</code></pre>"},{"location":"USER_GUIDE/#positioning-objects","title":"Positioning Objects","text":"<p>Move and rotate objects:</p> <pre><code>\"Move the box to position (100, 50, 0)\"\n\"Rotate the cylinder 45 degrees around the Z axis\"\n</code></pre>"},{"location":"USER_GUIDE/#boolean-operations","title":"Boolean Operations","text":"<p>Combine shapes:</p> <pre><code>\"Fuse the box and cylinder together\"\n\"Cut a hole through the box using the cylinder\"\n\"Find the intersection of the two shapes\"\n</code></pre>"},{"location":"USER_GUIDE/#saving-and-exporting","title":"Saving and Exporting","text":"<pre><code>\"Save the document as MyProject.FCStd\"\n\"Export the model to STEP format\"\n\"Export for 3D printing as STL\"\n</code></pre>"},{"location":"USER_GUIDE/#object-creation-examples","title":"Object Creation Examples","text":""},{"location":"USER_GUIDE/#example-1-simple-box-with-hole","title":"Example 1: Simple Box with Hole","text":"<p>Request:</p> <pre><code>Create a 50x50x20mm box with a 10mm diameter hole through the center.\n</code></pre> <p>What Claude does:</p> <ol> <li>Creates a document</li> <li>Creates a box (50x50x20)</li> <li>Creates a cylinder (radius 5, height 30) positioned at center</li> <li>Performs boolean cut operation</li> <li>Returns the result</li> </ol>"},{"location":"USER_GUIDE/#example-2-pipetube-shape","title":"Example 2: Pipe/Tube Shape","text":"<p>Request:</p> <pre><code>Create a pipe with outer diameter 40mm, inner diameter 30mm, and length 100mm.\n</code></pre> <p>What Claude does:</p> <ol> <li>Creates outer cylinder (radius 20, height 100)</li> <li>Creates inner cylinder (radius 15, height 100)</li> <li>Cuts inner from outer to create hollow tube</li> </ol>"},{"location":"USER_GUIDE/#example-3-l-bracket","title":"Example 3: L-Bracket","text":"<p>Request:</p> <pre><code>Create an L-shaped bracket:\n- Horizontal part: 100mm x 50mm x 5mm\n- Vertical part: 5mm x 50mm x 80mm standing on the horizontal part\n</code></pre> <p>What Claude does:</p> <ol> <li>Creates horizontal box</li> <li>Creates vertical box positioned at correct location</li> <li>Fuses them together</li> </ol>"},{"location":"USER_GUIDE/#partdesign-workflow","title":"PartDesign Workflow","text":"<p>For parametric modeling that maintains design history, use the PartDesign workflow.</p>"},{"location":"USER_GUIDE/#understanding-partdesign-concepts","title":"Understanding PartDesign Concepts","text":"<p>Body: A container for a single solid model built from features.</p> <p>Sketch: A 2D drawing that defines profiles for 3D operations.</p> <p>Features: Operations like Pad (extrude), Pocket (cut), Fillet, etc.</p>"},{"location":"USER_GUIDE/#basic-partdesign-example","title":"Basic PartDesign Example","text":"<p>Request:</p> <pre><code>Create a parametric mounting plate:\n1. Start with a PartDesign body\n2. Create a sketch on the XY plane with a 100x60mm rectangle\n3. Pad it 8mm thick\n4. Add four 5mm holes near each corner for mounting screws\n5. Fillet all edges with 2mm radius\n</code></pre> <p>What Claude does:</p> <ol> <li><code>create_partdesign_body()</code> - Creates the Body container</li> <li><code>create_sketch(body_name=\"Body\", plane=\"XY_Plane\")</code> - Creates attached sketch</li> <li><code>add_sketch_rectangle(...)</code> - Adds the profile geometry</li> <li><code>pad_sketch(sketch_name=\"Sketch\", length=8)</code> - Extrudes to solid</li> <li>Creates new sketches with points for hole locations</li> <li><code>create_hole(...)</code> for each mounting hole</li> <li><code>fillet_edges(...)</code> - Rounds the edges</li> </ol>"},{"location":"USER_GUIDE/#revolving-profiles","title":"Revolving Profiles","text":"<p>Request:</p> <pre><code>Create a turned part:\n- Draw a profile on the XZ plane\n- Revolve it 360 degrees around the X axis\n</code></pre> <p>What Claude does:</p> <ol> <li>Creates body and sketch on XZ plane</li> <li>Draws the profile using lines and arcs</li> <li>Uses <code>revolution_sketch()</code> to create the solid</li> </ol>"},{"location":"USER_GUIDE/#pattern-operations","title":"Pattern Operations","text":"<p>Request:</p> <pre><code>Create a plate with a row of 6 holes spaced 15mm apart.\n</code></pre> <p>What Claude does:</p> <ol> <li>Creates the base plate</li> <li>Creates one hole feature</li> <li>Uses <code>linear_pattern()</code> to repeat the hole</li> </ol>"},{"location":"USER_GUIDE/#complete-example-mounting-bracket","title":"Complete Example: Mounting Bracket","text":"<p>This detailed example shows a complete workflow for creating a practical part.</p>"},{"location":"USER_GUIDE/#design-requirements","title":"Design Requirements","text":"<p>Create a mounting bracket with:</p> <ul> <li>Base plate: 80mm x 60mm x 5mm</li> <li>Vertical support: 5mm thick, 50mm tall, 60mm wide</li> <li>Two mounting holes (6mm diameter) on the base</li> <li>One slot (10mm x 20mm) on the vertical support</li> <li>3mm fillets on external corners</li> </ul>"},{"location":"USER_GUIDE/#step-by-step-workflow","title":"Step-by-Step Workflow","text":""},{"location":"USER_GUIDE/#step-1-ask-claude-to-create-the-bracket","title":"Step 1: Ask Claude to create the bracket","text":"<pre><code>Create a mounting bracket with the following specifications:\n\nBase plate:\n- Size: 80mm x 60mm x 5mm\n- Two 6mm diameter mounting holes, centered 15mm from each short edge\n\nVertical support:\n- Attached to one end of the base\n- 5mm thick, 60mm wide, 50mm tall\n- One slot: 10mm wide x 20mm tall, centered\n\nFinish:\n- 3mm fillet on all outer edges\n- Export as STEP file when done\n</code></pre>"},{"location":"USER_GUIDE/#step-2-claudes-approach","title":"Step 2: Claude's approach","text":"<p>Claude will break this down into manageable operations:</p> <pre><code># 1. Create document and PartDesign body\ncreate_document(name=\"MountingBracket\")\ncreate_partdesign_body(name=\"Body\")\n\n# 2. Create base plate sketch and pad\ncreate_sketch(body_name=\"Body\", plane=\"XY_Plane\", name=\"BaseSketch\")\nadd_sketch_rectangle(sketch_name=\"BaseSketch\", x=0, y=0, width=80, height=60)\npad_sketch(sketch_name=\"BaseSketch\", length=5)\n\n# 3. Add vertical support\ncreate_sketch(body_name=\"Body\", plane=\"XZ_Plane\", name=\"SupportSketch\")\n# ... add geometry\npad_sketch(sketch_name=\"SupportSketch\", length=60)\n\n# 4. Add mounting holes\ncreate_sketch(body_name=\"Body\", plane=\"XY_Plane\", name=\"HoleSketch\")\nadd_sketch_point(sketch_name=\"HoleSketch\", x=15, y=30)\nadd_sketch_point(sketch_name=\"HoleSketch\", x=65, y=30)\ncreate_hole(sketch_name=\"HoleSketch\", diameter=6, hole_type=\"ThroughAll\")\n\n# 5. Add slot (as pocket)\ncreate_sketch(body_name=\"Body\", plane=\"Face...\", name=\"SlotSketch\")\nadd_sketch_rectangle(...)\npocket_sketch(sketch_name=\"SlotSketch\", length=5, type=\"ThroughAll\")\n\n# 6. Add fillets\nfillet_edges(object_name=\"...\", radius=3)\n\n# 7. Export\nexport_step(file_path=\"/path/to/bracket.step\")\n</code></pre>"},{"location":"USER_GUIDE/#step-3-view-the-result-gui-mode","title":"Step 3: View the result (GUI mode)","text":"<pre><code>Take a screenshot of the bracket from an isometric view\n</code></pre> <p>Claude will use <code>get_screenshot(view_angle=\"Isometric\")</code> to capture and display the result.</p>"},{"location":"USER_GUIDE/#tips-and-best-practices","title":"Tips and Best Practices","text":""},{"location":"USER_GUIDE/#1-be-specific-with-dimensions","title":"1. Be Specific with Dimensions","text":"<p>Good: \"Create a box 50mm x 30mm x 10mm\"</p> <p>Vague: \"Create a small box\"</p>"},{"location":"USER_GUIDE/#2-specify-units","title":"2. Specify Units","text":"<p>FreeCAD uses millimeters by default. Always include units to avoid confusion:</p> <pre><code>\"Create a cylinder with 25.4mm (1 inch) diameter\"\n</code></pre>"},{"location":"USER_GUIDE/#3-use-meaningful-names","title":"3. Use Meaningful Names","text":"<pre><code>\"Create a box named 'BasePlate' and a cylinder named 'MountingHole'\"\n</code></pre> <p>This makes it easier to reference objects later.</p>"},{"location":"USER_GUIDE/#4-work-incrementally","title":"4. Work Incrementally","text":"<p>For complex parts, build step by step:</p> <ol> <li>Create the basic shape</li> <li>Verify it looks correct</li> <li>Add features one at a time</li> <li>Check after each major operation</li> </ol>"},{"location":"USER_GUIDE/#5-save-frequently","title":"5. Save Frequently","text":"<pre><code>\"Save the document\"\n</code></pre> <p>FreeCAD can crash, and you don't want to lose work.</p>"},{"location":"USER_GUIDE/#6-use-partdesign-for-parametric-parts","title":"6. Use PartDesign for Parametric Parts","text":"<p>If you might need to modify dimensions later, use the PartDesign workflow with sketches rather than direct Part operations.</p>"},{"location":"USER_GUIDE/#7-export-to-multiple-formats","title":"7. Export to Multiple Formats","text":"<p>For manufacturing or 3D printing:</p> <pre><code>\"Export as STEP for CNC machining and STL for 3D printing\"\n</code></pre>"},{"location":"USER_GUIDE/#8-use-the-execute_python-tool-for-advanced-operations","title":"8. Use the execute_python Tool for Advanced Operations","text":"<p>For operations not covered by the standard tools, Claude can execute custom Python:</p> <pre><code>\"Calculate the volume and center of mass of the part\"\n</code></pre> <p>Claude will use <code>execute_python()</code> to run the necessary FreeCAD Python commands.</p>"},{"location":"USER_GUIDE/#9-check-gui-mode-for-visual-features","title":"9. Check GUI Mode for Visual Features","text":"<p>Before asking for screenshots or colors:</p> <pre><code>\"Is FreeCAD running in GUI mode?\"\n</code></pre>"},{"location":"USER_GUIDE/#10-use-patterns-for-repetitive-features","title":"10. Use Patterns for Repetitive Features","text":"<p>Instead of creating many individual features:</p> <pre><code>\"Create one hole and pattern it in a 4x3 grid with 20mm spacing\"\n</code></pre>"},{"location":"USER_GUIDE/#common-operations-quick-reference","title":"Common Operations Quick Reference","text":"Task How to Ask Create box \"Create a box 50x30x10mm\" Create cylinder \"Create a cylinder with 10mm radius and 20mm height\" Move object \"Move MyBox to position (100, 50, 0)\" Rotate object \"Rotate MyCylinder 45 degrees around Z axis\" Boolean union \"Fuse Box and Cylinder together\" Boolean subtract \"Cut Cylinder from Box\" Create hole \"Add a 6mm through hole at (25, 15)\" Fillet edges \"Add 3mm fillet to all edges\" Chamfer edges \"Add 2mm chamfer to selected edges\" Export STEP \"Export to STEP format\" Export STL \"Export for 3D printing\" Save document \"Save the document as MyPart.FCStd\" Screenshot \"Take a screenshot from the front view\" (GUI mode only) Change color \"Make the box red\" (GUI mode only)"},{"location":"USER_GUIDE/#troubleshooting","title":"Troubleshooting","text":""},{"location":"USER_GUIDE/#gui-not-available-error","title":"\"GUI not available\" Error","text":"<p>You're running in headless mode and trying to use a GUI-only feature. Either:</p> <ul> <li>Switch to GUI mode: <code>just freecad::run-gui</code></li> <li>Use an alternative approach (e.g., skip visual operations)</li> </ul>"},{"location":"USER_GUIDE/#objects-not-appearing","title":"Objects Not Appearing","text":"<p>Make sure to recompute the document:</p> <pre><code>\"Recompute the document\"\n</code></pre>"},{"location":"USER_GUIDE/#boolean-operations-failing","title":"Boolean Operations Failing","text":"<p>Ensure:</p> <ol> <li>Both objects have valid shapes</li> <li>The objects actually intersect</li> <li>Objects are in the same document</li> </ol>"},{"location":"USER_GUIDE/#sketch-errors","title":"Sketch Errors","text":"<p>Sketches need to be fully constrained for PartDesign operations. Ask Claude to:</p> <pre><code>\"Check if the sketch is fully constrained\"\n</code></pre>"},{"location":"USER_GUIDE/#connection-issues","title":"Connection Issues","text":"<p>If the MCP bridge isn't responding:</p> <ol> <li>Check FreeCAD is running with the bridge started</li> <li>Verify ports 9875 (XML-RPC) and 9876 (socket) are available</li> <li>Restart FreeCAD with <code>just freecad::run-gui</code> or <code>just freecad::run-headless</code></li> </ol>"},{"location":"USER_GUIDE/#next-steps","title":"Next Steps","text":"<ul> <li>See MCP_TOOLS_REFERENCE.md for detailed API documentation</li> <li>Explore the FreeCAD wiki for advanced techniques</li> <li>Practice with simple parts before attempting complex assemblies</li> </ul>"},{"location":"api/bridge/","title":"Bridge","text":""},{"location":"api/bridge/#bridge-api-reference","title":"Bridge API Reference","text":"<p>The bridge module provides the communication layer between the Robust MCP Server and FreeCAD.</p>"},{"location":"api/bridge/#base-classes","title":"Base Classes","text":"<p>options: show_root_heading: true show_source: true</p>"},{"location":"api/bridge/#freecad_mcp.bridge.base","title":"<code>freecad_mcp.bridge.base</code>","text":"<p>Abstract bridge interface for FreeCAD communication.</p> <p>This module defines the abstract base class and data types for all FreeCAD bridge implementations. Bridges provide the communication layer between the Robust MCP Server and FreeCAD instances.</p> <p>Based on learnings from existing implementations: - neka-nat: Queue-based thread safety for GUI operations - jango: Multiple connection modes with recovery - contextform: Comprehensive CAD operations</p>"},{"location":"api/bridge/#freecad_mcp.bridge.base-classes","title":"Classes","text":""},{"location":"api/bridge/#freecad_mcp.bridge.base.ConnectionStatus","title":"<code>ConnectionStatus</code>  <code>dataclass</code>","text":"<p>Status of the FreeCAD connection.</p> <p>Attributes:</p> Name Type Description <code>connected</code> <code>bool</code> <p>Whether connection is established.</p> <code>mode</code> <code>str</code> <p>Connection mode (embedded, xmlrpc, socket).</p> <code>freecad_version</code> <code>str</code> <p>FreeCAD version string.</p> <code>gui_available</code> <code>bool</code> <p>Whether GUI is available.</p> <code>last_ping_ms</code> <code>float</code> <p>Last ping latency in milliseconds.</p> <code>error</code> <code>str | None</code> <p>Connection error message if any.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@dataclass\nclass ConnectionStatus:\n    \"\"\"Status of the FreeCAD connection.\n\n    Attributes:\n        connected: Whether connection is established.\n        mode: Connection mode (embedded, xmlrpc, socket).\n        freecad_version: FreeCAD version string.\n        gui_available: Whether GUI is available.\n        last_ping_ms: Last ping latency in milliseconds.\n        error: Connection error message if any.\n    \"\"\"\n\n    connected: bool\n    mode: str\n    freecad_version: str = \"\"\n    gui_available: bool = False\n    last_ping_ms: float = 0\n    error: str | None = None\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.DocumentInfo","title":"<code>DocumentInfo</code>  <code>dataclass</code>","text":"<p>Information about a FreeCAD document.</p> <p>Attributes:</p> Name Type Description <code>name</code> <code>str</code> <p>Internal document name (identifier).</p> <code>label</code> <code>str</code> <p>Display label (may differ from name).</p> <code>path</code> <code>str | None</code> <p>File path if saved, None otherwise.</p> <code>objects</code> <code>list[str]</code> <p>List of object names in the document.</p> <code>is_modified</code> <code>bool</code> <p>Whether document has unsaved changes.</p> <code>active_object</code> <code>str | None</code> <p>Name of the currently active object.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@dataclass\nclass DocumentInfo:\n    \"\"\"Information about a FreeCAD document.\n\n    Attributes:\n        name: Internal document name (identifier).\n        label: Display label (may differ from name).\n        path: File path if saved, None otherwise.\n        objects: List of object names in the document.\n        is_modified: Whether document has unsaved changes.\n        active_object: Name of the currently active object.\n    \"\"\"\n\n    name: str\n    label: str = \"\"\n    path: str | None = None\n    objects: list[str] = field(default_factory=list)\n    is_modified: bool = False\n    active_object: str | None = None\n\n    def __post_init__(self) -&gt; None:\n        \"\"\"Set label to name if not provided.\"\"\"\n        if not self.label:\n            self.label = self.name\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.DocumentInfo-functions","title":"Functions","text":""},{"location":"api/bridge/#freecad_mcp.bridge.base.DocumentInfo.__post_init__","title":"<code>__post_init__()</code>","text":"<p>Set label to name if not provided.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>def __post_init__(self) -&gt; None:\n    \"\"\"Set label to name if not provided.\"\"\"\n    if not self.label:\n        self.label = self.name\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.ExecutionResult","title":"<code>ExecutionResult</code>  <code>dataclass</code>","text":"<p>Result of Python code execution in FreeCAD.</p> <p>Attributes:</p> Name Type Description <code>success</code> <code>bool</code> <p>Whether execution completed without errors.</p> <code>result</code> <code>Any</code> <p>The value assigned to <code>_result_</code> variable, or None.</p> <code>stdout</code> <code>str</code> <p>Captured standard output.</p> <code>stderr</code> <code>str</code> <p>Captured standard error.</p> <code>execution_time_ms</code> <code>float</code> <p>Time taken in milliseconds.</p> <code>error_type</code> <code>str | None</code> <p>Type of exception if failed, None otherwise.</p> <code>error_traceback</code> <code>str | None</code> <p>Full traceback if failed, None otherwise.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@dataclass\nclass ExecutionResult:\n    \"\"\"Result of Python code execution in FreeCAD.\n\n    Attributes:\n        success: Whether execution completed without errors.\n        result: The value assigned to `_result_` variable, or None.\n        stdout: Captured standard output.\n        stderr: Captured standard error.\n        execution_time_ms: Time taken in milliseconds.\n        error_type: Type of exception if failed, None otherwise.\n        error_traceback: Full traceback if failed, None otherwise.\n    \"\"\"\n\n    success: bool\n    result: Any\n    stdout: str\n    stderr: str\n    execution_time_ms: float\n    error_type: str | None = None\n    error_traceback: str | None = None\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.FreecadBridge","title":"<code>FreecadBridge</code>","text":"<p>               Bases: <code>ABC</code></p> <p>Abstract base class for FreeCAD bridges.</p> <p>A bridge provides communication between the Robust MCP Server and a FreeCAD instance. Implementations may run FreeCAD in-process (embedded), communicate via XML-RPC, or use JSON-RPC over sockets.</p> Thread Safety <p>GUI operations must be executed on the main thread. Implementations should use queue-based communication for thread safety (learned from neka-nat implementation).</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>class FreecadBridge(ABC):\n    \"\"\"Abstract base class for FreeCAD bridges.\n\n    A bridge provides communication between the Robust MCP Server and a FreeCAD\n    instance. Implementations may run FreeCAD in-process (embedded),\n    communicate via XML-RPC, or use JSON-RPC over sockets.\n\n    Thread Safety:\n        GUI operations must be executed on the main thread. Implementations\n        should use queue-based communication for thread safety (learned from\n        neka-nat implementation).\n    \"\"\"\n\n    @abstractmethod\n    async def connect(self) -&gt; None:\n        \"\"\"Establish connection to FreeCAD.\n\n        Raises:\n            ConnectionError: If connection cannot be established.\n        \"\"\"\n\n    @abstractmethod\n    async def disconnect(self) -&gt; None:\n        \"\"\"Close connection to FreeCAD.\n\n        Should be called during cleanup to release resources.\n        \"\"\"\n\n    @abstractmethod\n    async def is_connected(self) -&gt; bool:\n        \"\"\"Check if bridge is connected to FreeCAD.\n\n        Returns:\n            True if connected, False otherwise.\n        \"\"\"\n\n    @abstractmethod\n    async def ping(self) -&gt; float:\n        \"\"\"Ping FreeCAD to check connection and measure latency.\n\n        Returns:\n            Round-trip time in milliseconds.\n\n        Raises:\n            ConnectionError: If not connected.\n        \"\"\"\n\n    @abstractmethod\n    async def get_status(self) -&gt; ConnectionStatus:\n        \"\"\"Get detailed connection status.\n\n        Returns:\n            ConnectionStatus with full status information.\n        \"\"\"\n\n    # =========================================================================\n    # Code Execution\n    # =========================================================================\n\n    @abstractmethod\n    async def execute_python(\n        self,\n        code: str,\n        timeout_ms: int = 30000,\n    ) -&gt; ExecutionResult:\n        \"\"\"Execute Python code in FreeCAD context.\n\n        The code runs with access to FreeCAD modules (FreeCAD, App, Gui).\n        To return a value, assign it to the `_result_` variable.\n\n        Args:\n            code: Python code to execute.\n            timeout_ms: Maximum execution time in milliseconds.\n\n        Returns:\n            ExecutionResult with success status, output, and any errors.\n        \"\"\"\n\n    # =========================================================================\n    # Document Management\n    # =========================================================================\n\n    @abstractmethod\n    async def get_documents(self) -&gt; list[DocumentInfo]:\n        \"\"\"Get list of open documents.\n\n        Returns:\n            List of DocumentInfo for each open document.\n        \"\"\"\n\n    @abstractmethod\n    async def get_active_document(self) -&gt; DocumentInfo | None:\n        \"\"\"Get the active document.\n\n        Returns:\n            DocumentInfo for active document, or None if no document is active.\n        \"\"\"\n\n    @abstractmethod\n    async def create_document(\n        self, name: str, label: str | None = None\n    ) -&gt; DocumentInfo:\n        \"\"\"Create a new document.\n\n        Args:\n            name: Internal document name (no spaces).\n            label: Display label (optional, defaults to name).\n\n        Returns:\n            DocumentInfo for the created document.\n        \"\"\"\n\n    @abstractmethod\n    async def open_document(self, path: str) -&gt; DocumentInfo:\n        \"\"\"Open an existing document.\n\n        Args:\n            path: Path to the .FCStd file.\n\n        Returns:\n            DocumentInfo for the opened document.\n\n        Raises:\n            FileNotFoundError: If file doesn't exist.\n            ValueError: If file is not a valid FreeCAD document.\n        \"\"\"\n\n    @abstractmethod\n    async def save_document(\n        self,\n        doc_name: str | None = None,\n        path: str | None = None,\n    ) -&gt; str:\n        \"\"\"Save a document.\n\n        Args:\n            doc_name: Document name (uses active if None).\n            path: Save path (uses existing path if None).\n\n        Returns:\n            Path where document was saved.\n\n        Raises:\n            ValueError: If document not found or no path specified for new doc.\n        \"\"\"\n\n    @abstractmethod\n    async def close_document(self, doc_name: str | None = None) -&gt; None:\n        \"\"\"Close a document.\n\n        Args:\n            doc_name: Document name (uses active if None).\n        \"\"\"\n\n    # =========================================================================\n    # Object Management\n    # =========================================================================\n\n    @abstractmethod\n    async def get_objects(self, doc_name: str | None = None) -&gt; list[ObjectInfo]:\n        \"\"\"Get all objects in a document.\n\n        Args:\n            doc_name: Document name (uses active if None).\n\n        Returns:\n            List of ObjectInfo for each object.\n        \"\"\"\n\n    @abstractmethod\n    async def get_object(\n        self,\n        obj_name: str,\n        doc_name: str | None = None,\n    ) -&gt; ObjectInfo:\n        \"\"\"Get detailed object information.\n\n        Args:\n            obj_name: Name of the object.\n            doc_name: Document name (uses active if None).\n\n        Returns:\n            ObjectInfo with full object details.\n\n        Raises:\n            ValueError: If object not found.\n        \"\"\"\n\n    @abstractmethod\n    async def create_object(\n        self,\n        type_id: str,\n        name: str | None = None,\n        properties: dict[str, Any] | None = None,\n        doc_name: str | None = None,\n    ) -&gt; ObjectInfo:\n        \"\"\"Create a new object.\n\n        Args:\n            type_id: FreeCAD type ID (e.g., \"Part::Box\", \"Part::Cylinder\").\n            name: Object name (auto-generated if None).\n            properties: Initial property values.\n            doc_name: Target document (uses active if None).\n\n        Returns:\n            ObjectInfo for the created object.\n        \"\"\"\n\n    @abstractmethod\n    async def edit_object(\n        self,\n        obj_name: str,\n        properties: dict[str, Any],\n        doc_name: str | None = None,\n    ) -&gt; ObjectInfo:\n        \"\"\"Edit object properties.\n\n        Args:\n            obj_name: Name of the object to edit.\n            properties: Property values to set.\n            doc_name: Document name (uses active if None).\n\n        Returns:\n            Updated ObjectInfo.\n\n        Raises:\n            ValueError: If object not found.\n        \"\"\"\n\n    @abstractmethod\n    async def delete_object(\n        self,\n        obj_name: str,\n        doc_name: str | None = None,\n    ) -&gt; None:\n        \"\"\"Delete an object.\n\n        Args:\n            obj_name: Name of the object to delete.\n            doc_name: Document name (uses active if None).\n\n        Raises:\n            ValueError: If object not found.\n        \"\"\"\n\n    # =========================================================================\n    # View and Screenshot\n    # =========================================================================\n\n    @abstractmethod\n    async def get_screenshot(\n        self,\n        view_angle: ViewAngle | None = None,\n        width: int = 800,\n        height: int = 600,\n        doc_name: str | None = None,\n    ) -&gt; ScreenshotResult:\n        \"\"\"Capture a screenshot of the 3D view.\n\n        Args:\n            view_angle: View angle to set before capture.\n            width: Image width in pixels.\n            height: Image height in pixels.\n            doc_name: Document name (uses active if None).\n\n        Returns:\n            ScreenshotResult with image data or error.\n        \"\"\"\n\n    @abstractmethod\n    async def set_view(\n        self,\n        view_angle: ViewAngle,\n        doc_name: str | None = None,\n    ) -&gt; None:\n        \"\"\"Set the 3D view angle.\n\n        Args:\n            view_angle: View angle to set.\n            doc_name: Document name (uses active if None).\n        \"\"\"\n\n    # =========================================================================\n    # Macros\n    # =========================================================================\n\n    @abstractmethod\n    async def get_macros(self) -&gt; list[MacroInfo]:\n        \"\"\"Get list of available macros.\n\n        Returns:\n            List of MacroInfo for each macro.\n        \"\"\"\n\n    @abstractmethod\n    async def run_macro(\n        self,\n        macro_name: str,\n        args: dict[str, Any] | None = None,\n    ) -&gt; ExecutionResult:\n        \"\"\"Run a macro by name.\n\n        Args:\n            macro_name: Macro name (without .FCMacro extension).\n            args: Arguments to pass to the macro.\n\n        Returns:\n            ExecutionResult from macro execution.\n        \"\"\"\n\n    @abstractmethod\n    async def create_macro(\n        self,\n        name: str,\n        code: str,\n        description: str = \"\",\n    ) -&gt; MacroInfo:\n        \"\"\"Create a new macro.\n\n        Args:\n            name: Macro name (without extension).\n            code: Python code for the macro.\n            description: Macro description.\n\n        Returns:\n            MacroInfo for the created macro.\n        \"\"\"\n\n    # =========================================================================\n    # Workbenches\n    # =========================================================================\n\n    @abstractmethod\n    async def get_workbenches(self) -&gt; list[WorkbenchInfo]:\n        \"\"\"Get list of available workbenches.\n\n        Returns:\n            List of WorkbenchInfo for each workbench.\n        \"\"\"\n\n    @abstractmethod\n    async def activate_workbench(self, workbench_name: str) -&gt; None:\n        \"\"\"Activate a workbench.\n\n        Args:\n            workbench_name: Workbench internal name.\n\n        Raises:\n            ValueError: If workbench not found.\n        \"\"\"\n\n    # =========================================================================\n    # Version and Environment\n    # =========================================================================\n\n    @abstractmethod\n    async def get_freecad_version(self) -&gt; dict[str, Any]:\n        \"\"\"Get FreeCAD version information.\n\n        Returns:\n            Dictionary with version, build_date, python_version, gui_available.\n        \"\"\"\n\n    @abstractmethod\n    async def is_gui_available(self) -&gt; bool:\n        \"\"\"Check if FreeCAD GUI is available.\n\n        Returns:\n            True if GUI is available, False for headless mode.\n        \"\"\"\n\n    # =========================================================================\n    # Console\n    # =========================================================================\n\n    @abstractmethod\n    async def get_console_output(self, lines: int = 100) -&gt; list[str]:\n        \"\"\"Get recent console output.\n\n        Args:\n            lines: Maximum number of lines to return.\n\n        Returns:\n            List of console output lines, most recent last.\n        \"\"\"\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.FreecadBridge-functions","title":"Functions","text":""},{"location":"api/bridge/#freecad_mcp.bridge.base.FreecadBridge.activate_workbench","title":"<code>activate_workbench(workbench_name)</code>  <code>abstractmethod</code> <code>async</code>","text":"<p>Activate a workbench.</p> <p>Parameters:</p> Name Type Description Default <code>workbench_name</code> <code>str</code> <p>Workbench internal name.</p> required <p>Raises:</p> Type Description <code>ValueError</code> <p>If workbench not found.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@abstractmethod\nasync def activate_workbench(self, workbench_name: str) -&gt; None:\n    \"\"\"Activate a workbench.\n\n    Args:\n        workbench_name: Workbench internal name.\n\n    Raises:\n        ValueError: If workbench not found.\n    \"\"\"\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.FreecadBridge.close_document","title":"<code>close_document(doc_name=None)</code>  <code>abstractmethod</code> <code>async</code>","text":"<p>Close a document.</p> <p>Parameters:</p> Name Type Description Default <code>doc_name</code> <code>str | None</code> <p>Document name (uses active if None).</p> <code>None</code> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@abstractmethod\nasync def close_document(self, doc_name: str | None = None) -&gt; None:\n    \"\"\"Close a document.\n\n    Args:\n        doc_name: Document name (uses active if None).\n    \"\"\"\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.FreecadBridge.connect","title":"<code>connect()</code>  <code>abstractmethod</code> <code>async</code>","text":"<p>Establish connection to FreeCAD.</p> <p>Raises:</p> Type Description <code>ConnectionError</code> <p>If connection cannot be established.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@abstractmethod\nasync def connect(self) -&gt; None:\n    \"\"\"Establish connection to FreeCAD.\n\n    Raises:\n        ConnectionError: If connection cannot be established.\n    \"\"\"\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.FreecadBridge.create_document","title":"<code>create_document(name, label=None)</code>  <code>abstractmethod</code> <code>async</code>","text":"<p>Create a new document.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Internal document name (no spaces).</p> required <code>label</code> <code>str | None</code> <p>Display label (optional, defaults to name).</p> <code>None</code> <p>Returns:</p> Type Description <code>DocumentInfo</code> <p>DocumentInfo for the created document.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@abstractmethod\nasync def create_document(\n    self, name: str, label: str | None = None\n) -&gt; DocumentInfo:\n    \"\"\"Create a new document.\n\n    Args:\n        name: Internal document name (no spaces).\n        label: Display label (optional, defaults to name).\n\n    Returns:\n        DocumentInfo for the created document.\n    \"\"\"\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.FreecadBridge.create_macro","title":"<code>create_macro(name, code, description='')</code>  <code>abstractmethod</code> <code>async</code>","text":"<p>Create a new macro.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Macro name (without extension).</p> required <code>code</code> <code>str</code> <p>Python code for the macro.</p> required <code>description</code> <code>str</code> <p>Macro description.</p> <code>''</code> <p>Returns:</p> Type Description <code>MacroInfo</code> <p>MacroInfo for the created macro.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@abstractmethod\nasync def create_macro(\n    self,\n    name: str,\n    code: str,\n    description: str = \"\",\n) -&gt; MacroInfo:\n    \"\"\"Create a new macro.\n\n    Args:\n        name: Macro name (without extension).\n        code: Python code for the macro.\n        description: Macro description.\n\n    Returns:\n        MacroInfo for the created macro.\n    \"\"\"\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.FreecadBridge.create_object","title":"<code>create_object(type_id, name=None, properties=None, doc_name=None)</code>  <code>abstractmethod</code> <code>async</code>","text":"<p>Create a new object.</p> <p>Parameters:</p> Name Type Description Default <code>type_id</code> <code>str</code> <p>FreeCAD type ID (e.g., \"Part::Box\", \"Part::Cylinder\").</p> required <code>name</code> <code>str | None</code> <p>Object name (auto-generated if None).</p> <code>None</code> <code>properties</code> <code>dict[str, Any] | None</code> <p>Initial property values.</p> <code>None</code> <code>doc_name</code> <code>str | None</code> <p>Target document (uses active if None).</p> <code>None</code> <p>Returns:</p> Type Description <code>ObjectInfo</code> <p>ObjectInfo for the created object.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@abstractmethod\nasync def create_object(\n    self,\n    type_id: str,\n    name: str | None = None,\n    properties: dict[str, Any] | None = None,\n    doc_name: str | None = None,\n) -&gt; ObjectInfo:\n    \"\"\"Create a new object.\n\n    Args:\n        type_id: FreeCAD type ID (e.g., \"Part::Box\", \"Part::Cylinder\").\n        name: Object name (auto-generated if None).\n        properties: Initial property values.\n        doc_name: Target document (uses active if None).\n\n    Returns:\n        ObjectInfo for the created object.\n    \"\"\"\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.FreecadBridge.delete_object","title":"<code>delete_object(obj_name, doc_name=None)</code>  <code>abstractmethod</code> <code>async</code>","text":"<p>Delete an object.</p> <p>Parameters:</p> Name Type Description Default <code>obj_name</code> <code>str</code> <p>Name of the object to delete.</p> required <code>doc_name</code> <code>str | None</code> <p>Document name (uses active if None).</p> <code>None</code> <p>Raises:</p> Type Description <code>ValueError</code> <p>If object not found.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@abstractmethod\nasync def delete_object(\n    self,\n    obj_name: str,\n    doc_name: str | None = None,\n) -&gt; None:\n    \"\"\"Delete an object.\n\n    Args:\n        obj_name: Name of the object to delete.\n        doc_name: Document name (uses active if None).\n\n    Raises:\n        ValueError: If object not found.\n    \"\"\"\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.FreecadBridge.disconnect","title":"<code>disconnect()</code>  <code>abstractmethod</code> <code>async</code>","text":"<p>Close connection to FreeCAD.</p> <p>Should be called during cleanup to release resources.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@abstractmethod\nasync def disconnect(self) -&gt; None:\n    \"\"\"Close connection to FreeCAD.\n\n    Should be called during cleanup to release resources.\n    \"\"\"\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.FreecadBridge.edit_object","title":"<code>edit_object(obj_name, properties, doc_name=None)</code>  <code>abstractmethod</code> <code>async</code>","text":"<p>Edit object properties.</p> <p>Parameters:</p> Name Type Description Default <code>obj_name</code> <code>str</code> <p>Name of the object to edit.</p> required <code>properties</code> <code>dict[str, Any]</code> <p>Property values to set.</p> required <code>doc_name</code> <code>str | None</code> <p>Document name (uses active if None).</p> <code>None</code> <p>Returns:</p> Type Description <code>ObjectInfo</code> <p>Updated ObjectInfo.</p> <p>Raises:</p> Type Description <code>ValueError</code> <p>If object not found.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@abstractmethod\nasync def edit_object(\n    self,\n    obj_name: str,\n    properties: dict[str, Any],\n    doc_name: str | None = None,\n) -&gt; ObjectInfo:\n    \"\"\"Edit object properties.\n\n    Args:\n        obj_name: Name of the object to edit.\n        properties: Property values to set.\n        doc_name: Document name (uses active if None).\n\n    Returns:\n        Updated ObjectInfo.\n\n    Raises:\n        ValueError: If object not found.\n    \"\"\"\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.FreecadBridge.execute_python","title":"<code>execute_python(code, timeout_ms=30000)</code>  <code>abstractmethod</code> <code>async</code>","text":"<p>Execute Python code in FreeCAD context.</p> <p>The code runs with access to FreeCAD modules (FreeCAD, App, Gui). To return a value, assign it to the <code>_result_</code> variable.</p> <p>Parameters:</p> Name Type Description Default <code>code</code> <code>str</code> <p>Python code to execute.</p> required <code>timeout_ms</code> <code>int</code> <p>Maximum execution time in milliseconds.</p> <code>30000</code> <p>Returns:</p> Type Description <code>ExecutionResult</code> <p>ExecutionResult with success status, output, and any errors.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@abstractmethod\nasync def execute_python(\n    self,\n    code: str,\n    timeout_ms: int = 30000,\n) -&gt; ExecutionResult:\n    \"\"\"Execute Python code in FreeCAD context.\n\n    The code runs with access to FreeCAD modules (FreeCAD, App, Gui).\n    To return a value, assign it to the `_result_` variable.\n\n    Args:\n        code: Python code to execute.\n        timeout_ms: Maximum execution time in milliseconds.\n\n    Returns:\n        ExecutionResult with success status, output, and any errors.\n    \"\"\"\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.FreecadBridge.get_active_document","title":"<code>get_active_document()</code>  <code>abstractmethod</code> <code>async</code>","text":"<p>Get the active document.</p> <p>Returns:</p> Type Description <code>DocumentInfo | None</code> <p>DocumentInfo for active document, or None if no document is active.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@abstractmethod\nasync def get_active_document(self) -&gt; DocumentInfo | None:\n    \"\"\"Get the active document.\n\n    Returns:\n        DocumentInfo for active document, or None if no document is active.\n    \"\"\"\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.FreecadBridge.get_console_output","title":"<code>get_console_output(lines=100)</code>  <code>abstractmethod</code> <code>async</code>","text":"<p>Get recent console output.</p> <p>Parameters:</p> Name Type Description Default <code>lines</code> <code>int</code> <p>Maximum number of lines to return.</p> <code>100</code> <p>Returns:</p> Type Description <code>list[str]</code> <p>List of console output lines, most recent last.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@abstractmethod\nasync def get_console_output(self, lines: int = 100) -&gt; list[str]:\n    \"\"\"Get recent console output.\n\n    Args:\n        lines: Maximum number of lines to return.\n\n    Returns:\n        List of console output lines, most recent last.\n    \"\"\"\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.FreecadBridge.get_documents","title":"<code>get_documents()</code>  <code>abstractmethod</code> <code>async</code>","text":"<p>Get list of open documents.</p> <p>Returns:</p> Type Description <code>list[DocumentInfo]</code> <p>List of DocumentInfo for each open document.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@abstractmethod\nasync def get_documents(self) -&gt; list[DocumentInfo]:\n    \"\"\"Get list of open documents.\n\n    Returns:\n        List of DocumentInfo for each open document.\n    \"\"\"\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.FreecadBridge.get_freecad_version","title":"<code>get_freecad_version()</code>  <code>abstractmethod</code> <code>async</code>","text":"<p>Get FreeCAD version information.</p> <p>Returns:</p> Type Description <code>dict[str, Any]</code> <p>Dictionary with version, build_date, python_version, gui_available.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@abstractmethod\nasync def get_freecad_version(self) -&gt; dict[str, Any]:\n    \"\"\"Get FreeCAD version information.\n\n    Returns:\n        Dictionary with version, build_date, python_version, gui_available.\n    \"\"\"\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.FreecadBridge.get_macros","title":"<code>get_macros()</code>  <code>abstractmethod</code> <code>async</code>","text":"<p>Get list of available macros.</p> <p>Returns:</p> Type Description <code>list[MacroInfo]</code> <p>List of MacroInfo for each macro.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@abstractmethod\nasync def get_macros(self) -&gt; list[MacroInfo]:\n    \"\"\"Get list of available macros.\n\n    Returns:\n        List of MacroInfo for each macro.\n    \"\"\"\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.FreecadBridge.get_object","title":"<code>get_object(obj_name, doc_name=None)</code>  <code>abstractmethod</code> <code>async</code>","text":"<p>Get detailed object information.</p> <p>Parameters:</p> Name Type Description Default <code>obj_name</code> <code>str</code> <p>Name of the object.</p> required <code>doc_name</code> <code>str | None</code> <p>Document name (uses active if None).</p> <code>None</code> <p>Returns:</p> Type Description <code>ObjectInfo</code> <p>ObjectInfo with full object details.</p> <p>Raises:</p> Type Description <code>ValueError</code> <p>If object not found.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@abstractmethod\nasync def get_object(\n    self,\n    obj_name: str,\n    doc_name: str | None = None,\n) -&gt; ObjectInfo:\n    \"\"\"Get detailed object information.\n\n    Args:\n        obj_name: Name of the object.\n        doc_name: Document name (uses active if None).\n\n    Returns:\n        ObjectInfo with full object details.\n\n    Raises:\n        ValueError: If object not found.\n    \"\"\"\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.FreecadBridge.get_objects","title":"<code>get_objects(doc_name=None)</code>  <code>abstractmethod</code> <code>async</code>","text":"<p>Get all objects in a document.</p> <p>Parameters:</p> Name Type Description Default <code>doc_name</code> <code>str | None</code> <p>Document name (uses active if None).</p> <code>None</code> <p>Returns:</p> Type Description <code>list[ObjectInfo]</code> <p>List of ObjectInfo for each object.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@abstractmethod\nasync def get_objects(self, doc_name: str | None = None) -&gt; list[ObjectInfo]:\n    \"\"\"Get all objects in a document.\n\n    Args:\n        doc_name: Document name (uses active if None).\n\n    Returns:\n        List of ObjectInfo for each object.\n    \"\"\"\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.FreecadBridge.get_screenshot","title":"<code>get_screenshot(view_angle=None, width=800, height=600, doc_name=None)</code>  <code>abstractmethod</code> <code>async</code>","text":"<p>Capture a screenshot of the 3D view.</p> <p>Parameters:</p> Name Type Description Default <code>view_angle</code> <code>ViewAngle | None</code> <p>View angle to set before capture.</p> <code>None</code> <code>width</code> <code>int</code> <p>Image width in pixels.</p> <code>800</code> <code>height</code> <code>int</code> <p>Image height in pixels.</p> <code>600</code> <code>doc_name</code> <code>str | None</code> <p>Document name (uses active if None).</p> <code>None</code> <p>Returns:</p> Type Description <code>ScreenshotResult</code> <p>ScreenshotResult with image data or error.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@abstractmethod\nasync def get_screenshot(\n    self,\n    view_angle: ViewAngle | None = None,\n    width: int = 800,\n    height: int = 600,\n    doc_name: str | None = None,\n) -&gt; ScreenshotResult:\n    \"\"\"Capture a screenshot of the 3D view.\n\n    Args:\n        view_angle: View angle to set before capture.\n        width: Image width in pixels.\n        height: Image height in pixels.\n        doc_name: Document name (uses active if None).\n\n    Returns:\n        ScreenshotResult with image data or error.\n    \"\"\"\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.FreecadBridge.get_status","title":"<code>get_status()</code>  <code>abstractmethod</code> <code>async</code>","text":"<p>Get detailed connection status.</p> <p>Returns:</p> Type Description <code>ConnectionStatus</code> <p>ConnectionStatus with full status information.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@abstractmethod\nasync def get_status(self) -&gt; ConnectionStatus:\n    \"\"\"Get detailed connection status.\n\n    Returns:\n        ConnectionStatus with full status information.\n    \"\"\"\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.FreecadBridge.get_workbenches","title":"<code>get_workbenches()</code>  <code>abstractmethod</code> <code>async</code>","text":"<p>Get list of available workbenches.</p> <p>Returns:</p> Type Description <code>list[WorkbenchInfo]</code> <p>List of WorkbenchInfo for each workbench.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@abstractmethod\nasync def get_workbenches(self) -&gt; list[WorkbenchInfo]:\n    \"\"\"Get list of available workbenches.\n\n    Returns:\n        List of WorkbenchInfo for each workbench.\n    \"\"\"\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.FreecadBridge.is_connected","title":"<code>is_connected()</code>  <code>abstractmethod</code> <code>async</code>","text":"<p>Check if bridge is connected to FreeCAD.</p> <p>Returns:</p> Type Description <code>bool</code> <p>True if connected, False otherwise.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@abstractmethod\nasync def is_connected(self) -&gt; bool:\n    \"\"\"Check if bridge is connected to FreeCAD.\n\n    Returns:\n        True if connected, False otherwise.\n    \"\"\"\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.FreecadBridge.is_gui_available","title":"<code>is_gui_available()</code>  <code>abstractmethod</code> <code>async</code>","text":"<p>Check if FreeCAD GUI is available.</p> <p>Returns:</p> Type Description <code>bool</code> <p>True if GUI is available, False for headless mode.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@abstractmethod\nasync def is_gui_available(self) -&gt; bool:\n    \"\"\"Check if FreeCAD GUI is available.\n\n    Returns:\n        True if GUI is available, False for headless mode.\n    \"\"\"\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.FreecadBridge.open_document","title":"<code>open_document(path)</code>  <code>abstractmethod</code> <code>async</code>","text":"<p>Open an existing document.</p> <p>Parameters:</p> Name Type Description Default <code>path</code> <code>str</code> <p>Path to the .FCStd file.</p> required <p>Returns:</p> Type Description <code>DocumentInfo</code> <p>DocumentInfo for the opened document.</p> <p>Raises:</p> Type Description <code>FileNotFoundError</code> <p>If file doesn't exist.</p> <code>ValueError</code> <p>If file is not a valid FreeCAD document.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@abstractmethod\nasync def open_document(self, path: str) -&gt; DocumentInfo:\n    \"\"\"Open an existing document.\n\n    Args:\n        path: Path to the .FCStd file.\n\n    Returns:\n        DocumentInfo for the opened document.\n\n    Raises:\n        FileNotFoundError: If file doesn't exist.\n        ValueError: If file is not a valid FreeCAD document.\n    \"\"\"\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.FreecadBridge.ping","title":"<code>ping()</code>  <code>abstractmethod</code> <code>async</code>","text":"<p>Ping FreeCAD to check connection and measure latency.</p> <p>Returns:</p> Type Description <code>float</code> <p>Round-trip time in milliseconds.</p> <p>Raises:</p> Type Description <code>ConnectionError</code> <p>If not connected.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@abstractmethod\nasync def ping(self) -&gt; float:\n    \"\"\"Ping FreeCAD to check connection and measure latency.\n\n    Returns:\n        Round-trip time in milliseconds.\n\n    Raises:\n        ConnectionError: If not connected.\n    \"\"\"\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.FreecadBridge.run_macro","title":"<code>run_macro(macro_name, args=None)</code>  <code>abstractmethod</code> <code>async</code>","text":"<p>Run a macro by name.</p> <p>Parameters:</p> Name Type Description Default <code>macro_name</code> <code>str</code> <p>Macro name (without .FCMacro extension).</p> required <code>args</code> <code>dict[str, Any] | None</code> <p>Arguments to pass to the macro.</p> <code>None</code> <p>Returns:</p> Type Description <code>ExecutionResult</code> <p>ExecutionResult from macro execution.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@abstractmethod\nasync def run_macro(\n    self,\n    macro_name: str,\n    args: dict[str, Any] | None = None,\n) -&gt; ExecutionResult:\n    \"\"\"Run a macro by name.\n\n    Args:\n        macro_name: Macro name (without .FCMacro extension).\n        args: Arguments to pass to the macro.\n\n    Returns:\n        ExecutionResult from macro execution.\n    \"\"\"\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.FreecadBridge.save_document","title":"<code>save_document(doc_name=None, path=None)</code>  <code>abstractmethod</code> <code>async</code>","text":"<p>Save a document.</p> <p>Parameters:</p> Name Type Description Default <code>doc_name</code> <code>str | None</code> <p>Document name (uses active if None).</p> <code>None</code> <code>path</code> <code>str | None</code> <p>Save path (uses existing path if None).</p> <code>None</code> <p>Returns:</p> Type Description <code>str</code> <p>Path where document was saved.</p> <p>Raises:</p> Type Description <code>ValueError</code> <p>If document not found or no path specified for new doc.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@abstractmethod\nasync def save_document(\n    self,\n    doc_name: str | None = None,\n    path: str | None = None,\n) -&gt; str:\n    \"\"\"Save a document.\n\n    Args:\n        doc_name: Document name (uses active if None).\n        path: Save path (uses existing path if None).\n\n    Returns:\n        Path where document was saved.\n\n    Raises:\n        ValueError: If document not found or no path specified for new doc.\n    \"\"\"\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.FreecadBridge.set_view","title":"<code>set_view(view_angle, doc_name=None)</code>  <code>abstractmethod</code> <code>async</code>","text":"<p>Set the 3D view angle.</p> <p>Parameters:</p> Name Type Description Default <code>view_angle</code> <code>ViewAngle</code> <p>View angle to set.</p> required <code>doc_name</code> <code>str | None</code> <p>Document name (uses active if None).</p> <code>None</code> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@abstractmethod\nasync def set_view(\n    self,\n    view_angle: ViewAngle,\n    doc_name: str | None = None,\n) -&gt; None:\n    \"\"\"Set the 3D view angle.\n\n    Args:\n        view_angle: View angle to set.\n        doc_name: Document name (uses active if None).\n    \"\"\"\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.MacroInfo","title":"<code>MacroInfo</code>  <code>dataclass</code>","text":"<p>Information about a FreeCAD macro.</p> <p>Attributes:</p> Name Type Description <code>name</code> <code>str</code> <p>Macro name (without extension).</p> <code>path</code> <code>str</code> <p>Full path to macro file.</p> <code>description</code> <code>str</code> <p>Macro description from comments.</p> <code>is_system</code> <code>bool</code> <p>Whether it's a system macro.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@dataclass\nclass MacroInfo:\n    \"\"\"Information about a FreeCAD macro.\n\n    Attributes:\n        name: Macro name (without extension).\n        path: Full path to macro file.\n        description: Macro description from comments.\n        is_system: Whether it's a system macro.\n    \"\"\"\n\n    name: str\n    path: str\n    description: str = \"\"\n    is_system: bool = False\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.ObjectInfo","title":"<code>ObjectInfo</code>  <code>dataclass</code>","text":"<p>Information about a FreeCAD object.</p> <p>Attributes:</p> Name Type Description <code>name</code> <code>str</code> <p>Object name (identifier).</p> <code>label</code> <code>str</code> <p>Display label.</p> <code>type_id</code> <code>str</code> <p>FreeCAD TypeId string (e.g., \"Part::Box\").</p> <code>properties</code> <code>dict[str, Any]</code> <p>Dictionary of property names to values.</p> <code>shape_info</code> <code>dict[str, Any] | None</code> <p>Shape geometry details if applicable.</p> <code>children</code> <code>list[str]</code> <p>List of child object names (OutList).</p> <code>parents</code> <code>list[str]</code> <p>List of parent object names (InList).</p> <code>visibility</code> <code>bool</code> <p>Whether object is visible in the view.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@dataclass\nclass ObjectInfo:\n    \"\"\"Information about a FreeCAD object.\n\n    Attributes:\n        name: Object name (identifier).\n        label: Display label.\n        type_id: FreeCAD TypeId string (e.g., \"Part::Box\").\n        properties: Dictionary of property names to values.\n        shape_info: Shape geometry details if applicable.\n        children: List of child object names (OutList).\n        parents: List of parent object names (InList).\n        visibility: Whether object is visible in the view.\n    \"\"\"\n\n    name: str\n    label: str\n    type_id: str\n    properties: dict[str, Any] = field(default_factory=dict)\n    shape_info: dict[str, Any] | None = None\n    children: list[str] = field(default_factory=list)\n    parents: list[str] = field(default_factory=list)\n    visibility: bool = True\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.ObjectType","title":"<code>ObjectType</code>","text":"<p>               Bases: <code>str</code>, <code>Enum</code></p> <p>FreeCAD object type categories.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>class ObjectType(str, Enum):\n    \"\"\"FreeCAD object type categories.\"\"\"\n\n    PART = \"Part\"\n    PART_DESIGN = \"PartDesign\"\n    DRAFT = \"Draft\"\n    SKETCHER = \"Sketcher\"\n    FEM = \"Fem\"\n    MESH = \"Mesh\"\n    SPREADSHEET = \"Spreadsheet\"\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.ScreenshotResult","title":"<code>ScreenshotResult</code>  <code>dataclass</code>","text":"<p>Result of a screenshot capture.</p> <p>Attributes:</p> Name Type Description <code>success</code> <code>bool</code> <p>Whether screenshot was captured successfully.</p> <code>data</code> <code>str | None</code> <p>Base64-encoded image data.</p> <code>format</code> <code>str</code> <p>Image format (png, jpg).</p> <code>width</code> <code>int</code> <p>Image width in pixels.</p> <code>height</code> <code>int</code> <p>Image height in pixels.</p> <code>view_angle</code> <code>ViewAngle | None</code> <p>The view angle used.</p> <code>error</code> <code>str | None</code> <p>Error message if failed.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@dataclass\nclass ScreenshotResult:\n    \"\"\"Result of a screenshot capture.\n\n    Attributes:\n        success: Whether screenshot was captured successfully.\n        data: Base64-encoded image data.\n        format: Image format (png, jpg).\n        width: Image width in pixels.\n        height: Image height in pixels.\n        view_angle: The view angle used.\n        error: Error message if failed.\n    \"\"\"\n\n    success: bool\n    data: str | None = None\n    format: str = \"png\"\n    width: int = 0\n    height: int = 0\n    view_angle: ViewAngle | None = None\n    error: str | None = None\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.ShapeInfo","title":"<code>ShapeInfo</code>  <code>dataclass</code>","text":"<p>Detailed shape geometry information.</p> <p>Attributes:</p> Name Type Description <code>shape_type</code> <code>str</code> <p>Type of shape (Solid, Shell, Face, etc.).</p> <code>volume</code> <code>float | None</code> <p>Volume of the shape (for solids).</p> <code>area</code> <code>float | None</code> <p>Surface area of the shape.</p> <code>center_of_mass</code> <code>tuple[float, float, float] | None</code> <p>Center of mass coordinates.</p> <code>bounding_box</code> <code>tuple[tuple[float, float, float], tuple[float, float, float]] | None</code> <p>Bounding box as (min, max) tuples.</p> <code>is_valid</code> <code>bool</code> <p>Whether the shape is geometrically valid.</p> <code>is_closed</code> <code>bool</code> <p>Whether the shape is closed.</p> <code>vertex_count</code> <code>int</code> <p>Number of vertices.</p> <code>edge_count</code> <code>int</code> <p>Number of edges.</p> <code>face_count</code> <code>int</code> <p>Number of faces.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@dataclass\nclass ShapeInfo:\n    \"\"\"Detailed shape geometry information.\n\n    Attributes:\n        shape_type: Type of shape (Solid, Shell, Face, etc.).\n        volume: Volume of the shape (for solids).\n        area: Surface area of the shape.\n        center_of_mass: Center of mass coordinates.\n        bounding_box: Bounding box as (min, max) tuples.\n        is_valid: Whether the shape is geometrically valid.\n        is_closed: Whether the shape is closed.\n        vertex_count: Number of vertices.\n        edge_count: Number of edges.\n        face_count: Number of faces.\n    \"\"\"\n\n    shape_type: str\n    volume: float | None = None\n    area: float | None = None\n    center_of_mass: tuple[float, float, float] | None = None\n    bounding_box: (\n        tuple[tuple[float, float, float], tuple[float, float, float]] | None\n    ) = None\n    is_valid: bool = True\n    is_closed: bool = False\n    vertex_count: int = 0\n    edge_count: int = 0\n    face_count: int = 0\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.ViewAngle","title":"<code>ViewAngle</code>","text":"<p>               Bases: <code>str</code>, <code>Enum</code></p> <p>Standard view angles for screenshots.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>class ViewAngle(str, Enum):\n    \"\"\"Standard view angles for screenshots.\"\"\"\n\n    ISOMETRIC = \"Isometric\"\n    FRONT = \"Front\"\n    BACK = \"Back\"\n    TOP = \"Top\"\n    BOTTOM = \"Bottom\"\n    LEFT = \"Left\"\n    RIGHT = \"Right\"\n    FIT_ALL = \"FitAll\"\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.base.WorkbenchInfo","title":"<code>WorkbenchInfo</code>  <code>dataclass</code>","text":"<p>Information about a FreeCAD workbench.</p> <p>Attributes:</p> Name Type Description <code>name</code> <code>str</code> <p>Workbench internal name.</p> <code>label</code> <code>str</code> <p>Display label.</p> <code>icon</code> <code>str</code> <p>Icon resource path.</p> <code>is_active</code> <code>bool</code> <p>Whether workbench is currently active.</p> Source code in <code>src/freecad_mcp/bridge/base.py</code> <pre><code>@dataclass\nclass WorkbenchInfo:\n    \"\"\"Information about a FreeCAD workbench.\n\n    Attributes:\n        name: Workbench internal name.\n        label: Display label.\n        icon: Icon resource path.\n        is_active: Whether workbench is currently active.\n    \"\"\"\n\n    name: str\n    label: str\n    icon: str = \"\"\n    is_active: bool = False\n</code></pre>"},{"location":"api/bridge/#xml-rpc-bridge","title":"XML-RPC Bridge","text":"<p>options: show_root_heading: true show_source: true</p>"},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc","title":"<code>freecad_mcp.bridge.xmlrpc</code>","text":"<p>XML-RPC bridge for FreeCAD GUI mode communication.</p> <p>This bridge connects to a FreeCAD instance running an XML-RPC server, allowing remote control while FreeCAD has its GUI open.</p> <p>Compatible with neka-nat/freecad-mcp XML-RPC protocol, providing interoperability with existing FreeCAD Robust MCP addons.</p> <p>Design inspired by neka-nat/freecad-mcp (MIT License): - Uses neka-nat's proven XML-RPC protocol (port 9875) - Connection health monitoring and auto-reconnect - Timeout handling for long operations</p> Attribution <p>The XML-RPC protocol design and port selection (9875) were inspired by neka-nat/freecad-mcp (https://github.com/neka-nat/freecad-mcp), which is licensed under the MIT License. This implementation is a complete rewrite that maintains protocol compatibility.</p>"},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc-classes","title":"Classes","text":""},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc.XmlRpcBridge","title":"<code>XmlRpcBridge</code>","text":"<p>               Bases: <code>FreecadBridge</code></p> <p>Bridge that communicates with FreeCAD via XML-RPC.</p> <p>This bridge connects to a FreeCAD instance that is running the XML-RPC server addon. It provides full access to FreeCAD functionality including GUI operations like screenshots.</p> <p>Attributes:</p> Name Type Description <code>host</code> <p>XML-RPC server hostname.</p> <code>port</code> <p>XML-RPC server port.</p> <code>timeout</code> <p>Connection and request timeout in seconds.</p> Source code in <code>src/freecad_mcp/bridge/xmlrpc.py</code> <pre><code>class XmlRpcBridge(FreecadBridge):\n    \"\"\"Bridge that communicates with FreeCAD via XML-RPC.\n\n    This bridge connects to a FreeCAD instance that is running the\n    XML-RPC server addon. It provides full access to FreeCAD functionality\n    including GUI operations like screenshots.\n\n    Attributes:\n        host: XML-RPC server hostname.\n        port: XML-RPC server port.\n        timeout: Connection and request timeout in seconds.\n    \"\"\"\n\n    def __init__(\n        self,\n        host: str = DEFAULT_XMLRPC_HOST,\n        port: int = DEFAULT_XMLRPC_PORT,\n        timeout: float = DEFAULT_TIMEOUT,\n    ) -&gt; None:\n        \"\"\"Initialize the XML-RPC bridge.\n\n        Args:\n            host: XML-RPC server hostname.\n            port: XML-RPC server port.\n            timeout: Connection and request timeout in seconds.\n        \"\"\"\n        self._host = host\n        self._port = port\n        self._timeout = timeout\n        self._proxy: xmlrpc.client.ServerProxy | None = None\n        self._connected = False\n\n    @property\n    def _server_url(self) -&gt; str:\n        \"\"\"Get the XML-RPC server URL.\"\"\"\n        return f\"http://{self._host}:{self._port}\"\n\n    async def connect(self) -&gt; None:\n        \"\"\"Establish connection to FreeCAD XML-RPC server.\n\n        Raises:\n            ConnectionError: If connection cannot be established.\n        \"\"\"\n        loop = asyncio.get_event_loop()\n        try:\n            self._proxy = await loop.run_in_executor(\n                None,\n                lambda: xmlrpc.client.ServerProxy(\n                    self._server_url,\n                    allow_none=True,\n                ),\n            )\n            # Test connection with a ping\n            await self.ping()\n            self._connected = True\n        except ConnectionRefusedError as e:\n            self._connected = False\n            msg = self._get_connection_refused_message()\n            raise ConnectionError(msg) from e\n        except Exception as e:\n            self._connected = False\n            error_str = str(e)\n            if \"Connection refused\" in error_str or \"Errno 61\" in error_str:\n                msg = self._get_connection_refused_message()\n            else:\n                msg = f\"Failed to connect to XML-RPC server at {self._server_url}: {e}\"\n            raise ConnectionError(msg) from e\n\n    def _get_connection_refused_message(self) -&gt; str:\n        \"\"\"Get a helpful error message when connection is refused.\"\"\"\n        return f\"\"\"\n================================================================================\nCONNECTION REFUSED: Cannot connect to FreeCAD at {self._server_url}\n\nThe FreeCAD Robust MCP Bridge server is not running. To fix this:\n\n1. Start FreeCAD (the GUI application)\n\n2. Start the MCP bridge using one of these methods:\n\n   Option A: Using the Robust MCP Bridge Workbench (recommended)\n   - Install via FreeCAD Addon Manager: Tools \u2192 Addon Manager\n   - Search for \"Robust MCP Bridge\" and install\n   - Switch to the Robust MCP Bridge workbench\n   - Click \"Start MCP Bridge\" in the toolbar\n\n   Option B: From source (for developers)\n   - Run: just freecad::run-gui\n\n3. You should see: \"MCP Bridge started!\"\n   - XML-RPC: localhost:{self._port}\n   - Socket: localhost:9876\n\n4. Then restart your MCP client (e.g., restart Claude Code)\n================================================================================\n\"\"\"\n\n    async def disconnect(self) -&gt; None:\n        \"\"\"Close connection to FreeCAD XML-RPC server.\"\"\"\n        self._proxy = None\n        self._connected = False\n\n    async def is_connected(self) -&gt; bool:\n        \"\"\"Check if bridge is connected to FreeCAD.\"\"\"\n        if not self._connected or self._proxy is None:\n            return False\n\n        try:\n            await self.ping()\n            return True\n        except Exception:\n            self._connected = False\n            return False\n\n    async def ping(self) -&gt; float:\n        \"\"\"Ping FreeCAD to check connection and measure latency.\n\n        Returns:\n            Round-trip time in milliseconds.\n\n        Raises:\n            ConnectionError: If not connected.\n        \"\"\"\n        if self._proxy is None:\n            msg = \"Not connected to XML-RPC server\"\n            raise ConnectionError(msg)\n\n        loop = asyncio.get_event_loop()\n        start = time.perf_counter()\n\n        try:\n            # Try standard system.listMethods or a simple execute\n            if self._proxy is None:\n                msg = \"Not connected\"\n                raise ConnectionError(msg)\n            proxy = self._proxy  # Local reference for lambda\n            await asyncio.wait_for(\n                loop.run_in_executor(\n                    None,\n                    lambda: proxy.execute(\"_result_ = True\"),\n                ),\n                timeout=self._timeout,\n            )\n        except TimeoutError as e:\n            msg = \"Ping timed out\"\n            raise ConnectionError(msg) from e\n        except Exception as e:\n            msg = f\"Ping failed: {e}\"\n            raise ConnectionError(msg) from e\n\n        return (time.perf_counter() - start) * 1000\n\n    async def get_status(self) -&gt; ConnectionStatus:\n        \"\"\"Get detailed connection status.\n\n        Returns:\n            ConnectionStatus with full status information.\n        \"\"\"\n        if not self._connected or self._proxy is None:\n            return ConnectionStatus(\n                connected=False,\n                mode=\"xmlrpc\",\n                error=\"Not connected\",\n            )\n\n        try:\n            ping_ms = await self.ping()\n            version_info = await self.get_freecad_version()\n            gui_available = await self.is_gui_available()\n\n            return ConnectionStatus(\n                connected=True,\n                mode=\"xmlrpc\",\n                freecad_version=version_info.get(\"version\", \"unknown\"),\n                gui_available=gui_available,\n                last_ping_ms=ping_ms,\n            )\n        except Exception as e:\n            return ConnectionStatus(\n                connected=False,\n                mode=\"xmlrpc\",\n                error=str(e),\n            )\n\n    # =========================================================================\n    # Code Execution\n    # =========================================================================\n\n    async def execute_python(\n        self,\n        code: str,\n        timeout_ms: int = 30000,\n    ) -&gt; ExecutionResult:\n        \"\"\"Execute Python code in FreeCAD context via XML-RPC.\n\n        Args:\n            code: Python code to execute.\n            timeout_ms: Maximum execution time in milliseconds.\n\n        Returns:\n            ExecutionResult with execution outcome.\n        \"\"\"\n        if self._proxy is None:\n            return ExecutionResult(\n                success=False,\n                result=None,\n                stdout=\"\",\n                stderr=\"Not connected to XML-RPC server\",\n                execution_time_ms=0,\n                error_type=\"ConnectionError\",\n            )\n\n        loop = asyncio.get_event_loop()\n        start = time.perf_counter()\n        proxy = self._proxy  # Local reference for lambda\n\n        try:\n            result = await asyncio.wait_for(\n                loop.run_in_executor(\n                    None,\n                    lambda: proxy.execute(code),\n                ),\n                timeout=timeout_ms / 1000,\n            )\n            elapsed = (time.perf_counter() - start) * 1000\n\n            # Parse result from XML-RPC server\n            if isinstance(result, dict):\n                return ExecutionResult(\n                    success=result.get(\"success\", False),\n                    result=result.get(\"result\"),\n                    stdout=result.get(\"stdout\", \"\"),\n                    stderr=result.get(\"stderr\", \"\"),\n                    execution_time_ms=elapsed,\n                    error_type=result.get(\"error_type\"),\n                    error_traceback=result.get(\"error_traceback\"),\n                )\n            else:\n                # Simple result format\n                return ExecutionResult(\n                    success=True,\n                    result=result,\n                    stdout=\"\",\n                    stderr=\"\",\n                    execution_time_ms=elapsed,\n                )\n\n        except TimeoutError:\n            return ExecutionResult(\n                success=False,\n                result=None,\n                stdout=\"\",\n                stderr=f\"Execution timed out after {timeout_ms}ms\",\n                execution_time_ms=float(timeout_ms),\n                error_type=\"TimeoutError\",\n            )\n        except Exception as e:\n            elapsed = (time.perf_counter() - start) * 1000\n            return ExecutionResult(\n                success=False,\n                result=None,\n                stdout=\"\",\n                stderr=str(e),\n                execution_time_ms=elapsed,\n                error_type=type(e).__name__,\n            )\n\n    # =========================================================================\n    # Document Management\n    # =========================================================================\n\n    async def get_documents(self) -&gt; list[DocumentInfo]:\n        \"\"\"Get list of open documents.\"\"\"\n        result = await self.execute_python(\n            \"\"\"\n_result_ = []\nfor doc in FreeCAD.listDocuments().values():\n    _result_.append({\n        \"name\": doc.Name,\n        \"label\": doc.Label,\n        \"path\": doc.FileName or None,\n        \"objects\": [obj.Name for obj in doc.Objects],\n        \"is_modified\": doc.Modified if hasattr(doc, \"Modified\") else False,\n        \"active_object\": doc.ActiveObject.Name if doc.ActiveObject else None,\n    })\n\"\"\"\n        )\n\n        if result.success and result.result:\n            return [DocumentInfo(**doc) for doc in result.result]\n        return []\n\n    async def get_active_document(self) -&gt; DocumentInfo | None:\n        \"\"\"Get the active document.\"\"\"\n        result = await self.execute_python(\n            \"\"\"\ndoc = FreeCAD.ActiveDocument\nif doc:\n    _result_ = {\n        \"name\": doc.Name,\n        \"label\": doc.Label,\n        \"path\": doc.FileName or None,\n        \"objects\": [obj.Name for obj in doc.Objects],\n        \"is_modified\": doc.Modified if hasattr(doc, \"Modified\") else False,\n        \"active_object\": doc.ActiveObject.Name if doc.ActiveObject else None,\n    }\nelse:\n    _result_ = None\n\"\"\"\n        )\n\n        if result.success and result.result:\n            return DocumentInfo(**result.result)\n        return None\n\n    async def create_document(\n        self, name: str, label: str | None = None\n    ) -&gt; DocumentInfo:\n        \"\"\"Create a new document.\"\"\"\n        label = label or name\n        result = await self.execute_python(\n            f\"\"\"\ndoc = FreeCAD.newDocument({name!r})\ndoc.Label = {label!r}\n_result_ = {{\n    \"name\": doc.Name,\n    \"label\": doc.Label,\n    \"path\": doc.FileName or None,\n    \"objects\": [],\n    \"is_modified\": False,\n}}\n\"\"\"\n        )\n\n        if result.success and result.result:\n            return DocumentInfo(**result.result)\n\n        error_msg = result.error_traceback or \"Failed to create document\"\n        raise ValueError(error_msg)\n\n    async def open_document(self, path: str) -&gt; DocumentInfo:\n        \"\"\"Open an existing document.\"\"\"\n        result = await self.execute_python(\n            f\"\"\"\nimport os\nif not os.path.exists({path!r}):\n    raise FileNotFoundError(f\"File not found: {path!r}\")\n\ndoc = FreeCAD.openDocument({path!r})\n_result_ = {{\n    \"name\": doc.Name,\n    \"label\": doc.Label,\n    \"path\": doc.FileName or None,\n    \"objects\": [obj.Name for obj in doc.Objects],\n    \"is_modified\": doc.Modified if hasattr(doc, \"Modified\") else False,\n}}\n\"\"\"\n        )\n\n        if result.success and result.result:\n            return DocumentInfo(**result.result)\n\n        if \"FileNotFoundError\" in (result.error_type or \"\"):\n            raise FileNotFoundError(result.stderr)\n\n        error_msg = result.error_traceback or \"Failed to open document\"\n        raise ValueError(error_msg)\n\n    async def save_document(\n        self,\n        doc_name: str | None = None,\n        path: str | None = None,\n    ) -&gt; str:\n        \"\"\"Save a document.\"\"\"\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No active document\" if {doc_name!r} is None else f\"Document not found: {doc_name!r}\")\n\nsave_path = {path!r} or doc.FileName\nif not save_path:\n    raise ValueError(\"No path specified for new document\")\n\ndoc.saveAs(save_path)\n_result_ = save_path\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return result.result\n\n        error_msg = result.error_traceback or \"Failed to save document\"\n        raise ValueError(error_msg)\n\n    async def close_document(self, doc_name: str | None = None) -&gt; None:\n        \"\"\"Close a document.\"\"\"\n        code = f\"\"\"\ndoc_name = {doc_name!r}\nif doc_name is None:\n    doc = FreeCAD.ActiveDocument\n    if doc:\n        doc_name = doc.Name\n    else:\n        raise ValueError(\"No active document\")\n\nFreeCAD.closeDocument(doc_name)\n_result_ = True\n\"\"\"\n        result = await self.execute_python(code)\n\n        if not result.success:\n            error_msg = result.error_traceback or \"Failed to close document\"\n            raise ValueError(error_msg)\n\n    # =========================================================================\n    # Object Management\n    # =========================================================================\n\n    async def get_objects(self, doc_name: str | None = None) -&gt; list[ObjectInfo]:\n        \"\"\"Get all objects in a document.\"\"\"\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nobjects = []\nfor obj in doc.Objects:\n    obj_info = {{\n        \"name\": obj.Name,\n        \"label\": obj.Label,\n        \"type_id\": obj.TypeId,\n        \"visibility\": obj.ViewObject.Visibility if hasattr(obj, \"ViewObject\") and obj.ViewObject else True,\n        \"children\": [c.Name for c in obj.OutList] if hasattr(obj, \"OutList\") else [],\n        \"parents\": [p.Name for p in obj.InList] if hasattr(obj, \"InList\") else [],\n    }}\n    objects.append(obj_info)\n\n_result_ = objects\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return [ObjectInfo(**obj) for obj in result.result]\n        return []\n\n    async def get_object(\n        self,\n        obj_name: str,\n        doc_name: str | None = None,\n    ) -&gt; ObjectInfo:\n        \"\"\"Get detailed object information.\"\"\"\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nobj = doc.getObject({obj_name!r})\nif obj is None:\n    raise ValueError(f\"Object not found: {obj_name!r}\")\n\nprops = {{}}\nfor prop in obj.PropertiesList:\n    try:\n        val = getattr(obj, prop)\n        if hasattr(val, '__class__') and val.__class__.__module__ != 'builtins':\n            val = str(val)\n        props[prop] = val\n    except Exception:\n        props[prop] = \"&lt;unreadable&gt;\"\n\nshape_info = None\nif hasattr(obj, \"Shape\"):\n    shape = obj.Shape\n    shape_info = {{\n        \"shape_type\": shape.ShapeType,\n        \"volume\": shape.Volume if hasattr(shape, \"Volume\") else None,\n        \"area\": shape.Area if hasattr(shape, \"Area\") else None,\n        \"is_valid\": shape.isValid(),\n        \"is_closed\": shape.isClosed() if hasattr(shape, \"isClosed\") else False,\n        \"vertex_count\": len(shape.Vertexes) if hasattr(shape, \"Vertexes\") else 0,\n        \"edge_count\": len(shape.Edges) if hasattr(shape, \"Edges\") else 0,\n        \"face_count\": len(shape.Faces) if hasattr(shape, \"Faces\") else 0,\n    }}\n\n_result_ = {{\n    \"name\": obj.Name,\n    \"label\": obj.Label,\n    \"type_id\": obj.TypeId,\n    \"properties\": props,\n    \"shape_info\": shape_info,\n    \"children\": [c.Name for c in obj.OutList] if hasattr(obj, \"OutList\") else [],\n    \"parents\": [p.Name for p in obj.InList] if hasattr(obj, \"InList\") else [],\n    \"visibility\": obj.ViewObject.Visibility if hasattr(obj, \"ViewObject\") and obj.ViewObject else True,\n}}\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return ObjectInfo(**result.result)\n\n        error_msg = result.error_traceback or \"Failed to get object\"\n        raise ValueError(error_msg)\n\n    async def create_object(\n        self,\n        type_id: str,\n        name: str | None = None,\n        properties: dict[str, Any] | None = None,\n        doc_name: str | None = None,\n    ) -&gt; ObjectInfo:\n        \"\"\"Create a new object.\"\"\"\n        properties = properties or {}\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nobj = doc.addObject({type_id!r}, {name!r} or \"\")\n\n# Set properties\nfor prop_name, prop_val in {properties!r}.items():\n    if hasattr(obj, prop_name):\n        setattr(obj, prop_name, prop_val)\n\ndoc.recompute()\n\n_result_ = {{\n    \"name\": obj.Name,\n    \"label\": obj.Label,\n    \"type_id\": obj.TypeId,\n    \"visibility\": True,\n    \"children\": [c.Name for c in obj.OutList] if hasattr(obj, \"OutList\") else [],\n    \"parents\": [p.Name for p in obj.InList] if hasattr(obj, \"InList\") else [],\n}}\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return ObjectInfo(**result.result)\n\n        error_msg = result.error_traceback or \"Failed to create object\"\n        raise ValueError(error_msg)\n\n    async def edit_object(\n        self,\n        obj_name: str,\n        properties: dict[str, Any],\n        doc_name: str | None = None,\n    ) -&gt; ObjectInfo:\n        \"\"\"Edit object properties.\"\"\"\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nobj = doc.getObject({obj_name!r})\nif obj is None:\n    raise ValueError(f\"Object not found: {obj_name!r}\")\n\n# Set properties\nfor prop_name, prop_val in {properties!r}.items():\n    if hasattr(obj, prop_name):\n        setattr(obj, prop_name, prop_val)\n\ndoc.recompute()\n\n_result_ = {{\n    \"name\": obj.Name,\n    \"label\": obj.Label,\n    \"type_id\": obj.TypeId,\n    \"visibility\": obj.ViewObject.Visibility if hasattr(obj, \"ViewObject\") and obj.ViewObject else True,\n    \"children\": [c.Name for c in obj.OutList] if hasattr(obj, \"OutList\") else [],\n    \"parents\": [p.Name for p in obj.InList] if hasattr(obj, \"InList\") else [],\n}}\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return ObjectInfo(**result.result)\n\n        error_msg = result.error_traceback or \"Failed to edit object\"\n        raise ValueError(error_msg)\n\n    async def delete_object(\n        self,\n        obj_name: str,\n        doc_name: str | None = None,\n    ) -&gt; None:\n        \"\"\"Delete an object.\"\"\"\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nobj = doc.getObject({obj_name!r})\nif obj is None:\n    raise ValueError(f\"Object not found: {obj_name!r}\")\n\ndoc.removeObject({obj_name!r})\n_result_ = True\n\"\"\"\n        result = await self.execute_python(code)\n\n        if not result.success:\n            error_msg = result.error_traceback or \"Failed to delete object\"\n            raise ValueError(error_msg)\n\n    # =========================================================================\n    # View and Screenshot\n    # =========================================================================\n\n    async def get_screenshot(\n        self,\n        view_angle: ViewAngle | None = None,\n        width: int = 800,\n        height: int = 600,\n        doc_name: str | None = None,\n    ) -&gt; ScreenshotResult:\n        \"\"\"Capture a screenshot of the 3D view via XML-RPC.\"\"\"\n        view_angle_str = view_angle.value if view_angle else \"Isometric\"\n        code = f\"\"\"\nimport base64\nimport tempfile\nimport os\n\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\n# Check if GUI is available\nif not FreeCAD.GuiUp:\n    raise RuntimeError(\"GUI not available\")\n\nview = FreeCADGui.ActiveDocument.ActiveView\nif view is None:\n    raise ValueError(\"No active view\")\n\n# Check if this is a 3D view (not TechDraw, Spreadsheet, etc.)\nview_type = view.__class__.__name__\nif view_type not in [\"View3DInventor\", \"View3DInventorPy\"]:\n    raise ValueError(f\"Cannot capture screenshot from {{view_type}} view\")\n\n# Set view angle\nview_type_str = {view_angle_str!r}\nif view_type_str == \"FitAll\":\n    view.fitAll()\nelif view_type_str == \"Isometric\":\n    view.viewIsometric()\nelif view_type_str == \"Front\":\n    view.viewFront()\nelif view_type_str == \"Back\":\n    view.viewRear()\nelif view_type_str == \"Top\":\n    view.viewTop()\nelif view_type_str == \"Bottom\":\n    view.viewBottom()\nelif view_type_str == \"Left\":\n    view.viewLeft()\nelif view_type_str == \"Right\":\n    view.viewRight()\n\n# Save to temp file and read\nwith tempfile.NamedTemporaryFile(suffix=\".png\", delete=False) as f:\n    temp_path = f.name\n\nview.saveImage(temp_path, {width}, {height}, \"Current\")\n\nwith open(temp_path, \"rb\") as f:\n    image_data = base64.b64encode(f.read()).decode(\"utf-8\")\n\nos.unlink(temp_path)\n\n_result_ = {{\n    \"success\": True,\n    \"data\": image_data,\n    \"format\": \"png\",\n    \"width\": {width},\n    \"height\": {height},\n}}\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return ScreenshotResult(\n                success=True,\n                data=result.result[\"data\"],\n                format=result.result[\"format\"],\n                width=result.result[\"width\"],\n                height=result.result[\"height\"],\n                view_angle=view_angle,\n            )\n\n        return ScreenshotResult(\n            success=False,\n            error=result.error_traceback\n            or result.stderr\n            or \"Failed to capture screenshot\",\n            width=width,\n            height=height,\n            view_angle=view_angle,\n        )\n\n    async def set_view(\n        self,\n        view_angle: ViewAngle,\n        doc_name: str | None = None,\n    ) -&gt; None:\n        \"\"\"Set the 3D view angle.\"\"\"\n        view_angle_str = view_angle.value\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nif not FreeCAD.GuiUp:\n    _result_ = True  # Silently succeed in headless mode\nelse:\n    view = FreeCADGui.ActiveDocument.ActiveView\n    if view is None:\n        raise ValueError(\"No active view\")\n\n    view_type = {view_angle_str!r}\n    if view_type == \"FitAll\":\n        view.fitAll()\n    elif view_type == \"Isometric\":\n        view.viewIsometric()\n    elif view_type == \"Front\":\n        view.viewFront()\n    elif view_type == \"Back\":\n        view.viewRear()\n    elif view_type == \"Top\":\n        view.viewTop()\n    elif view_type == \"Bottom\":\n        view.viewBottom()\n    elif view_type == \"Left\":\n        view.viewLeft()\n    elif view_type == \"Right\":\n        view.viewRight()\n\n    _result_ = True\n\"\"\"\n        await self.execute_python(code)\n\n    # =========================================================================\n    # Macros\n    # =========================================================================\n\n    async def get_macros(self) -&gt; list[MacroInfo]:\n        \"\"\"Get list of available macros.\"\"\"\n        code = \"\"\"\nimport os\n\n# Get macro paths\nmacro_paths = []\n\n# User macro path\nuser_path = FreeCAD.getUserMacroDir(True)\nif os.path.exists(user_path):\n    macro_paths.append((\"user\", user_path))\n\n# System macro path\nsystem_path = FreeCAD.getResourceDir() + \"Macro\"\nif os.path.exists(system_path):\n    macro_paths.append((\"system\", system_path))\n\nmacros = []\nfor source, path in macro_paths:\n    for filename in os.listdir(path):\n        if filename.endswith(\".FCMacro\"):\n            macro_file = os.path.join(path, filename)\n            description = \"\"\n            try:\n                with open(macro_file, \"r\") as f:\n                    for line in f:\n                        if line.startswith(\"#\"):\n                            desc = line.lstrip(\"#\").strip()\n                            if desc and not desc.startswith(\"!\") and not desc.startswith(\"-*-\"):\n                                description = desc\n                                break\n            except Exception:\n                pass\n\n            macros.append({\n                \"name\": filename[:-8],  # Remove .FCMacro\n                \"path\": macro_file,\n                \"description\": description,\n                \"is_system\": source == \"system\",\n            })\n\n_result_ = macros\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return [MacroInfo(**m) for m in result.result]\n        return []\n\n    async def run_macro(\n        self,\n        macro_name: str,\n        args: dict[str, Any] | None = None,\n    ) -&gt; ExecutionResult:\n        \"\"\"Run a macro by name.\"\"\"\n        args = args or {}\n        code = f\"\"\"\nimport os\n\n# Find macro file\nmacro_name = {macro_name!r}\nmacro_file = None\n\n# Check user macros first\nuser_path = FreeCAD.getUserMacroDir(True)\nuser_macro = os.path.join(user_path, macro_name + \".FCMacro\")\nif os.path.exists(user_macro):\n    macro_file = user_macro\n\n# Check system macros\nif not macro_file:\n    system_path = FreeCAD.getResourceDir() + \"Macro\"\n    system_macro = os.path.join(system_path, macro_name + \".FCMacro\")\n    if os.path.exists(system_macro):\n        macro_file = system_macro\n\nif not macro_file:\n    raise FileNotFoundError(f\"Macro not found: {{macro_name}}\")\n\n# Set up arguments\nargs = {args!r}\nfor k, v in args.items():\n    exec(f\"{{k}} = {{v!r}}\")\n\n# Execute macro\nwith open(macro_file, \"r\") as f:\n    macro_code = f.read()\n\nexec(macro_code)\n_result_ = True\n\"\"\"\n        return await self.execute_python(code)\n\n    async def create_macro(\n        self,\n        name: str,\n        code: str,\n        description: str = \"\",\n    ) -&gt; MacroInfo:\n        \"\"\"Create a new macro.\"\"\"\n        create_code = f\"\"\"\nimport os\n\nmacro_path = FreeCAD.getUserMacroDir(True)\nos.makedirs(macro_path, exist_ok=True)\n\nmacro_file = os.path.join(macro_path, {name!r} + \".FCMacro\")\n\nheader = \"\"\nif {description!r}:\n    header = f\"# {description!r}\\\\n\\\\n\"\n\nfull_code = header + '''# -*- coding: utf-8 -*-\n# FreeCAD Macro: {name}\n# Created via MCP Bridge\n\nimport FreeCAD\nimport FreeCADGui\n\n''' + {code!r}\n\nwith open(macro_file, \"w\") as f:\n    f.write(full_code)\n\n_result_ = {{\n    \"name\": {name!r},\n    \"path\": macro_file,\n    \"description\": {description!r},\n    \"is_system\": False,\n}}\n\"\"\"\n        result = await self.execute_python(create_code)\n\n        if result.success and result.result:\n            return MacroInfo(**result.result)\n\n        error_msg = result.error_traceback or \"Failed to create macro\"\n        raise ValueError(error_msg)\n\n    # =========================================================================\n    # Workbenches\n    # =========================================================================\n\n    async def get_workbenches(self) -&gt; list[WorkbenchInfo]:\n        \"\"\"Get list of available workbenches.\"\"\"\n        code = \"\"\"\nworkbenches = []\nactive_wb = FreeCADGui.activeWorkbench() if FreeCAD.GuiUp else None\nactive_name = active_wb.__class__.__name__ if active_wb else None\n\nif FreeCAD.GuiUp:\n    for name in FreeCADGui.listWorkbenches():\n        wb = FreeCADGui.getWorkbench(name)\n        workbenches.append({\n            \"name\": name,\n            \"label\": wb.MenuText if hasattr(wb, \"MenuText\") else name,\n            \"icon\": wb.Icon if hasattr(wb, \"Icon\") else \"\",\n            \"is_active\": name == active_name,\n        })\nelse:\n    # Return common workbenches for headless mode\n    common = [\"StartWorkbench\", \"PartWorkbench\", \"PartDesignWorkbench\",\n              \"DraftWorkbench\", \"SketcherWorkbench\", \"MeshWorkbench\"]\n    for name in common:\n        workbenches.append({\n            \"name\": name,\n            \"label\": name.replace(\"Workbench\", \"\"),\n            \"icon\": \"\",\n            \"is_active\": False,\n        })\n\n_result_ = workbenches\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return [WorkbenchInfo(**wb) for wb in result.result]\n        return []\n\n    async def activate_workbench(self, workbench_name: str) -&gt; None:\n        \"\"\"Activate a workbench.\"\"\"\n        code = f\"\"\"\nif FreeCAD.GuiUp:\n    try:\n        FreeCADGui.activateWorkbench({workbench_name!r})\n        _result_ = True\n    except Exception as e:\n        raise ValueError(f\"Failed to activate workbench: {{e}}\")\nelse:\n    _result_ = True  # Silently succeed in headless mode\n\"\"\"\n        result = await self.execute_python(code)\n\n        if not result.success:\n            error_msg = result.error_traceback or \"Failed to activate workbench\"\n            raise ValueError(error_msg)\n\n    # =========================================================================\n    # Version and Environment\n    # =========================================================================\n\n    async def get_freecad_version(self) -&gt; dict[str, Any]:\n        \"\"\"Get FreeCAD version information.\"\"\"\n        code = \"\"\"\nimport sys\n_result_ = {\n    \"version\": \".\".join(str(x) for x in FreeCAD.Version()[:3]),\n    \"version_tuple\": FreeCAD.Version()[:3],\n    \"build_date\": FreeCAD.Version()[3] if len(FreeCAD.Version()) &gt; 3 else \"unknown\",\n    \"python_version\": sys.version,\n    \"gui_available\": FreeCAD.GuiUp,\n}\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return result.result\n\n        return {\n            \"version\": \"unknown\",\n            \"version_tuple\": [],\n            \"build_date\": \"unknown\",\n            \"python_version\": \"\",\n            \"gui_available\": False,\n        }\n\n    async def is_gui_available(self) -&gt; bool:\n        \"\"\"Check if FreeCAD GUI is available.\"\"\"\n        result = await self.execute_python(\"_result_ = FreeCAD.GuiUp\")\n        return bool(result.success and result.result)\n\n    # =========================================================================\n    # Console\n    # =========================================================================\n\n    async def get_console_output(self, lines: int = 100) -&gt; list[str]:\n        \"\"\"Get recent console output.\"\"\"\n        code = f\"\"\"\n# Try to get console output from FreeCAD\noutput_lines = []\n\n# Try FreeCAD.Console if available\nif hasattr(FreeCAD, 'Console'):\n    console = FreeCAD.Console\n    if hasattr(console, 'GetLog'):\n        log = console.GetLog()\n        if log:\n            output_lines = log.split('\\\\n')[-{lines}:]\n\n_result_ = output_lines\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return result.result\n        return []\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc.XmlRpcBridge-functions","title":"Functions","text":""},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc.XmlRpcBridge.__init__","title":"<code>__init__(host=DEFAULT_XMLRPC_HOST, port=DEFAULT_XMLRPC_PORT, timeout=DEFAULT_TIMEOUT)</code>","text":"<p>Initialize the XML-RPC bridge.</p> <p>Parameters:</p> Name Type Description Default <code>host</code> <code>str</code> <p>XML-RPC server hostname.</p> <code>DEFAULT_XMLRPC_HOST</code> <code>port</code> <code>int</code> <p>XML-RPC server port.</p> <code>DEFAULT_XMLRPC_PORT</code> <code>timeout</code> <code>float</code> <p>Connection and request timeout in seconds.</p> <code>DEFAULT_TIMEOUT</code> Source code in <code>src/freecad_mcp/bridge/xmlrpc.py</code> <pre><code>def __init__(\n    self,\n    host: str = DEFAULT_XMLRPC_HOST,\n    port: int = DEFAULT_XMLRPC_PORT,\n    timeout: float = DEFAULT_TIMEOUT,\n) -&gt; None:\n    \"\"\"Initialize the XML-RPC bridge.\n\n    Args:\n        host: XML-RPC server hostname.\n        port: XML-RPC server port.\n        timeout: Connection and request timeout in seconds.\n    \"\"\"\n    self._host = host\n    self._port = port\n    self._timeout = timeout\n    self._proxy: xmlrpc.client.ServerProxy | None = None\n    self._connected = False\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc.XmlRpcBridge.activate_workbench","title":"<code>activate_workbench(workbench_name)</code>  <code>async</code>","text":"<p>Activate a workbench.</p> Source code in <code>src/freecad_mcp/bridge/xmlrpc.py</code> <pre><code>    async def activate_workbench(self, workbench_name: str) -&gt; None:\n        \"\"\"Activate a workbench.\"\"\"\n        code = f\"\"\"\nif FreeCAD.GuiUp:\n    try:\n        FreeCADGui.activateWorkbench({workbench_name!r})\n        _result_ = True\n    except Exception as e:\n        raise ValueError(f\"Failed to activate workbench: {{e}}\")\nelse:\n    _result_ = True  # Silently succeed in headless mode\n\"\"\"\n        result = await self.execute_python(code)\n\n        if not result.success:\n            error_msg = result.error_traceback or \"Failed to activate workbench\"\n            raise ValueError(error_msg)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc.XmlRpcBridge.close_document","title":"<code>close_document(doc_name=None)</code>  <code>async</code>","text":"<p>Close a document.</p> Source code in <code>src/freecad_mcp/bridge/xmlrpc.py</code> <pre><code>    async def close_document(self, doc_name: str | None = None) -&gt; None:\n        \"\"\"Close a document.\"\"\"\n        code = f\"\"\"\ndoc_name = {doc_name!r}\nif doc_name is None:\n    doc = FreeCAD.ActiveDocument\n    if doc:\n        doc_name = doc.Name\n    else:\n        raise ValueError(\"No active document\")\n\nFreeCAD.closeDocument(doc_name)\n_result_ = True\n\"\"\"\n        result = await self.execute_python(code)\n\n        if not result.success:\n            error_msg = result.error_traceback or \"Failed to close document\"\n            raise ValueError(error_msg)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc.XmlRpcBridge.connect","title":"<code>connect()</code>  <code>async</code>","text":"<p>Establish connection to FreeCAD XML-RPC server.</p> <p>Raises:</p> Type Description <code>ConnectionError</code> <p>If connection cannot be established.</p> Source code in <code>src/freecad_mcp/bridge/xmlrpc.py</code> <pre><code>async def connect(self) -&gt; None:\n    \"\"\"Establish connection to FreeCAD XML-RPC server.\n\n    Raises:\n        ConnectionError: If connection cannot be established.\n    \"\"\"\n    loop = asyncio.get_event_loop()\n    try:\n        self._proxy = await loop.run_in_executor(\n            None,\n            lambda: xmlrpc.client.ServerProxy(\n                self._server_url,\n                allow_none=True,\n            ),\n        )\n        # Test connection with a ping\n        await self.ping()\n        self._connected = True\n    except ConnectionRefusedError as e:\n        self._connected = False\n        msg = self._get_connection_refused_message()\n        raise ConnectionError(msg) from e\n    except Exception as e:\n        self._connected = False\n        error_str = str(e)\n        if \"Connection refused\" in error_str or \"Errno 61\" in error_str:\n            msg = self._get_connection_refused_message()\n        else:\n            msg = f\"Failed to connect to XML-RPC server at {self._server_url}: {e}\"\n        raise ConnectionError(msg) from e\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc.XmlRpcBridge.create_document","title":"<code>create_document(name, label=None)</code>  <code>async</code>","text":"<p>Create a new document.</p> Source code in <code>src/freecad_mcp/bridge/xmlrpc.py</code> <pre><code>    async def create_document(\n        self, name: str, label: str | None = None\n    ) -&gt; DocumentInfo:\n        \"\"\"Create a new document.\"\"\"\n        label = label or name\n        result = await self.execute_python(\n            f\"\"\"\ndoc = FreeCAD.newDocument({name!r})\ndoc.Label = {label!r}\n_result_ = {{\n    \"name\": doc.Name,\n    \"label\": doc.Label,\n    \"path\": doc.FileName or None,\n    \"objects\": [],\n    \"is_modified\": False,\n}}\n\"\"\"\n        )\n\n        if result.success and result.result:\n            return DocumentInfo(**result.result)\n\n        error_msg = result.error_traceback or \"Failed to create document\"\n        raise ValueError(error_msg)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc.XmlRpcBridge.create_macro","title":"<code>create_macro(name, code, description='')</code>  <code>async</code>","text":"<p>Create a new macro.</p> Source code in <code>src/freecad_mcp/bridge/xmlrpc.py</code> <pre><code>    async def create_macro(\n        self,\n        name: str,\n        code: str,\n        description: str = \"\",\n    ) -&gt; MacroInfo:\n        \"\"\"Create a new macro.\"\"\"\n        create_code = f\"\"\"\nimport os\n\nmacro_path = FreeCAD.getUserMacroDir(True)\nos.makedirs(macro_path, exist_ok=True)\n\nmacro_file = os.path.join(macro_path, {name!r} + \".FCMacro\")\n\nheader = \"\"\nif {description!r}:\n    header = f\"# {description!r}\\\\n\\\\n\"\n\nfull_code = header + '''# -*- coding: utf-8 -*-\n# FreeCAD Macro: {name}\n# Created via MCP Bridge\n\nimport FreeCAD\nimport FreeCADGui\n\n''' + {code!r}\n\nwith open(macro_file, \"w\") as f:\n    f.write(full_code)\n\n_result_ = {{\n    \"name\": {name!r},\n    \"path\": macro_file,\n    \"description\": {description!r},\n    \"is_system\": False,\n}}\n\"\"\"\n        result = await self.execute_python(create_code)\n\n        if result.success and result.result:\n            return MacroInfo(**result.result)\n\n        error_msg = result.error_traceback or \"Failed to create macro\"\n        raise ValueError(error_msg)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc.XmlRpcBridge.create_object","title":"<code>create_object(type_id, name=None, properties=None, doc_name=None)</code>  <code>async</code>","text":"<p>Create a new object.</p> Source code in <code>src/freecad_mcp/bridge/xmlrpc.py</code> <pre><code>    async def create_object(\n        self,\n        type_id: str,\n        name: str | None = None,\n        properties: dict[str, Any] | None = None,\n        doc_name: str | None = None,\n    ) -&gt; ObjectInfo:\n        \"\"\"Create a new object.\"\"\"\n        properties = properties or {}\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nobj = doc.addObject({type_id!r}, {name!r} or \"\")\n\n# Set properties\nfor prop_name, prop_val in {properties!r}.items():\n    if hasattr(obj, prop_name):\n        setattr(obj, prop_name, prop_val)\n\ndoc.recompute()\n\n_result_ = {{\n    \"name\": obj.Name,\n    \"label\": obj.Label,\n    \"type_id\": obj.TypeId,\n    \"visibility\": True,\n    \"children\": [c.Name for c in obj.OutList] if hasattr(obj, \"OutList\") else [],\n    \"parents\": [p.Name for p in obj.InList] if hasattr(obj, \"InList\") else [],\n}}\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return ObjectInfo(**result.result)\n\n        error_msg = result.error_traceback or \"Failed to create object\"\n        raise ValueError(error_msg)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc.XmlRpcBridge.delete_object","title":"<code>delete_object(obj_name, doc_name=None)</code>  <code>async</code>","text":"<p>Delete an object.</p> Source code in <code>src/freecad_mcp/bridge/xmlrpc.py</code> <pre><code>    async def delete_object(\n        self,\n        obj_name: str,\n        doc_name: str | None = None,\n    ) -&gt; None:\n        \"\"\"Delete an object.\"\"\"\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nobj = doc.getObject({obj_name!r})\nif obj is None:\n    raise ValueError(f\"Object not found: {obj_name!r}\")\n\ndoc.removeObject({obj_name!r})\n_result_ = True\n\"\"\"\n        result = await self.execute_python(code)\n\n        if not result.success:\n            error_msg = result.error_traceback or \"Failed to delete object\"\n            raise ValueError(error_msg)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc.XmlRpcBridge.disconnect","title":"<code>disconnect()</code>  <code>async</code>","text":"<p>Close connection to FreeCAD XML-RPC server.</p> Source code in <code>src/freecad_mcp/bridge/xmlrpc.py</code> <pre><code>async def disconnect(self) -&gt; None:\n    \"\"\"Close connection to FreeCAD XML-RPC server.\"\"\"\n    self._proxy = None\n    self._connected = False\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc.XmlRpcBridge.edit_object","title":"<code>edit_object(obj_name, properties, doc_name=None)</code>  <code>async</code>","text":"<p>Edit object properties.</p> Source code in <code>src/freecad_mcp/bridge/xmlrpc.py</code> <pre><code>    async def edit_object(\n        self,\n        obj_name: str,\n        properties: dict[str, Any],\n        doc_name: str | None = None,\n    ) -&gt; ObjectInfo:\n        \"\"\"Edit object properties.\"\"\"\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nobj = doc.getObject({obj_name!r})\nif obj is None:\n    raise ValueError(f\"Object not found: {obj_name!r}\")\n\n# Set properties\nfor prop_name, prop_val in {properties!r}.items():\n    if hasattr(obj, prop_name):\n        setattr(obj, prop_name, prop_val)\n\ndoc.recompute()\n\n_result_ = {{\n    \"name\": obj.Name,\n    \"label\": obj.Label,\n    \"type_id\": obj.TypeId,\n    \"visibility\": obj.ViewObject.Visibility if hasattr(obj, \"ViewObject\") and obj.ViewObject else True,\n    \"children\": [c.Name for c in obj.OutList] if hasattr(obj, \"OutList\") else [],\n    \"parents\": [p.Name for p in obj.InList] if hasattr(obj, \"InList\") else [],\n}}\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return ObjectInfo(**result.result)\n\n        error_msg = result.error_traceback or \"Failed to edit object\"\n        raise ValueError(error_msg)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc.XmlRpcBridge.execute_python","title":"<code>execute_python(code, timeout_ms=30000)</code>  <code>async</code>","text":"<p>Execute Python code in FreeCAD context via XML-RPC.</p> <p>Parameters:</p> Name Type Description Default <code>code</code> <code>str</code> <p>Python code to execute.</p> required <code>timeout_ms</code> <code>int</code> <p>Maximum execution time in milliseconds.</p> <code>30000</code> <p>Returns:</p> Type Description <code>ExecutionResult</code> <p>ExecutionResult with execution outcome.</p> Source code in <code>src/freecad_mcp/bridge/xmlrpc.py</code> <pre><code>async def execute_python(\n    self,\n    code: str,\n    timeout_ms: int = 30000,\n) -&gt; ExecutionResult:\n    \"\"\"Execute Python code in FreeCAD context via XML-RPC.\n\n    Args:\n        code: Python code to execute.\n        timeout_ms: Maximum execution time in milliseconds.\n\n    Returns:\n        ExecutionResult with execution outcome.\n    \"\"\"\n    if self._proxy is None:\n        return ExecutionResult(\n            success=False,\n            result=None,\n            stdout=\"\",\n            stderr=\"Not connected to XML-RPC server\",\n            execution_time_ms=0,\n            error_type=\"ConnectionError\",\n        )\n\n    loop = asyncio.get_event_loop()\n    start = time.perf_counter()\n    proxy = self._proxy  # Local reference for lambda\n\n    try:\n        result = await asyncio.wait_for(\n            loop.run_in_executor(\n                None,\n                lambda: proxy.execute(code),\n            ),\n            timeout=timeout_ms / 1000,\n        )\n        elapsed = (time.perf_counter() - start) * 1000\n\n        # Parse result from XML-RPC server\n        if isinstance(result, dict):\n            return ExecutionResult(\n                success=result.get(\"success\", False),\n                result=result.get(\"result\"),\n                stdout=result.get(\"stdout\", \"\"),\n                stderr=result.get(\"stderr\", \"\"),\n                execution_time_ms=elapsed,\n                error_type=result.get(\"error_type\"),\n                error_traceback=result.get(\"error_traceback\"),\n            )\n        else:\n            # Simple result format\n            return ExecutionResult(\n                success=True,\n                result=result,\n                stdout=\"\",\n                stderr=\"\",\n                execution_time_ms=elapsed,\n            )\n\n    except TimeoutError:\n        return ExecutionResult(\n            success=False,\n            result=None,\n            stdout=\"\",\n            stderr=f\"Execution timed out after {timeout_ms}ms\",\n            execution_time_ms=float(timeout_ms),\n            error_type=\"TimeoutError\",\n        )\n    except Exception as e:\n        elapsed = (time.perf_counter() - start) * 1000\n        return ExecutionResult(\n            success=False,\n            result=None,\n            stdout=\"\",\n            stderr=str(e),\n            execution_time_ms=elapsed,\n            error_type=type(e).__name__,\n        )\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc.XmlRpcBridge.get_active_document","title":"<code>get_active_document()</code>  <code>async</code>","text":"<p>Get the active document.</p> Source code in <code>src/freecad_mcp/bridge/xmlrpc.py</code> <pre><code>    async def get_active_document(self) -&gt; DocumentInfo | None:\n        \"\"\"Get the active document.\"\"\"\n        result = await self.execute_python(\n            \"\"\"\ndoc = FreeCAD.ActiveDocument\nif doc:\n    _result_ = {\n        \"name\": doc.Name,\n        \"label\": doc.Label,\n        \"path\": doc.FileName or None,\n        \"objects\": [obj.Name for obj in doc.Objects],\n        \"is_modified\": doc.Modified if hasattr(doc, \"Modified\") else False,\n        \"active_object\": doc.ActiveObject.Name if doc.ActiveObject else None,\n    }\nelse:\n    _result_ = None\n\"\"\"\n        )\n\n        if result.success and result.result:\n            return DocumentInfo(**result.result)\n        return None\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc.XmlRpcBridge.get_console_output","title":"<code>get_console_output(lines=100)</code>  <code>async</code>","text":"<p>Get recent console output.</p> Source code in <code>src/freecad_mcp/bridge/xmlrpc.py</code> <pre><code>    async def get_console_output(self, lines: int = 100) -&gt; list[str]:\n        \"\"\"Get recent console output.\"\"\"\n        code = f\"\"\"\n# Try to get console output from FreeCAD\noutput_lines = []\n\n# Try FreeCAD.Console if available\nif hasattr(FreeCAD, 'Console'):\n    console = FreeCAD.Console\n    if hasattr(console, 'GetLog'):\n        log = console.GetLog()\n        if log:\n            output_lines = log.split('\\\\n')[-{lines}:]\n\n_result_ = output_lines\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return result.result\n        return []\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc.XmlRpcBridge.get_documents","title":"<code>get_documents()</code>  <code>async</code>","text":"<p>Get list of open documents.</p> Source code in <code>src/freecad_mcp/bridge/xmlrpc.py</code> <pre><code>    async def get_documents(self) -&gt; list[DocumentInfo]:\n        \"\"\"Get list of open documents.\"\"\"\n        result = await self.execute_python(\n            \"\"\"\n_result_ = []\nfor doc in FreeCAD.listDocuments().values():\n    _result_.append({\n        \"name\": doc.Name,\n        \"label\": doc.Label,\n        \"path\": doc.FileName or None,\n        \"objects\": [obj.Name for obj in doc.Objects],\n        \"is_modified\": doc.Modified if hasattr(doc, \"Modified\") else False,\n        \"active_object\": doc.ActiveObject.Name if doc.ActiveObject else None,\n    })\n\"\"\"\n        )\n\n        if result.success and result.result:\n            return [DocumentInfo(**doc) for doc in result.result]\n        return []\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc.XmlRpcBridge.get_freecad_version","title":"<code>get_freecad_version()</code>  <code>async</code>","text":"<p>Get FreeCAD version information.</p> Source code in <code>src/freecad_mcp/bridge/xmlrpc.py</code> <pre><code>    async def get_freecad_version(self) -&gt; dict[str, Any]:\n        \"\"\"Get FreeCAD version information.\"\"\"\n        code = \"\"\"\nimport sys\n_result_ = {\n    \"version\": \".\".join(str(x) for x in FreeCAD.Version()[:3]),\n    \"version_tuple\": FreeCAD.Version()[:3],\n    \"build_date\": FreeCAD.Version()[3] if len(FreeCAD.Version()) &gt; 3 else \"unknown\",\n    \"python_version\": sys.version,\n    \"gui_available\": FreeCAD.GuiUp,\n}\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return result.result\n\n        return {\n            \"version\": \"unknown\",\n            \"version_tuple\": [],\n            \"build_date\": \"unknown\",\n            \"python_version\": \"\",\n            \"gui_available\": False,\n        }\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc.XmlRpcBridge.get_macros","title":"<code>get_macros()</code>  <code>async</code>","text":"<p>Get list of available macros.</p> Source code in <code>src/freecad_mcp/bridge/xmlrpc.py</code> <pre><code>    async def get_macros(self) -&gt; list[MacroInfo]:\n        \"\"\"Get list of available macros.\"\"\"\n        code = \"\"\"\nimport os\n\n# Get macro paths\nmacro_paths = []\n\n# User macro path\nuser_path = FreeCAD.getUserMacroDir(True)\nif os.path.exists(user_path):\n    macro_paths.append((\"user\", user_path))\n\n# System macro path\nsystem_path = FreeCAD.getResourceDir() + \"Macro\"\nif os.path.exists(system_path):\n    macro_paths.append((\"system\", system_path))\n\nmacros = []\nfor source, path in macro_paths:\n    for filename in os.listdir(path):\n        if filename.endswith(\".FCMacro\"):\n            macro_file = os.path.join(path, filename)\n            description = \"\"\n            try:\n                with open(macro_file, \"r\") as f:\n                    for line in f:\n                        if line.startswith(\"#\"):\n                            desc = line.lstrip(\"#\").strip()\n                            if desc and not desc.startswith(\"!\") and not desc.startswith(\"-*-\"):\n                                description = desc\n                                break\n            except Exception:\n                pass\n\n            macros.append({\n                \"name\": filename[:-8],  # Remove .FCMacro\n                \"path\": macro_file,\n                \"description\": description,\n                \"is_system\": source == \"system\",\n            })\n\n_result_ = macros\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return [MacroInfo(**m) for m in result.result]\n        return []\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc.XmlRpcBridge.get_object","title":"<code>get_object(obj_name, doc_name=None)</code>  <code>async</code>","text":"<p>Get detailed object information.</p> Source code in <code>src/freecad_mcp/bridge/xmlrpc.py</code> <pre><code>    async def get_object(\n        self,\n        obj_name: str,\n        doc_name: str | None = None,\n    ) -&gt; ObjectInfo:\n        \"\"\"Get detailed object information.\"\"\"\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nobj = doc.getObject({obj_name!r})\nif obj is None:\n    raise ValueError(f\"Object not found: {obj_name!r}\")\n\nprops = {{}}\nfor prop in obj.PropertiesList:\n    try:\n        val = getattr(obj, prop)\n        if hasattr(val, '__class__') and val.__class__.__module__ != 'builtins':\n            val = str(val)\n        props[prop] = val\n    except Exception:\n        props[prop] = \"&lt;unreadable&gt;\"\n\nshape_info = None\nif hasattr(obj, \"Shape\"):\n    shape = obj.Shape\n    shape_info = {{\n        \"shape_type\": shape.ShapeType,\n        \"volume\": shape.Volume if hasattr(shape, \"Volume\") else None,\n        \"area\": shape.Area if hasattr(shape, \"Area\") else None,\n        \"is_valid\": shape.isValid(),\n        \"is_closed\": shape.isClosed() if hasattr(shape, \"isClosed\") else False,\n        \"vertex_count\": len(shape.Vertexes) if hasattr(shape, \"Vertexes\") else 0,\n        \"edge_count\": len(shape.Edges) if hasattr(shape, \"Edges\") else 0,\n        \"face_count\": len(shape.Faces) if hasattr(shape, \"Faces\") else 0,\n    }}\n\n_result_ = {{\n    \"name\": obj.Name,\n    \"label\": obj.Label,\n    \"type_id\": obj.TypeId,\n    \"properties\": props,\n    \"shape_info\": shape_info,\n    \"children\": [c.Name for c in obj.OutList] if hasattr(obj, \"OutList\") else [],\n    \"parents\": [p.Name for p in obj.InList] if hasattr(obj, \"InList\") else [],\n    \"visibility\": obj.ViewObject.Visibility if hasattr(obj, \"ViewObject\") and obj.ViewObject else True,\n}}\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return ObjectInfo(**result.result)\n\n        error_msg = result.error_traceback or \"Failed to get object\"\n        raise ValueError(error_msg)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc.XmlRpcBridge.get_objects","title":"<code>get_objects(doc_name=None)</code>  <code>async</code>","text":"<p>Get all objects in a document.</p> Source code in <code>src/freecad_mcp/bridge/xmlrpc.py</code> <pre><code>    async def get_objects(self, doc_name: str | None = None) -&gt; list[ObjectInfo]:\n        \"\"\"Get all objects in a document.\"\"\"\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nobjects = []\nfor obj in doc.Objects:\n    obj_info = {{\n        \"name\": obj.Name,\n        \"label\": obj.Label,\n        \"type_id\": obj.TypeId,\n        \"visibility\": obj.ViewObject.Visibility if hasattr(obj, \"ViewObject\") and obj.ViewObject else True,\n        \"children\": [c.Name for c in obj.OutList] if hasattr(obj, \"OutList\") else [],\n        \"parents\": [p.Name for p in obj.InList] if hasattr(obj, \"InList\") else [],\n    }}\n    objects.append(obj_info)\n\n_result_ = objects\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return [ObjectInfo(**obj) for obj in result.result]\n        return []\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc.XmlRpcBridge.get_screenshot","title":"<code>get_screenshot(view_angle=None, width=800, height=600, doc_name=None)</code>  <code>async</code>","text":"<p>Capture a screenshot of the 3D view via XML-RPC.</p> Source code in <code>src/freecad_mcp/bridge/xmlrpc.py</code> <pre><code>    async def get_screenshot(\n        self,\n        view_angle: ViewAngle | None = None,\n        width: int = 800,\n        height: int = 600,\n        doc_name: str | None = None,\n    ) -&gt; ScreenshotResult:\n        \"\"\"Capture a screenshot of the 3D view via XML-RPC.\"\"\"\n        view_angle_str = view_angle.value if view_angle else \"Isometric\"\n        code = f\"\"\"\nimport base64\nimport tempfile\nimport os\n\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\n# Check if GUI is available\nif not FreeCAD.GuiUp:\n    raise RuntimeError(\"GUI not available\")\n\nview = FreeCADGui.ActiveDocument.ActiveView\nif view is None:\n    raise ValueError(\"No active view\")\n\n# Check if this is a 3D view (not TechDraw, Spreadsheet, etc.)\nview_type = view.__class__.__name__\nif view_type not in [\"View3DInventor\", \"View3DInventorPy\"]:\n    raise ValueError(f\"Cannot capture screenshot from {{view_type}} view\")\n\n# Set view angle\nview_type_str = {view_angle_str!r}\nif view_type_str == \"FitAll\":\n    view.fitAll()\nelif view_type_str == \"Isometric\":\n    view.viewIsometric()\nelif view_type_str == \"Front\":\n    view.viewFront()\nelif view_type_str == \"Back\":\n    view.viewRear()\nelif view_type_str == \"Top\":\n    view.viewTop()\nelif view_type_str == \"Bottom\":\n    view.viewBottom()\nelif view_type_str == \"Left\":\n    view.viewLeft()\nelif view_type_str == \"Right\":\n    view.viewRight()\n\n# Save to temp file and read\nwith tempfile.NamedTemporaryFile(suffix=\".png\", delete=False) as f:\n    temp_path = f.name\n\nview.saveImage(temp_path, {width}, {height}, \"Current\")\n\nwith open(temp_path, \"rb\") as f:\n    image_data = base64.b64encode(f.read()).decode(\"utf-8\")\n\nos.unlink(temp_path)\n\n_result_ = {{\n    \"success\": True,\n    \"data\": image_data,\n    \"format\": \"png\",\n    \"width\": {width},\n    \"height\": {height},\n}}\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return ScreenshotResult(\n                success=True,\n                data=result.result[\"data\"],\n                format=result.result[\"format\"],\n                width=result.result[\"width\"],\n                height=result.result[\"height\"],\n                view_angle=view_angle,\n            )\n\n        return ScreenshotResult(\n            success=False,\n            error=result.error_traceback\n            or result.stderr\n            or \"Failed to capture screenshot\",\n            width=width,\n            height=height,\n            view_angle=view_angle,\n        )\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc.XmlRpcBridge.get_status","title":"<code>get_status()</code>  <code>async</code>","text":"<p>Get detailed connection status.</p> <p>Returns:</p> Type Description <code>ConnectionStatus</code> <p>ConnectionStatus with full status information.</p> Source code in <code>src/freecad_mcp/bridge/xmlrpc.py</code> <pre><code>async def get_status(self) -&gt; ConnectionStatus:\n    \"\"\"Get detailed connection status.\n\n    Returns:\n        ConnectionStatus with full status information.\n    \"\"\"\n    if not self._connected or self._proxy is None:\n        return ConnectionStatus(\n            connected=False,\n            mode=\"xmlrpc\",\n            error=\"Not connected\",\n        )\n\n    try:\n        ping_ms = await self.ping()\n        version_info = await self.get_freecad_version()\n        gui_available = await self.is_gui_available()\n\n        return ConnectionStatus(\n            connected=True,\n            mode=\"xmlrpc\",\n            freecad_version=version_info.get(\"version\", \"unknown\"),\n            gui_available=gui_available,\n            last_ping_ms=ping_ms,\n        )\n    except Exception as e:\n        return ConnectionStatus(\n            connected=False,\n            mode=\"xmlrpc\",\n            error=str(e),\n        )\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc.XmlRpcBridge.get_workbenches","title":"<code>get_workbenches()</code>  <code>async</code>","text":"<p>Get list of available workbenches.</p> Source code in <code>src/freecad_mcp/bridge/xmlrpc.py</code> <pre><code>    async def get_workbenches(self) -&gt; list[WorkbenchInfo]:\n        \"\"\"Get list of available workbenches.\"\"\"\n        code = \"\"\"\nworkbenches = []\nactive_wb = FreeCADGui.activeWorkbench() if FreeCAD.GuiUp else None\nactive_name = active_wb.__class__.__name__ if active_wb else None\n\nif FreeCAD.GuiUp:\n    for name in FreeCADGui.listWorkbenches():\n        wb = FreeCADGui.getWorkbench(name)\n        workbenches.append({\n            \"name\": name,\n            \"label\": wb.MenuText if hasattr(wb, \"MenuText\") else name,\n            \"icon\": wb.Icon if hasattr(wb, \"Icon\") else \"\",\n            \"is_active\": name == active_name,\n        })\nelse:\n    # Return common workbenches for headless mode\n    common = [\"StartWorkbench\", \"PartWorkbench\", \"PartDesignWorkbench\",\n              \"DraftWorkbench\", \"SketcherWorkbench\", \"MeshWorkbench\"]\n    for name in common:\n        workbenches.append({\n            \"name\": name,\n            \"label\": name.replace(\"Workbench\", \"\"),\n            \"icon\": \"\",\n            \"is_active\": False,\n        })\n\n_result_ = workbenches\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return [WorkbenchInfo(**wb) for wb in result.result]\n        return []\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc.XmlRpcBridge.is_connected","title":"<code>is_connected()</code>  <code>async</code>","text":"<p>Check if bridge is connected to FreeCAD.</p> Source code in <code>src/freecad_mcp/bridge/xmlrpc.py</code> <pre><code>async def is_connected(self) -&gt; bool:\n    \"\"\"Check if bridge is connected to FreeCAD.\"\"\"\n    if not self._connected or self._proxy is None:\n        return False\n\n    try:\n        await self.ping()\n        return True\n    except Exception:\n        self._connected = False\n        return False\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc.XmlRpcBridge.is_gui_available","title":"<code>is_gui_available()</code>  <code>async</code>","text":"<p>Check if FreeCAD GUI is available.</p> Source code in <code>src/freecad_mcp/bridge/xmlrpc.py</code> <pre><code>async def is_gui_available(self) -&gt; bool:\n    \"\"\"Check if FreeCAD GUI is available.\"\"\"\n    result = await self.execute_python(\"_result_ = FreeCAD.GuiUp\")\n    return bool(result.success and result.result)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc.XmlRpcBridge.open_document","title":"<code>open_document(path)</code>  <code>async</code>","text":"<p>Open an existing document.</p> Source code in <code>src/freecad_mcp/bridge/xmlrpc.py</code> <pre><code>    async def open_document(self, path: str) -&gt; DocumentInfo:\n        \"\"\"Open an existing document.\"\"\"\n        result = await self.execute_python(\n            f\"\"\"\nimport os\nif not os.path.exists({path!r}):\n    raise FileNotFoundError(f\"File not found: {path!r}\")\n\ndoc = FreeCAD.openDocument({path!r})\n_result_ = {{\n    \"name\": doc.Name,\n    \"label\": doc.Label,\n    \"path\": doc.FileName or None,\n    \"objects\": [obj.Name for obj in doc.Objects],\n    \"is_modified\": doc.Modified if hasattr(doc, \"Modified\") else False,\n}}\n\"\"\"\n        )\n\n        if result.success and result.result:\n            return DocumentInfo(**result.result)\n\n        if \"FileNotFoundError\" in (result.error_type or \"\"):\n            raise FileNotFoundError(result.stderr)\n\n        error_msg = result.error_traceback or \"Failed to open document\"\n        raise ValueError(error_msg)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc.XmlRpcBridge.ping","title":"<code>ping()</code>  <code>async</code>","text":"<p>Ping FreeCAD to check connection and measure latency.</p> <p>Returns:</p> Type Description <code>float</code> <p>Round-trip time in milliseconds.</p> <p>Raises:</p> Type Description <code>ConnectionError</code> <p>If not connected.</p> Source code in <code>src/freecad_mcp/bridge/xmlrpc.py</code> <pre><code>async def ping(self) -&gt; float:\n    \"\"\"Ping FreeCAD to check connection and measure latency.\n\n    Returns:\n        Round-trip time in milliseconds.\n\n    Raises:\n        ConnectionError: If not connected.\n    \"\"\"\n    if self._proxy is None:\n        msg = \"Not connected to XML-RPC server\"\n        raise ConnectionError(msg)\n\n    loop = asyncio.get_event_loop()\n    start = time.perf_counter()\n\n    try:\n        # Try standard system.listMethods or a simple execute\n        if self._proxy is None:\n            msg = \"Not connected\"\n            raise ConnectionError(msg)\n        proxy = self._proxy  # Local reference for lambda\n        await asyncio.wait_for(\n            loop.run_in_executor(\n                None,\n                lambda: proxy.execute(\"_result_ = True\"),\n            ),\n            timeout=self._timeout,\n        )\n    except TimeoutError as e:\n        msg = \"Ping timed out\"\n        raise ConnectionError(msg) from e\n    except Exception as e:\n        msg = f\"Ping failed: {e}\"\n        raise ConnectionError(msg) from e\n\n    return (time.perf_counter() - start) * 1000\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc.XmlRpcBridge.run_macro","title":"<code>run_macro(macro_name, args=None)</code>  <code>async</code>","text":"<p>Run a macro by name.</p> Source code in <code>src/freecad_mcp/bridge/xmlrpc.py</code> <pre><code>    async def run_macro(\n        self,\n        macro_name: str,\n        args: dict[str, Any] | None = None,\n    ) -&gt; ExecutionResult:\n        \"\"\"Run a macro by name.\"\"\"\n        args = args or {}\n        code = f\"\"\"\nimport os\n\n# Find macro file\nmacro_name = {macro_name!r}\nmacro_file = None\n\n# Check user macros first\nuser_path = FreeCAD.getUserMacroDir(True)\nuser_macro = os.path.join(user_path, macro_name + \".FCMacro\")\nif os.path.exists(user_macro):\n    macro_file = user_macro\n\n# Check system macros\nif not macro_file:\n    system_path = FreeCAD.getResourceDir() + \"Macro\"\n    system_macro = os.path.join(system_path, macro_name + \".FCMacro\")\n    if os.path.exists(system_macro):\n        macro_file = system_macro\n\nif not macro_file:\n    raise FileNotFoundError(f\"Macro not found: {{macro_name}}\")\n\n# Set up arguments\nargs = {args!r}\nfor k, v in args.items():\n    exec(f\"{{k}} = {{v!r}}\")\n\n# Execute macro\nwith open(macro_file, \"r\") as f:\n    macro_code = f.read()\n\nexec(macro_code)\n_result_ = True\n\"\"\"\n        return await self.execute_python(code)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc.XmlRpcBridge.save_document","title":"<code>save_document(doc_name=None, path=None)</code>  <code>async</code>","text":"<p>Save a document.</p> Source code in <code>src/freecad_mcp/bridge/xmlrpc.py</code> <pre><code>    async def save_document(\n        self,\n        doc_name: str | None = None,\n        path: str | None = None,\n    ) -&gt; str:\n        \"\"\"Save a document.\"\"\"\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No active document\" if {doc_name!r} is None else f\"Document not found: {doc_name!r}\")\n\nsave_path = {path!r} or doc.FileName\nif not save_path:\n    raise ValueError(\"No path specified for new document\")\n\ndoc.saveAs(save_path)\n_result_ = save_path\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return result.result\n\n        error_msg = result.error_traceback or \"Failed to save document\"\n        raise ValueError(error_msg)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.xmlrpc.XmlRpcBridge.set_view","title":"<code>set_view(view_angle, doc_name=None)</code>  <code>async</code>","text":"<p>Set the 3D view angle.</p> Source code in <code>src/freecad_mcp/bridge/xmlrpc.py</code> <pre><code>    async def set_view(\n        self,\n        view_angle: ViewAngle,\n        doc_name: str | None = None,\n    ) -&gt; None:\n        \"\"\"Set the 3D view angle.\"\"\"\n        view_angle_str = view_angle.value\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nif not FreeCAD.GuiUp:\n    _result_ = True  # Silently succeed in headless mode\nelse:\n    view = FreeCADGui.ActiveDocument.ActiveView\n    if view is None:\n        raise ValueError(\"No active view\")\n\n    view_type = {view_angle_str!r}\n    if view_type == \"FitAll\":\n        view.fitAll()\n    elif view_type == \"Isometric\":\n        view.viewIsometric()\n    elif view_type == \"Front\":\n        view.viewFront()\n    elif view_type == \"Back\":\n        view.viewRear()\n    elif view_type == \"Top\":\n        view.viewTop()\n    elif view_type == \"Bottom\":\n        view.viewBottom()\n    elif view_type == \"Left\":\n        view.viewLeft()\n    elif view_type == \"Right\":\n        view.viewRight()\n\n    _result_ = True\n\"\"\"\n        await self.execute_python(code)\n</code></pre>"},{"location":"api/bridge/#socket-bridge","title":"Socket Bridge","text":"<p>options: show_root_heading: true show_source: true</p>"},{"location":"api/bridge/#freecad_mcp.bridge.socket","title":"<code>freecad_mcp.bridge.socket</code>","text":"<p>Socket bridge for FreeCAD communication via JSON-RPC.</p> <p>This bridge communicates with FreeCAD using JSON-RPC over TCP sockets, providing a modern, lightweight alternative to XML-RPC.</p> <p>Based on learnings from competitive analysis: - Simple socket-based approach (inspired by bonninr/freecad_mcp) - Connection recovery mechanisms (from jango-blockchained) - Automatic reconnection on connection loss</p>"},{"location":"api/bridge/#freecad_mcp.bridge.socket-classes","title":"Classes","text":""},{"location":"api/bridge/#freecad_mcp.bridge.socket.JsonRpcError","title":"<code>JsonRpcError</code>","text":"<p>               Bases: <code>Exception</code></p> <p>JSON-RPC error response.</p> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>class JsonRpcError(Exception):\n    \"\"\"JSON-RPC error response.\"\"\"\n\n    def __init__(self, code: int, message: str, data: Any = None) -&gt; None:\n        \"\"\"Initialize JSON-RPC error.\n\n        Args:\n            code: Error code.\n            message: Error message.\n            data: Additional error data.\n        \"\"\"\n        super().__init__(message)\n        self.code = code\n        self.message = message\n        self.data = data\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.socket.JsonRpcError-functions","title":"Functions","text":""},{"location":"api/bridge/#freecad_mcp.bridge.socket.JsonRpcError.__init__","title":"<code>__init__(code, message, data=None)</code>","text":"<p>Initialize JSON-RPC error.</p> <p>Parameters:</p> Name Type Description Default <code>code</code> <code>int</code> <p>Error code.</p> required <code>message</code> <code>str</code> <p>Error message.</p> required <code>data</code> <code>Any</code> <p>Additional error data.</p> <code>None</code> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>def __init__(self, code: int, message: str, data: Any = None) -&gt; None:\n    \"\"\"Initialize JSON-RPC error.\n\n    Args:\n        code: Error code.\n        message: Error message.\n        data: Additional error data.\n    \"\"\"\n    super().__init__(message)\n    self.code = code\n    self.message = message\n    self.data = data\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.socket.SocketBridge","title":"<code>SocketBridge</code>","text":"<p>               Bases: <code>FreecadBridge</code></p> <p>Bridge that communicates with FreeCAD via JSON-RPC over sockets.</p> <p>This bridge provides a lightweight, modern protocol for FreeCAD communication. It supports automatic reconnection and connection health monitoring.</p> <p>Attributes:</p> Name Type Description <code>host</code> <p>Socket server hostname.</p> <code>port</code> <p>Socket server port.</p> <code>timeout</code> <p>Connection and request timeout in seconds.</p> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>class SocketBridge(FreecadBridge):\n    \"\"\"Bridge that communicates with FreeCAD via JSON-RPC over sockets.\n\n    This bridge provides a lightweight, modern protocol for FreeCAD\n    communication. It supports automatic reconnection and connection\n    health monitoring.\n\n    Attributes:\n        host: Socket server hostname.\n        port: Socket server port.\n        timeout: Connection and request timeout in seconds.\n    \"\"\"\n\n    def __init__(\n        self,\n        host: str = DEFAULT_SOCKET_HOST,\n        port: int = DEFAULT_SOCKET_PORT,\n        timeout: float = DEFAULT_TIMEOUT,\n        auto_reconnect: bool = True,\n    ) -&gt; None:\n        \"\"\"Initialize the socket bridge.\n\n        Args:\n            host: Socket server hostname.\n            port: Socket server port.\n            timeout: Connection and request timeout in seconds.\n            auto_reconnect: Whether to automatically reconnect on connection loss.\n        \"\"\"\n        self._host = host\n        self._port = port\n        self._timeout = timeout\n        self._auto_reconnect = auto_reconnect\n        self._reader: asyncio.StreamReader | None = None\n        self._writer: asyncio.StreamWriter | None = None\n        self._connected = False\n        self._lock = asyncio.Lock()\n\n    async def connect(self) -&gt; None:\n        \"\"\"Establish connection to FreeCAD socket server.\n\n        Raises:\n            ConnectionError: If connection cannot be established.\n        \"\"\"\n        try:\n            self._reader, self._writer = await asyncio.wait_for(\n                asyncio.open_connection(self._host, self._port),\n                timeout=self._timeout,\n            )\n            self._connected = True\n\n            # Verify connection with a ping\n            await self.ping()\n        except TimeoutError as e:\n            msg = f\"Connection to {self._host}:{self._port} timed out\"\n            raise ConnectionError(msg) from e\n        except Exception as e:\n            self._connected = False\n            msg = f\"Failed to connect to {self._host}:{self._port}: {e}\"\n            raise ConnectionError(msg) from e\n\n    async def disconnect(self) -&gt; None:\n        \"\"\"Close connection to FreeCAD socket server.\"\"\"\n        if self._writer:\n            self._writer.close()\n            with contextlib.suppress(Exception):\n                await self._writer.wait_closed()\n        self._reader = None\n        self._writer = None\n        self._connected = False\n\n    async def is_connected(self) -&gt; bool:\n        \"\"\"Check if bridge is connected to FreeCAD.\"\"\"\n        if not self._connected or self._writer is None:\n            return False\n\n        try:\n            await self.ping()\n            return True\n        except Exception:\n            self._connected = False\n            return False\n\n    async def _send_request(\n        self,\n        method: str,\n        params: dict[str, Any] | None = None,\n    ) -&gt; Any:\n        \"\"\"Send a JSON-RPC request and wait for response.\n\n        Args:\n            method: Method name to call.\n            params: Method parameters.\n\n        Returns:\n            Result from the JSON-RPC response.\n\n        Raises:\n            ConnectionError: If not connected.\n            JsonRpcError: If server returns an error.\n        \"\"\"\n        if self._writer is None or self._reader is None:\n            msg = \"Not connected to socket server\"\n            raise ConnectionError(msg)\n\n        # Build JSON-RPC request\n        request_id = str(uuid.uuid4())\n        request = {\n            \"jsonrpc\": \"2.0\",\n            \"id\": request_id,\n            \"method\": method,\n            \"params\": params or {},\n        }\n\n        async with self._lock:\n            try:\n                # Send request\n                request_data = json.dumps(request).encode(\"utf-8\") + b\"\\n\"\n                self._writer.write(request_data)\n                await self._writer.drain()\n\n                # Read response\n                response_data = await asyncio.wait_for(\n                    self._reader.readline(),\n                    timeout=self._timeout,\n                )\n\n                if not response_data:\n                    self._connected = False\n                    msg = \"Connection closed by server\"\n                    raise ConnectionError(msg)\n\n                response = json.loads(response_data.decode(\"utf-8\"))\n\n                # Check for error\n                if \"error\" in response:\n                    error = response[\"error\"]\n                    raise JsonRpcError(\n                        code=error.get(\"code\", -1),\n                        message=error.get(\"message\", \"Unknown error\"),\n                        data=error.get(\"data\"),\n                    )\n\n                return response.get(\"result\")\n\n            except TimeoutError as e:\n                msg = \"Request timed out\"\n                raise ConnectionError(msg) from e\n            except json.JSONDecodeError as e:\n                msg = f\"Invalid JSON response: {e}\"\n                raise ConnectionError(msg) from e\n            except (ConnectionResetError, BrokenPipeError) as e:\n                self._connected = False\n                if self._auto_reconnect:\n                    # Try to reconnect\n                    try:\n                        await self.connect()\n                        return await self._send_request(method, params)\n                    except Exception:\n                        pass\n                msg = f\"Connection lost: {e}\"\n                raise ConnectionError(msg) from e\n\n    async def ping(self) -&gt; float:\n        \"\"\"Ping FreeCAD to check connection and measure latency.\n\n        Returns:\n            Round-trip time in milliseconds.\n\n        Raises:\n            ConnectionError: If not connected.\n        \"\"\"\n        start = time.perf_counter()\n        await self._send_request(\"ping\")\n        return (time.perf_counter() - start) * 1000\n\n    async def get_status(self) -&gt; ConnectionStatus:\n        \"\"\"Get detailed connection status.\n\n        Returns:\n            ConnectionStatus with full status information.\n        \"\"\"\n        if not self._connected:\n            return ConnectionStatus(\n                connected=False,\n                mode=\"socket\",\n                error=\"Not connected\",\n            )\n\n        try:\n            ping_ms = await self.ping()\n            version_info = await self.get_freecad_version()\n            gui_available = await self.is_gui_available()\n\n            return ConnectionStatus(\n                connected=True,\n                mode=\"socket\",\n                freecad_version=version_info.get(\"version\", \"unknown\"),\n                gui_available=gui_available,\n                last_ping_ms=ping_ms,\n            )\n        except Exception as e:\n            return ConnectionStatus(\n                connected=False,\n                mode=\"socket\",\n                error=str(e),\n            )\n\n    # =========================================================================\n    # Code Execution\n    # =========================================================================\n\n    async def execute_python(\n        self,\n        code: str,\n        timeout_ms: int = 30000,\n    ) -&gt; ExecutionResult:\n        \"\"\"Execute Python code in FreeCAD context via socket.\n\n        Args:\n            code: Python code to execute.\n            timeout_ms: Maximum execution time in milliseconds.\n\n        Returns:\n            ExecutionResult with execution outcome.\n        \"\"\"\n        start = time.perf_counter()\n\n        try:\n            result = await asyncio.wait_for(\n                self._send_request(\"execute\", {\"code\": code}),\n                timeout=timeout_ms / 1000,\n            )\n            elapsed = (time.perf_counter() - start) * 1000\n\n            if isinstance(result, dict):\n                return ExecutionResult(\n                    success=result.get(\"success\", False),\n                    result=result.get(\"result\"),\n                    stdout=result.get(\"stdout\", \"\"),\n                    stderr=result.get(\"stderr\", \"\"),\n                    execution_time_ms=elapsed,\n                    error_type=result.get(\"error_type\"),\n                    error_traceback=result.get(\"error_traceback\"),\n                )\n            else:\n                return ExecutionResult(\n                    success=True,\n                    result=result,\n                    stdout=\"\",\n                    stderr=\"\",\n                    execution_time_ms=elapsed,\n                )\n\n        except TimeoutError:\n            return ExecutionResult(\n                success=False,\n                result=None,\n                stdout=\"\",\n                stderr=f\"Execution timed out after {timeout_ms}ms\",\n                execution_time_ms=float(timeout_ms),\n                error_type=\"TimeoutError\",\n            )\n        except JsonRpcError as e:\n            elapsed = (time.perf_counter() - start) * 1000\n            return ExecutionResult(\n                success=False,\n                result=None,\n                stdout=\"\",\n                stderr=e.message,\n                execution_time_ms=elapsed,\n                error_type=\"JsonRpcError\",\n            )\n        except ConnectionError as e:\n            return ExecutionResult(\n                success=False,\n                result=None,\n                stdout=\"\",\n                stderr=str(e),\n                execution_time_ms=0,\n                error_type=\"ConnectionError\",\n            )\n\n    # =========================================================================\n    # Document Management\n    # =========================================================================\n\n    async def get_documents(self) -&gt; list[DocumentInfo]:\n        \"\"\"Get list of open documents.\"\"\"\n        result = await self.execute_python(\n            \"\"\"\n_result_ = []\nfor doc in FreeCAD.listDocuments().values():\n    _result_.append({\n        \"name\": doc.Name,\n        \"label\": doc.Label,\n        \"path\": doc.FileName or None,\n        \"objects\": [obj.Name for obj in doc.Objects],\n        \"is_modified\": doc.Modified if hasattr(doc, \"Modified\") else False,\n        \"active_object\": doc.ActiveObject.Name if doc.ActiveObject else None,\n    })\n\"\"\"\n        )\n\n        if result.success and result.result:\n            return [DocumentInfo(**doc) for doc in result.result]\n        return []\n\n    async def get_active_document(self) -&gt; DocumentInfo | None:\n        \"\"\"Get the active document.\"\"\"\n        result = await self.execute_python(\n            \"\"\"\ndoc = FreeCAD.ActiveDocument\nif doc:\n    _result_ = {\n        \"name\": doc.Name,\n        \"label\": doc.Label,\n        \"path\": doc.FileName or None,\n        \"objects\": [obj.Name for obj in doc.Objects],\n        \"is_modified\": doc.Modified if hasattr(doc, \"Modified\") else False,\n        \"active_object\": doc.ActiveObject.Name if doc.ActiveObject else None,\n    }\nelse:\n    _result_ = None\n\"\"\"\n        )\n\n        if result.success and result.result:\n            return DocumentInfo(**result.result)\n        return None\n\n    async def create_document(\n        self, name: str, label: str | None = None\n    ) -&gt; DocumentInfo:\n        \"\"\"Create a new document.\"\"\"\n        label = label or name\n        result = await self.execute_python(\n            f\"\"\"\ndoc = FreeCAD.newDocument({name!r})\ndoc.Label = {label!r}\n_result_ = {{\n    \"name\": doc.Name,\n    \"label\": doc.Label,\n    \"path\": doc.FileName or None,\n    \"objects\": [],\n    \"is_modified\": False,\n}}\n\"\"\"\n        )\n\n        if result.success and result.result:\n            return DocumentInfo(**result.result)\n\n        error_msg = result.error_traceback or \"Failed to create document\"\n        raise ValueError(error_msg)\n\n    async def open_document(self, path: str) -&gt; DocumentInfo:\n        \"\"\"Open an existing document.\"\"\"\n        result = await self.execute_python(\n            f\"\"\"\nimport os\nif not os.path.exists({path!r}):\n    raise FileNotFoundError(f\"File not found: {path!r}\")\n\ndoc = FreeCAD.openDocument({path!r})\n_result_ = {{\n    \"name\": doc.Name,\n    \"label\": doc.Label,\n    \"path\": doc.FileName or None,\n    \"objects\": [obj.Name for obj in doc.Objects],\n    \"is_modified\": doc.Modified if hasattr(doc, \"Modified\") else False,\n}}\n\"\"\"\n        )\n\n        if result.success and result.result:\n            return DocumentInfo(**result.result)\n\n        if \"FileNotFoundError\" in (result.error_type or \"\"):\n            raise FileNotFoundError(result.stderr)\n\n        error_msg = result.error_traceback or \"Failed to open document\"\n        raise ValueError(error_msg)\n\n    async def save_document(\n        self,\n        doc_name: str | None = None,\n        path: str | None = None,\n    ) -&gt; str:\n        \"\"\"Save a document.\"\"\"\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No active document\" if {doc_name!r} is None else f\"Document not found: {doc_name!r}\")\n\nsave_path = {path!r} or doc.FileName\nif not save_path:\n    raise ValueError(\"No path specified for new document\")\n\ndoc.saveAs(save_path)\n_result_ = save_path\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return result.result\n\n        error_msg = result.error_traceback or \"Failed to save document\"\n        raise ValueError(error_msg)\n\n    async def close_document(self, doc_name: str | None = None) -&gt; None:\n        \"\"\"Close a document.\"\"\"\n        code = f\"\"\"\ndoc_name = {doc_name!r}\nif doc_name is None:\n    doc = FreeCAD.ActiveDocument\n    if doc:\n        doc_name = doc.Name\n    else:\n        raise ValueError(\"No active document\")\n\nFreeCAD.closeDocument(doc_name)\n_result_ = True\n\"\"\"\n        result = await self.execute_python(code)\n\n        if not result.success:\n            error_msg = result.error_traceback or \"Failed to close document\"\n            raise ValueError(error_msg)\n\n    # =========================================================================\n    # Object Management\n    # =========================================================================\n\n    async def get_objects(self, doc_name: str | None = None) -&gt; list[ObjectInfo]:\n        \"\"\"Get all objects in a document.\"\"\"\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nobjects = []\nfor obj in doc.Objects:\n    obj_info = {{\n        \"name\": obj.Name,\n        \"label\": obj.Label,\n        \"type_id\": obj.TypeId,\n        \"visibility\": obj.ViewObject.Visibility if hasattr(obj, \"ViewObject\") and obj.ViewObject else True,\n        \"children\": [c.Name for c in obj.OutList] if hasattr(obj, \"OutList\") else [],\n        \"parents\": [p.Name for p in obj.InList] if hasattr(obj, \"InList\") else [],\n    }}\n    objects.append(obj_info)\n\n_result_ = objects\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return [ObjectInfo(**obj) for obj in result.result]\n        return []\n\n    async def get_object(\n        self,\n        obj_name: str,\n        doc_name: str | None = None,\n    ) -&gt; ObjectInfo:\n        \"\"\"Get detailed object information.\"\"\"\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nobj = doc.getObject({obj_name!r})\nif obj is None:\n    raise ValueError(f\"Object not found: {obj_name!r}\")\n\nprops = {{}}\nfor prop in obj.PropertiesList:\n    try:\n        val = getattr(obj, prop)\n        if hasattr(val, '__class__') and val.__class__.__module__ != 'builtins':\n            val = str(val)\n        props[prop] = val\n    except Exception:\n        props[prop] = \"&lt;unreadable&gt;\"\n\nshape_info = None\nif hasattr(obj, \"Shape\"):\n    shape = obj.Shape\n    shape_info = {{\n        \"shape_type\": shape.ShapeType,\n        \"volume\": shape.Volume if hasattr(shape, \"Volume\") else None,\n        \"area\": shape.Area if hasattr(shape, \"Area\") else None,\n        \"is_valid\": shape.isValid(),\n        \"is_closed\": shape.isClosed() if hasattr(shape, \"isClosed\") else False,\n        \"vertex_count\": len(shape.Vertexes) if hasattr(shape, \"Vertexes\") else 0,\n        \"edge_count\": len(shape.Edges) if hasattr(shape, \"Edges\") else 0,\n        \"face_count\": len(shape.Faces) if hasattr(shape, \"Faces\") else 0,\n    }}\n\n_result_ = {{\n    \"name\": obj.Name,\n    \"label\": obj.Label,\n    \"type_id\": obj.TypeId,\n    \"properties\": props,\n    \"shape_info\": shape_info,\n    \"children\": [c.Name for c in obj.OutList] if hasattr(obj, \"OutList\") else [],\n    \"parents\": [p.Name for p in obj.InList] if hasattr(obj, \"InList\") else [],\n    \"visibility\": obj.ViewObject.Visibility if hasattr(obj, \"ViewObject\") and obj.ViewObject else True,\n}}\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return ObjectInfo(**result.result)\n\n        error_msg = result.error_traceback or \"Failed to get object\"\n        raise ValueError(error_msg)\n\n    async def create_object(\n        self,\n        type_id: str,\n        name: str | None = None,\n        properties: dict[str, Any] | None = None,\n        doc_name: str | None = None,\n    ) -&gt; ObjectInfo:\n        \"\"\"Create a new object.\"\"\"\n        properties = properties or {}\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nobj = doc.addObject({type_id!r}, {name!r} or \"\")\n\n# Set properties\nfor prop_name, prop_val in {properties!r}.items():\n    if hasattr(obj, prop_name):\n        setattr(obj, prop_name, prop_val)\n\ndoc.recompute()\n\n_result_ = {{\n    \"name\": obj.Name,\n    \"label\": obj.Label,\n    \"type_id\": obj.TypeId,\n    \"visibility\": True,\n    \"children\": [c.Name for c in obj.OutList] if hasattr(obj, \"OutList\") else [],\n    \"parents\": [p.Name for p in obj.InList] if hasattr(obj, \"InList\") else [],\n}}\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return ObjectInfo(**result.result)\n\n        error_msg = result.error_traceback or \"Failed to create object\"\n        raise ValueError(error_msg)\n\n    async def edit_object(\n        self,\n        obj_name: str,\n        properties: dict[str, Any],\n        doc_name: str | None = None,\n    ) -&gt; ObjectInfo:\n        \"\"\"Edit object properties.\"\"\"\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nobj = doc.getObject({obj_name!r})\nif obj is None:\n    raise ValueError(f\"Object not found: {obj_name!r}\")\n\n# Set properties\nfor prop_name, prop_val in {properties!r}.items():\n    if hasattr(obj, prop_name):\n        setattr(obj, prop_name, prop_val)\n\ndoc.recompute()\n\n_result_ = {{\n    \"name\": obj.Name,\n    \"label\": obj.Label,\n    \"type_id\": obj.TypeId,\n    \"visibility\": obj.ViewObject.Visibility if hasattr(obj, \"ViewObject\") and obj.ViewObject else True,\n    \"children\": [c.Name for c in obj.OutList] if hasattr(obj, \"OutList\") else [],\n    \"parents\": [p.Name for p in obj.InList] if hasattr(obj, \"InList\") else [],\n}}\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return ObjectInfo(**result.result)\n\n        error_msg = result.error_traceback or \"Failed to edit object\"\n        raise ValueError(error_msg)\n\n    async def delete_object(\n        self,\n        obj_name: str,\n        doc_name: str | None = None,\n    ) -&gt; None:\n        \"\"\"Delete an object.\"\"\"\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nobj = doc.getObject({obj_name!r})\nif obj is None:\n    raise ValueError(f\"Object not found: {obj_name!r}\")\n\ndoc.removeObject({obj_name!r})\n_result_ = True\n\"\"\"\n        result = await self.execute_python(code)\n\n        if not result.success:\n            error_msg = result.error_traceback or \"Failed to delete object\"\n            raise ValueError(error_msg)\n\n    # =========================================================================\n    # View and Screenshot\n    # =========================================================================\n\n    async def get_screenshot(\n        self,\n        view_angle: ViewAngle | None = None,\n        width: int = 800,\n        height: int = 600,\n        doc_name: str | None = None,\n    ) -&gt; ScreenshotResult:\n        \"\"\"Capture a screenshot of the 3D view via socket.\"\"\"\n        view_angle_str = view_angle.value if view_angle else \"Isometric\"\n        code = f\"\"\"\nimport base64\nimport tempfile\nimport os\n\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\n# Check if GUI is available\nif not FreeCAD.GuiUp:\n    raise RuntimeError(\"GUI not available\")\n\nview = FreeCADGui.ActiveDocument.ActiveView\nif view is None:\n    raise ValueError(\"No active view\")\n\n# Check view type\nview_type = view.__class__.__name__\nif view_type not in [\"View3DInventor\", \"View3DInventorPy\"]:\n    raise ValueError(f\"Cannot capture screenshot from {{view_type}} view\")\n\n# Set view angle\nview_type_str = {view_angle_str!r}\nif view_type_str == \"FitAll\":\n    view.fitAll()\nelif view_type_str == \"Isometric\":\n    view.viewIsometric()\nelif view_type_str == \"Front\":\n    view.viewFront()\nelif view_type_str == \"Back\":\n    view.viewRear()\nelif view_type_str == \"Top\":\n    view.viewTop()\nelif view_type_str == \"Bottom\":\n    view.viewBottom()\nelif view_type_str == \"Left\":\n    view.viewLeft()\nelif view_type_str == \"Right\":\n    view.viewRight()\n\n# Save to temp file and read\nwith tempfile.NamedTemporaryFile(suffix=\".png\", delete=False) as f:\n    temp_path = f.name\n\nview.saveImage(temp_path, {width}, {height}, \"Current\")\n\nwith open(temp_path, \"rb\") as f:\n    image_data = base64.b64encode(f.read()).decode(\"utf-8\")\n\nos.unlink(temp_path)\n\n_result_ = {{\n    \"success\": True,\n    \"data\": image_data,\n    \"format\": \"png\",\n    \"width\": {width},\n    \"height\": {height},\n}}\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return ScreenshotResult(\n                success=True,\n                data=result.result[\"data\"],\n                format=result.result[\"format\"],\n                width=result.result[\"width\"],\n                height=result.result[\"height\"],\n                view_angle=view_angle,\n            )\n\n        return ScreenshotResult(\n            success=False,\n            error=result.error_traceback\n            or result.stderr\n            or \"Failed to capture screenshot\",\n            width=width,\n            height=height,\n            view_angle=view_angle,\n        )\n\n    async def set_view(\n        self,\n        view_angle: ViewAngle,\n        doc_name: str | None = None,\n    ) -&gt; None:\n        \"\"\"Set the 3D view angle.\"\"\"\n        view_angle_str = view_angle.value\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nif not FreeCAD.GuiUp:\n    _result_ = True\nelse:\n    view = FreeCADGui.ActiveDocument.ActiveView\n    if view is None:\n        raise ValueError(\"No active view\")\n\n    view_type = {view_angle_str!r}\n    if view_type == \"FitAll\":\n        view.fitAll()\n    elif view_type == \"Isometric\":\n        view.viewIsometric()\n    elif view_type == \"Front\":\n        view.viewFront()\n    elif view_type == \"Back\":\n        view.viewRear()\n    elif view_type == \"Top\":\n        view.viewTop()\n    elif view_type == \"Bottom\":\n        view.viewBottom()\n    elif view_type == \"Left\":\n        view.viewLeft()\n    elif view_type == \"Right\":\n        view.viewRight()\n\n    _result_ = True\n\"\"\"\n        await self.execute_python(code)\n\n    # =========================================================================\n    # Macros\n    # =========================================================================\n\n    async def get_macros(self) -&gt; list[MacroInfo]:\n        \"\"\"Get list of available macros.\"\"\"\n        code = \"\"\"\nimport os\n\nmacro_paths = []\n\nuser_path = FreeCAD.getUserMacroDir(True)\nif os.path.exists(user_path):\n    macro_paths.append((\"user\", user_path))\n\nsystem_path = FreeCAD.getResourceDir() + \"Macro\"\nif os.path.exists(system_path):\n    macro_paths.append((\"system\", system_path))\n\nmacros = []\nfor source, path in macro_paths:\n    for filename in os.listdir(path):\n        if filename.endswith(\".FCMacro\"):\n            macro_file = os.path.join(path, filename)\n            description = \"\"\n            try:\n                with open(macro_file, \"r\") as f:\n                    for line in f:\n                        if line.startswith(\"#\"):\n                            desc = line.lstrip(\"#\").strip()\n                            if desc and not desc.startswith(\"!\") and not desc.startswith(\"-*-\"):\n                                description = desc\n                                break\n            except Exception:\n                pass\n\n            macros.append({\n                \"name\": filename[:-8],\n                \"path\": macro_file,\n                \"description\": description,\n                \"is_system\": source == \"system\",\n            })\n\n_result_ = macros\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return [MacroInfo(**m) for m in result.result]\n        return []\n\n    async def run_macro(\n        self,\n        macro_name: str,\n        args: dict[str, Any] | None = None,\n    ) -&gt; ExecutionResult:\n        \"\"\"Run a macro by name.\"\"\"\n        args = args or {}\n        code = f\"\"\"\nimport os\n\nmacro_name = {macro_name!r}\nmacro_file = None\n\nuser_path = FreeCAD.getUserMacroDir(True)\nuser_macro = os.path.join(user_path, macro_name + \".FCMacro\")\nif os.path.exists(user_macro):\n    macro_file = user_macro\n\nif not macro_file:\n    system_path = FreeCAD.getResourceDir() + \"Macro\"\n    system_macro = os.path.join(system_path, macro_name + \".FCMacro\")\n    if os.path.exists(system_macro):\n        macro_file = system_macro\n\nif not macro_file:\n    raise FileNotFoundError(f\"Macro not found: {{macro_name}}\")\n\nargs = {args!r}\nfor k, v in args.items():\n    exec(f\"{{k}} = {{v!r}}\")\n\nwith open(macro_file, \"r\") as f:\n    macro_code = f.read()\n\nexec(macro_code)\n_result_ = True\n\"\"\"\n        return await self.execute_python(code)\n\n    async def create_macro(\n        self,\n        name: str,\n        code: str,\n        description: str = \"\",\n    ) -&gt; MacroInfo:\n        \"\"\"Create a new macro.\"\"\"\n        create_code = f\"\"\"\nimport os\n\nmacro_path = FreeCAD.getUserMacroDir(True)\nos.makedirs(macro_path, exist_ok=True)\n\nmacro_file = os.path.join(macro_path, {name!r} + \".FCMacro\")\n\nheader = \"\"\nif {description!r}:\n    header = f\"# {description!r}\\\\n\\\\n\"\n\nfull_code = header + '''# -*- coding: utf-8 -*-\n# FreeCAD Macro: {name}\n# Created via MCP Bridge\n\nimport FreeCAD\nimport FreeCADGui\n\n''' + {code!r}\n\nwith open(macro_file, \"w\") as f:\n    f.write(full_code)\n\n_result_ = {{\n    \"name\": {name!r},\n    \"path\": macro_file,\n    \"description\": {description!r},\n    \"is_system\": False,\n}}\n\"\"\"\n        result = await self.execute_python(create_code)\n\n        if result.success and result.result:\n            return MacroInfo(**result.result)\n\n        error_msg = result.error_traceback or \"Failed to create macro\"\n        raise ValueError(error_msg)\n\n    # =========================================================================\n    # Workbenches\n    # =========================================================================\n\n    async def get_workbenches(self) -&gt; list[WorkbenchInfo]:\n        \"\"\"Get list of available workbenches.\"\"\"\n        code = \"\"\"\nworkbenches = []\nactive_wb = FreeCADGui.activeWorkbench() if FreeCAD.GuiUp else None\nactive_name = active_wb.__class__.__name__ if active_wb else None\n\nif FreeCAD.GuiUp:\n    for name in FreeCADGui.listWorkbenches():\n        wb = FreeCADGui.getWorkbench(name)\n        workbenches.append({\n            \"name\": name,\n            \"label\": wb.MenuText if hasattr(wb, \"MenuText\") else name,\n            \"icon\": wb.Icon if hasattr(wb, \"Icon\") else \"\",\n            \"is_active\": name == active_name,\n        })\nelse:\n    common = [\"StartWorkbench\", \"PartWorkbench\", \"PartDesignWorkbench\",\n              \"DraftWorkbench\", \"SketcherWorkbench\", \"MeshWorkbench\"]\n    for name in common:\n        workbenches.append({\n            \"name\": name,\n            \"label\": name.replace(\"Workbench\", \"\"),\n            \"icon\": \"\",\n            \"is_active\": False,\n        })\n\n_result_ = workbenches\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return [WorkbenchInfo(**wb) for wb in result.result]\n        return []\n\n    async def activate_workbench(self, workbench_name: str) -&gt; None:\n        \"\"\"Activate a workbench.\"\"\"\n        code = f\"\"\"\nif FreeCAD.GuiUp:\n    try:\n        FreeCADGui.activateWorkbench({workbench_name!r})\n        _result_ = True\n    except Exception as e:\n        raise ValueError(f\"Failed to activate workbench: {{e}}\")\nelse:\n    _result_ = True\n\"\"\"\n        result = await self.execute_python(code)\n\n        if not result.success:\n            error_msg = result.error_traceback or \"Failed to activate workbench\"\n            raise ValueError(error_msg)\n\n    # =========================================================================\n    # Version and Environment\n    # =========================================================================\n\n    async def get_freecad_version(self) -&gt; dict[str, Any]:\n        \"\"\"Get FreeCAD version information.\"\"\"\n        code = \"\"\"\nimport sys\n_result_ = {\n    \"version\": \".\".join(str(x) for x in FreeCAD.Version()[:3]),\n    \"version_tuple\": FreeCAD.Version()[:3],\n    \"build_date\": FreeCAD.Version()[3] if len(FreeCAD.Version()) &gt; 3 else \"unknown\",\n    \"python_version\": sys.version,\n    \"gui_available\": FreeCAD.GuiUp,\n}\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return result.result\n\n        return {\n            \"version\": \"unknown\",\n            \"version_tuple\": [],\n            \"build_date\": \"unknown\",\n            \"python_version\": \"\",\n            \"gui_available\": False,\n        }\n\n    async def is_gui_available(self) -&gt; bool:\n        \"\"\"Check if FreeCAD GUI is available.\"\"\"\n        result = await self.execute_python(\"_result_ = FreeCAD.GuiUp\")\n        return bool(result.success and result.result)\n\n    # =========================================================================\n    # Console\n    # =========================================================================\n\n    async def get_console_output(self, lines: int = 100) -&gt; list[str]:\n        \"\"\"Get recent console output.\"\"\"\n        code = f\"\"\"\noutput_lines = []\n\nif hasattr(FreeCAD, 'Console'):\n    console = FreeCAD.Console\n    if hasattr(console, 'GetLog'):\n        log = console.GetLog()\n        if log:\n            output_lines = log.split('\\\\n')[-{lines}:]\n\n_result_ = output_lines\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return result.result\n        return []\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.socket.SocketBridge-functions","title":"Functions","text":""},{"location":"api/bridge/#freecad_mcp.bridge.socket.SocketBridge.__init__","title":"<code>__init__(host=DEFAULT_SOCKET_HOST, port=DEFAULT_SOCKET_PORT, timeout=DEFAULT_TIMEOUT, auto_reconnect=True)</code>","text":"<p>Initialize the socket bridge.</p> <p>Parameters:</p> Name Type Description Default <code>host</code> <code>str</code> <p>Socket server hostname.</p> <code>DEFAULT_SOCKET_HOST</code> <code>port</code> <code>int</code> <p>Socket server port.</p> <code>DEFAULT_SOCKET_PORT</code> <code>timeout</code> <code>float</code> <p>Connection and request timeout in seconds.</p> <code>DEFAULT_TIMEOUT</code> <code>auto_reconnect</code> <code>bool</code> <p>Whether to automatically reconnect on connection loss.</p> <code>True</code> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>def __init__(\n    self,\n    host: str = DEFAULT_SOCKET_HOST,\n    port: int = DEFAULT_SOCKET_PORT,\n    timeout: float = DEFAULT_TIMEOUT,\n    auto_reconnect: bool = True,\n) -&gt; None:\n    \"\"\"Initialize the socket bridge.\n\n    Args:\n        host: Socket server hostname.\n        port: Socket server port.\n        timeout: Connection and request timeout in seconds.\n        auto_reconnect: Whether to automatically reconnect on connection loss.\n    \"\"\"\n    self._host = host\n    self._port = port\n    self._timeout = timeout\n    self._auto_reconnect = auto_reconnect\n    self._reader: asyncio.StreamReader | None = None\n    self._writer: asyncio.StreamWriter | None = None\n    self._connected = False\n    self._lock = asyncio.Lock()\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.socket.SocketBridge.activate_workbench","title":"<code>activate_workbench(workbench_name)</code>  <code>async</code>","text":"<p>Activate a workbench.</p> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>    async def activate_workbench(self, workbench_name: str) -&gt; None:\n        \"\"\"Activate a workbench.\"\"\"\n        code = f\"\"\"\nif FreeCAD.GuiUp:\n    try:\n        FreeCADGui.activateWorkbench({workbench_name!r})\n        _result_ = True\n    except Exception as e:\n        raise ValueError(f\"Failed to activate workbench: {{e}}\")\nelse:\n    _result_ = True\n\"\"\"\n        result = await self.execute_python(code)\n\n        if not result.success:\n            error_msg = result.error_traceback or \"Failed to activate workbench\"\n            raise ValueError(error_msg)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.socket.SocketBridge.close_document","title":"<code>close_document(doc_name=None)</code>  <code>async</code>","text":"<p>Close a document.</p> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>    async def close_document(self, doc_name: str | None = None) -&gt; None:\n        \"\"\"Close a document.\"\"\"\n        code = f\"\"\"\ndoc_name = {doc_name!r}\nif doc_name is None:\n    doc = FreeCAD.ActiveDocument\n    if doc:\n        doc_name = doc.Name\n    else:\n        raise ValueError(\"No active document\")\n\nFreeCAD.closeDocument(doc_name)\n_result_ = True\n\"\"\"\n        result = await self.execute_python(code)\n\n        if not result.success:\n            error_msg = result.error_traceback or \"Failed to close document\"\n            raise ValueError(error_msg)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.socket.SocketBridge.connect","title":"<code>connect()</code>  <code>async</code>","text":"<p>Establish connection to FreeCAD socket server.</p> <p>Raises:</p> Type Description <code>ConnectionError</code> <p>If connection cannot be established.</p> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>async def connect(self) -&gt; None:\n    \"\"\"Establish connection to FreeCAD socket server.\n\n    Raises:\n        ConnectionError: If connection cannot be established.\n    \"\"\"\n    try:\n        self._reader, self._writer = await asyncio.wait_for(\n            asyncio.open_connection(self._host, self._port),\n            timeout=self._timeout,\n        )\n        self._connected = True\n\n        # Verify connection with a ping\n        await self.ping()\n    except TimeoutError as e:\n        msg = f\"Connection to {self._host}:{self._port} timed out\"\n        raise ConnectionError(msg) from e\n    except Exception as e:\n        self._connected = False\n        msg = f\"Failed to connect to {self._host}:{self._port}: {e}\"\n        raise ConnectionError(msg) from e\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.socket.SocketBridge.create_document","title":"<code>create_document(name, label=None)</code>  <code>async</code>","text":"<p>Create a new document.</p> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>    async def create_document(\n        self, name: str, label: str | None = None\n    ) -&gt; DocumentInfo:\n        \"\"\"Create a new document.\"\"\"\n        label = label or name\n        result = await self.execute_python(\n            f\"\"\"\ndoc = FreeCAD.newDocument({name!r})\ndoc.Label = {label!r}\n_result_ = {{\n    \"name\": doc.Name,\n    \"label\": doc.Label,\n    \"path\": doc.FileName or None,\n    \"objects\": [],\n    \"is_modified\": False,\n}}\n\"\"\"\n        )\n\n        if result.success and result.result:\n            return DocumentInfo(**result.result)\n\n        error_msg = result.error_traceback or \"Failed to create document\"\n        raise ValueError(error_msg)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.socket.SocketBridge.create_macro","title":"<code>create_macro(name, code, description='')</code>  <code>async</code>","text":"<p>Create a new macro.</p> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>    async def create_macro(\n        self,\n        name: str,\n        code: str,\n        description: str = \"\",\n    ) -&gt; MacroInfo:\n        \"\"\"Create a new macro.\"\"\"\n        create_code = f\"\"\"\nimport os\n\nmacro_path = FreeCAD.getUserMacroDir(True)\nos.makedirs(macro_path, exist_ok=True)\n\nmacro_file = os.path.join(macro_path, {name!r} + \".FCMacro\")\n\nheader = \"\"\nif {description!r}:\n    header = f\"# {description!r}\\\\n\\\\n\"\n\nfull_code = header + '''# -*- coding: utf-8 -*-\n# FreeCAD Macro: {name}\n# Created via MCP Bridge\n\nimport FreeCAD\nimport FreeCADGui\n\n''' + {code!r}\n\nwith open(macro_file, \"w\") as f:\n    f.write(full_code)\n\n_result_ = {{\n    \"name\": {name!r},\n    \"path\": macro_file,\n    \"description\": {description!r},\n    \"is_system\": False,\n}}\n\"\"\"\n        result = await self.execute_python(create_code)\n\n        if result.success and result.result:\n            return MacroInfo(**result.result)\n\n        error_msg = result.error_traceback or \"Failed to create macro\"\n        raise ValueError(error_msg)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.socket.SocketBridge.create_object","title":"<code>create_object(type_id, name=None, properties=None, doc_name=None)</code>  <code>async</code>","text":"<p>Create a new object.</p> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>    async def create_object(\n        self,\n        type_id: str,\n        name: str | None = None,\n        properties: dict[str, Any] | None = None,\n        doc_name: str | None = None,\n    ) -&gt; ObjectInfo:\n        \"\"\"Create a new object.\"\"\"\n        properties = properties or {}\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nobj = doc.addObject({type_id!r}, {name!r} or \"\")\n\n# Set properties\nfor prop_name, prop_val in {properties!r}.items():\n    if hasattr(obj, prop_name):\n        setattr(obj, prop_name, prop_val)\n\ndoc.recompute()\n\n_result_ = {{\n    \"name\": obj.Name,\n    \"label\": obj.Label,\n    \"type_id\": obj.TypeId,\n    \"visibility\": True,\n    \"children\": [c.Name for c in obj.OutList] if hasattr(obj, \"OutList\") else [],\n    \"parents\": [p.Name for p in obj.InList] if hasattr(obj, \"InList\") else [],\n}}\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return ObjectInfo(**result.result)\n\n        error_msg = result.error_traceback or \"Failed to create object\"\n        raise ValueError(error_msg)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.socket.SocketBridge.delete_object","title":"<code>delete_object(obj_name, doc_name=None)</code>  <code>async</code>","text":"<p>Delete an object.</p> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>    async def delete_object(\n        self,\n        obj_name: str,\n        doc_name: str | None = None,\n    ) -&gt; None:\n        \"\"\"Delete an object.\"\"\"\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nobj = doc.getObject({obj_name!r})\nif obj is None:\n    raise ValueError(f\"Object not found: {obj_name!r}\")\n\ndoc.removeObject({obj_name!r})\n_result_ = True\n\"\"\"\n        result = await self.execute_python(code)\n\n        if not result.success:\n            error_msg = result.error_traceback or \"Failed to delete object\"\n            raise ValueError(error_msg)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.socket.SocketBridge.disconnect","title":"<code>disconnect()</code>  <code>async</code>","text":"<p>Close connection to FreeCAD socket server.</p> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>async def disconnect(self) -&gt; None:\n    \"\"\"Close connection to FreeCAD socket server.\"\"\"\n    if self._writer:\n        self._writer.close()\n        with contextlib.suppress(Exception):\n            await self._writer.wait_closed()\n    self._reader = None\n    self._writer = None\n    self._connected = False\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.socket.SocketBridge.edit_object","title":"<code>edit_object(obj_name, properties, doc_name=None)</code>  <code>async</code>","text":"<p>Edit object properties.</p> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>    async def edit_object(\n        self,\n        obj_name: str,\n        properties: dict[str, Any],\n        doc_name: str | None = None,\n    ) -&gt; ObjectInfo:\n        \"\"\"Edit object properties.\"\"\"\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nobj = doc.getObject({obj_name!r})\nif obj is None:\n    raise ValueError(f\"Object not found: {obj_name!r}\")\n\n# Set properties\nfor prop_name, prop_val in {properties!r}.items():\n    if hasattr(obj, prop_name):\n        setattr(obj, prop_name, prop_val)\n\ndoc.recompute()\n\n_result_ = {{\n    \"name\": obj.Name,\n    \"label\": obj.Label,\n    \"type_id\": obj.TypeId,\n    \"visibility\": obj.ViewObject.Visibility if hasattr(obj, \"ViewObject\") and obj.ViewObject else True,\n    \"children\": [c.Name for c in obj.OutList] if hasattr(obj, \"OutList\") else [],\n    \"parents\": [p.Name for p in obj.InList] if hasattr(obj, \"InList\") else [],\n}}\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return ObjectInfo(**result.result)\n\n        error_msg = result.error_traceback or \"Failed to edit object\"\n        raise ValueError(error_msg)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.socket.SocketBridge.execute_python","title":"<code>execute_python(code, timeout_ms=30000)</code>  <code>async</code>","text":"<p>Execute Python code in FreeCAD context via socket.</p> <p>Parameters:</p> Name Type Description Default <code>code</code> <code>str</code> <p>Python code to execute.</p> required <code>timeout_ms</code> <code>int</code> <p>Maximum execution time in milliseconds.</p> <code>30000</code> <p>Returns:</p> Type Description <code>ExecutionResult</code> <p>ExecutionResult with execution outcome.</p> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>async def execute_python(\n    self,\n    code: str,\n    timeout_ms: int = 30000,\n) -&gt; ExecutionResult:\n    \"\"\"Execute Python code in FreeCAD context via socket.\n\n    Args:\n        code: Python code to execute.\n        timeout_ms: Maximum execution time in milliseconds.\n\n    Returns:\n        ExecutionResult with execution outcome.\n    \"\"\"\n    start = time.perf_counter()\n\n    try:\n        result = await asyncio.wait_for(\n            self._send_request(\"execute\", {\"code\": code}),\n            timeout=timeout_ms / 1000,\n        )\n        elapsed = (time.perf_counter() - start) * 1000\n\n        if isinstance(result, dict):\n            return ExecutionResult(\n                success=result.get(\"success\", False),\n                result=result.get(\"result\"),\n                stdout=result.get(\"stdout\", \"\"),\n                stderr=result.get(\"stderr\", \"\"),\n                execution_time_ms=elapsed,\n                error_type=result.get(\"error_type\"),\n                error_traceback=result.get(\"error_traceback\"),\n            )\n        else:\n            return ExecutionResult(\n                success=True,\n                result=result,\n                stdout=\"\",\n                stderr=\"\",\n                execution_time_ms=elapsed,\n            )\n\n    except TimeoutError:\n        return ExecutionResult(\n            success=False,\n            result=None,\n            stdout=\"\",\n            stderr=f\"Execution timed out after {timeout_ms}ms\",\n            execution_time_ms=float(timeout_ms),\n            error_type=\"TimeoutError\",\n        )\n    except JsonRpcError as e:\n        elapsed = (time.perf_counter() - start) * 1000\n        return ExecutionResult(\n            success=False,\n            result=None,\n            stdout=\"\",\n            stderr=e.message,\n            execution_time_ms=elapsed,\n            error_type=\"JsonRpcError\",\n        )\n    except ConnectionError as e:\n        return ExecutionResult(\n            success=False,\n            result=None,\n            stdout=\"\",\n            stderr=str(e),\n            execution_time_ms=0,\n            error_type=\"ConnectionError\",\n        )\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.socket.SocketBridge.get_active_document","title":"<code>get_active_document()</code>  <code>async</code>","text":"<p>Get the active document.</p> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>    async def get_active_document(self) -&gt; DocumentInfo | None:\n        \"\"\"Get the active document.\"\"\"\n        result = await self.execute_python(\n            \"\"\"\ndoc = FreeCAD.ActiveDocument\nif doc:\n    _result_ = {\n        \"name\": doc.Name,\n        \"label\": doc.Label,\n        \"path\": doc.FileName or None,\n        \"objects\": [obj.Name for obj in doc.Objects],\n        \"is_modified\": doc.Modified if hasattr(doc, \"Modified\") else False,\n        \"active_object\": doc.ActiveObject.Name if doc.ActiveObject else None,\n    }\nelse:\n    _result_ = None\n\"\"\"\n        )\n\n        if result.success and result.result:\n            return DocumentInfo(**result.result)\n        return None\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.socket.SocketBridge.get_console_output","title":"<code>get_console_output(lines=100)</code>  <code>async</code>","text":"<p>Get recent console output.</p> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>    async def get_console_output(self, lines: int = 100) -&gt; list[str]:\n        \"\"\"Get recent console output.\"\"\"\n        code = f\"\"\"\noutput_lines = []\n\nif hasattr(FreeCAD, 'Console'):\n    console = FreeCAD.Console\n    if hasattr(console, 'GetLog'):\n        log = console.GetLog()\n        if log:\n            output_lines = log.split('\\\\n')[-{lines}:]\n\n_result_ = output_lines\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return result.result\n        return []\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.socket.SocketBridge.get_documents","title":"<code>get_documents()</code>  <code>async</code>","text":"<p>Get list of open documents.</p> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>    async def get_documents(self) -&gt; list[DocumentInfo]:\n        \"\"\"Get list of open documents.\"\"\"\n        result = await self.execute_python(\n            \"\"\"\n_result_ = []\nfor doc in FreeCAD.listDocuments().values():\n    _result_.append({\n        \"name\": doc.Name,\n        \"label\": doc.Label,\n        \"path\": doc.FileName or None,\n        \"objects\": [obj.Name for obj in doc.Objects],\n        \"is_modified\": doc.Modified if hasattr(doc, \"Modified\") else False,\n        \"active_object\": doc.ActiveObject.Name if doc.ActiveObject else None,\n    })\n\"\"\"\n        )\n\n        if result.success and result.result:\n            return [DocumentInfo(**doc) for doc in result.result]\n        return []\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.socket.SocketBridge.get_freecad_version","title":"<code>get_freecad_version()</code>  <code>async</code>","text":"<p>Get FreeCAD version information.</p> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>    async def get_freecad_version(self) -&gt; dict[str, Any]:\n        \"\"\"Get FreeCAD version information.\"\"\"\n        code = \"\"\"\nimport sys\n_result_ = {\n    \"version\": \".\".join(str(x) for x in FreeCAD.Version()[:3]),\n    \"version_tuple\": FreeCAD.Version()[:3],\n    \"build_date\": FreeCAD.Version()[3] if len(FreeCAD.Version()) &gt; 3 else \"unknown\",\n    \"python_version\": sys.version,\n    \"gui_available\": FreeCAD.GuiUp,\n}\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return result.result\n\n        return {\n            \"version\": \"unknown\",\n            \"version_tuple\": [],\n            \"build_date\": \"unknown\",\n            \"python_version\": \"\",\n            \"gui_available\": False,\n        }\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.socket.SocketBridge.get_macros","title":"<code>get_macros()</code>  <code>async</code>","text":"<p>Get list of available macros.</p> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>    async def get_macros(self) -&gt; list[MacroInfo]:\n        \"\"\"Get list of available macros.\"\"\"\n        code = \"\"\"\nimport os\n\nmacro_paths = []\n\nuser_path = FreeCAD.getUserMacroDir(True)\nif os.path.exists(user_path):\n    macro_paths.append((\"user\", user_path))\n\nsystem_path = FreeCAD.getResourceDir() + \"Macro\"\nif os.path.exists(system_path):\n    macro_paths.append((\"system\", system_path))\n\nmacros = []\nfor source, path in macro_paths:\n    for filename in os.listdir(path):\n        if filename.endswith(\".FCMacro\"):\n            macro_file = os.path.join(path, filename)\n            description = \"\"\n            try:\n                with open(macro_file, \"r\") as f:\n                    for line in f:\n                        if line.startswith(\"#\"):\n                            desc = line.lstrip(\"#\").strip()\n                            if desc and not desc.startswith(\"!\") and not desc.startswith(\"-*-\"):\n                                description = desc\n                                break\n            except Exception:\n                pass\n\n            macros.append({\n                \"name\": filename[:-8],\n                \"path\": macro_file,\n                \"description\": description,\n                \"is_system\": source == \"system\",\n            })\n\n_result_ = macros\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return [MacroInfo(**m) for m in result.result]\n        return []\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.socket.SocketBridge.get_object","title":"<code>get_object(obj_name, doc_name=None)</code>  <code>async</code>","text":"<p>Get detailed object information.</p> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>    async def get_object(\n        self,\n        obj_name: str,\n        doc_name: str | None = None,\n    ) -&gt; ObjectInfo:\n        \"\"\"Get detailed object information.\"\"\"\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nobj = doc.getObject({obj_name!r})\nif obj is None:\n    raise ValueError(f\"Object not found: {obj_name!r}\")\n\nprops = {{}}\nfor prop in obj.PropertiesList:\n    try:\n        val = getattr(obj, prop)\n        if hasattr(val, '__class__') and val.__class__.__module__ != 'builtins':\n            val = str(val)\n        props[prop] = val\n    except Exception:\n        props[prop] = \"&lt;unreadable&gt;\"\n\nshape_info = None\nif hasattr(obj, \"Shape\"):\n    shape = obj.Shape\n    shape_info = {{\n        \"shape_type\": shape.ShapeType,\n        \"volume\": shape.Volume if hasattr(shape, \"Volume\") else None,\n        \"area\": shape.Area if hasattr(shape, \"Area\") else None,\n        \"is_valid\": shape.isValid(),\n        \"is_closed\": shape.isClosed() if hasattr(shape, \"isClosed\") else False,\n        \"vertex_count\": len(shape.Vertexes) if hasattr(shape, \"Vertexes\") else 0,\n        \"edge_count\": len(shape.Edges) if hasattr(shape, \"Edges\") else 0,\n        \"face_count\": len(shape.Faces) if hasattr(shape, \"Faces\") else 0,\n    }}\n\n_result_ = {{\n    \"name\": obj.Name,\n    \"label\": obj.Label,\n    \"type_id\": obj.TypeId,\n    \"properties\": props,\n    \"shape_info\": shape_info,\n    \"children\": [c.Name for c in obj.OutList] if hasattr(obj, \"OutList\") else [],\n    \"parents\": [p.Name for p in obj.InList] if hasattr(obj, \"InList\") else [],\n    \"visibility\": obj.ViewObject.Visibility if hasattr(obj, \"ViewObject\") and obj.ViewObject else True,\n}}\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return ObjectInfo(**result.result)\n\n        error_msg = result.error_traceback or \"Failed to get object\"\n        raise ValueError(error_msg)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.socket.SocketBridge.get_objects","title":"<code>get_objects(doc_name=None)</code>  <code>async</code>","text":"<p>Get all objects in a document.</p> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>    async def get_objects(self, doc_name: str | None = None) -&gt; list[ObjectInfo]:\n        \"\"\"Get all objects in a document.\"\"\"\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nobjects = []\nfor obj in doc.Objects:\n    obj_info = {{\n        \"name\": obj.Name,\n        \"label\": obj.Label,\n        \"type_id\": obj.TypeId,\n        \"visibility\": obj.ViewObject.Visibility if hasattr(obj, \"ViewObject\") and obj.ViewObject else True,\n        \"children\": [c.Name for c in obj.OutList] if hasattr(obj, \"OutList\") else [],\n        \"parents\": [p.Name for p in obj.InList] if hasattr(obj, \"InList\") else [],\n    }}\n    objects.append(obj_info)\n\n_result_ = objects\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return [ObjectInfo(**obj) for obj in result.result]\n        return []\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.socket.SocketBridge.get_screenshot","title":"<code>get_screenshot(view_angle=None, width=800, height=600, doc_name=None)</code>  <code>async</code>","text":"<p>Capture a screenshot of the 3D view via socket.</p> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>    async def get_screenshot(\n        self,\n        view_angle: ViewAngle | None = None,\n        width: int = 800,\n        height: int = 600,\n        doc_name: str | None = None,\n    ) -&gt; ScreenshotResult:\n        \"\"\"Capture a screenshot of the 3D view via socket.\"\"\"\n        view_angle_str = view_angle.value if view_angle else \"Isometric\"\n        code = f\"\"\"\nimport base64\nimport tempfile\nimport os\n\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\n# Check if GUI is available\nif not FreeCAD.GuiUp:\n    raise RuntimeError(\"GUI not available\")\n\nview = FreeCADGui.ActiveDocument.ActiveView\nif view is None:\n    raise ValueError(\"No active view\")\n\n# Check view type\nview_type = view.__class__.__name__\nif view_type not in [\"View3DInventor\", \"View3DInventorPy\"]:\n    raise ValueError(f\"Cannot capture screenshot from {{view_type}} view\")\n\n# Set view angle\nview_type_str = {view_angle_str!r}\nif view_type_str == \"FitAll\":\n    view.fitAll()\nelif view_type_str == \"Isometric\":\n    view.viewIsometric()\nelif view_type_str == \"Front\":\n    view.viewFront()\nelif view_type_str == \"Back\":\n    view.viewRear()\nelif view_type_str == \"Top\":\n    view.viewTop()\nelif view_type_str == \"Bottom\":\n    view.viewBottom()\nelif view_type_str == \"Left\":\n    view.viewLeft()\nelif view_type_str == \"Right\":\n    view.viewRight()\n\n# Save to temp file and read\nwith tempfile.NamedTemporaryFile(suffix=\".png\", delete=False) as f:\n    temp_path = f.name\n\nview.saveImage(temp_path, {width}, {height}, \"Current\")\n\nwith open(temp_path, \"rb\") as f:\n    image_data = base64.b64encode(f.read()).decode(\"utf-8\")\n\nos.unlink(temp_path)\n\n_result_ = {{\n    \"success\": True,\n    \"data\": image_data,\n    \"format\": \"png\",\n    \"width\": {width},\n    \"height\": {height},\n}}\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return ScreenshotResult(\n                success=True,\n                data=result.result[\"data\"],\n                format=result.result[\"format\"],\n                width=result.result[\"width\"],\n                height=result.result[\"height\"],\n                view_angle=view_angle,\n            )\n\n        return ScreenshotResult(\n            success=False,\n            error=result.error_traceback\n            or result.stderr\n            or \"Failed to capture screenshot\",\n            width=width,\n            height=height,\n            view_angle=view_angle,\n        )\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.socket.SocketBridge.get_status","title":"<code>get_status()</code>  <code>async</code>","text":"<p>Get detailed connection status.</p> <p>Returns:</p> Type Description <code>ConnectionStatus</code> <p>ConnectionStatus with full status information.</p> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>async def get_status(self) -&gt; ConnectionStatus:\n    \"\"\"Get detailed connection status.\n\n    Returns:\n        ConnectionStatus with full status information.\n    \"\"\"\n    if not self._connected:\n        return ConnectionStatus(\n            connected=False,\n            mode=\"socket\",\n            error=\"Not connected\",\n        )\n\n    try:\n        ping_ms = await self.ping()\n        version_info = await self.get_freecad_version()\n        gui_available = await self.is_gui_available()\n\n        return ConnectionStatus(\n            connected=True,\n            mode=\"socket\",\n            freecad_version=version_info.get(\"version\", \"unknown\"),\n            gui_available=gui_available,\n            last_ping_ms=ping_ms,\n        )\n    except Exception as e:\n        return ConnectionStatus(\n            connected=False,\n            mode=\"socket\",\n            error=str(e),\n        )\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.socket.SocketBridge.get_workbenches","title":"<code>get_workbenches()</code>  <code>async</code>","text":"<p>Get list of available workbenches.</p> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>    async def get_workbenches(self) -&gt; list[WorkbenchInfo]:\n        \"\"\"Get list of available workbenches.\"\"\"\n        code = \"\"\"\nworkbenches = []\nactive_wb = FreeCADGui.activeWorkbench() if FreeCAD.GuiUp else None\nactive_name = active_wb.__class__.__name__ if active_wb else None\n\nif FreeCAD.GuiUp:\n    for name in FreeCADGui.listWorkbenches():\n        wb = FreeCADGui.getWorkbench(name)\n        workbenches.append({\n            \"name\": name,\n            \"label\": wb.MenuText if hasattr(wb, \"MenuText\") else name,\n            \"icon\": wb.Icon if hasattr(wb, \"Icon\") else \"\",\n            \"is_active\": name == active_name,\n        })\nelse:\n    common = [\"StartWorkbench\", \"PartWorkbench\", \"PartDesignWorkbench\",\n              \"DraftWorkbench\", \"SketcherWorkbench\", \"MeshWorkbench\"]\n    for name in common:\n        workbenches.append({\n            \"name\": name,\n            \"label\": name.replace(\"Workbench\", \"\"),\n            \"icon\": \"\",\n            \"is_active\": False,\n        })\n\n_result_ = workbenches\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return [WorkbenchInfo(**wb) for wb in result.result]\n        return []\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.socket.SocketBridge.is_connected","title":"<code>is_connected()</code>  <code>async</code>","text":"<p>Check if bridge is connected to FreeCAD.</p> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>async def is_connected(self) -&gt; bool:\n    \"\"\"Check if bridge is connected to FreeCAD.\"\"\"\n    if not self._connected or self._writer is None:\n        return False\n\n    try:\n        await self.ping()\n        return True\n    except Exception:\n        self._connected = False\n        return False\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.socket.SocketBridge.is_gui_available","title":"<code>is_gui_available()</code>  <code>async</code>","text":"<p>Check if FreeCAD GUI is available.</p> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>async def is_gui_available(self) -&gt; bool:\n    \"\"\"Check if FreeCAD GUI is available.\"\"\"\n    result = await self.execute_python(\"_result_ = FreeCAD.GuiUp\")\n    return bool(result.success and result.result)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.socket.SocketBridge.open_document","title":"<code>open_document(path)</code>  <code>async</code>","text":"<p>Open an existing document.</p> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>    async def open_document(self, path: str) -&gt; DocumentInfo:\n        \"\"\"Open an existing document.\"\"\"\n        result = await self.execute_python(\n            f\"\"\"\nimport os\nif not os.path.exists({path!r}):\n    raise FileNotFoundError(f\"File not found: {path!r}\")\n\ndoc = FreeCAD.openDocument({path!r})\n_result_ = {{\n    \"name\": doc.Name,\n    \"label\": doc.Label,\n    \"path\": doc.FileName or None,\n    \"objects\": [obj.Name for obj in doc.Objects],\n    \"is_modified\": doc.Modified if hasattr(doc, \"Modified\") else False,\n}}\n\"\"\"\n        )\n\n        if result.success and result.result:\n            return DocumentInfo(**result.result)\n\n        if \"FileNotFoundError\" in (result.error_type or \"\"):\n            raise FileNotFoundError(result.stderr)\n\n        error_msg = result.error_traceback or \"Failed to open document\"\n        raise ValueError(error_msg)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.socket.SocketBridge.ping","title":"<code>ping()</code>  <code>async</code>","text":"<p>Ping FreeCAD to check connection and measure latency.</p> <p>Returns:</p> Type Description <code>float</code> <p>Round-trip time in milliseconds.</p> <p>Raises:</p> Type Description <code>ConnectionError</code> <p>If not connected.</p> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>async def ping(self) -&gt; float:\n    \"\"\"Ping FreeCAD to check connection and measure latency.\n\n    Returns:\n        Round-trip time in milliseconds.\n\n    Raises:\n        ConnectionError: If not connected.\n    \"\"\"\n    start = time.perf_counter()\n    await self._send_request(\"ping\")\n    return (time.perf_counter() - start) * 1000\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.socket.SocketBridge.run_macro","title":"<code>run_macro(macro_name, args=None)</code>  <code>async</code>","text":"<p>Run a macro by name.</p> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>    async def run_macro(\n        self,\n        macro_name: str,\n        args: dict[str, Any] | None = None,\n    ) -&gt; ExecutionResult:\n        \"\"\"Run a macro by name.\"\"\"\n        args = args or {}\n        code = f\"\"\"\nimport os\n\nmacro_name = {macro_name!r}\nmacro_file = None\n\nuser_path = FreeCAD.getUserMacroDir(True)\nuser_macro = os.path.join(user_path, macro_name + \".FCMacro\")\nif os.path.exists(user_macro):\n    macro_file = user_macro\n\nif not macro_file:\n    system_path = FreeCAD.getResourceDir() + \"Macro\"\n    system_macro = os.path.join(system_path, macro_name + \".FCMacro\")\n    if os.path.exists(system_macro):\n        macro_file = system_macro\n\nif not macro_file:\n    raise FileNotFoundError(f\"Macro not found: {{macro_name}}\")\n\nargs = {args!r}\nfor k, v in args.items():\n    exec(f\"{{k}} = {{v!r}}\")\n\nwith open(macro_file, \"r\") as f:\n    macro_code = f.read()\n\nexec(macro_code)\n_result_ = True\n\"\"\"\n        return await self.execute_python(code)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.socket.SocketBridge.save_document","title":"<code>save_document(doc_name=None, path=None)</code>  <code>async</code>","text":"<p>Save a document.</p> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>    async def save_document(\n        self,\n        doc_name: str | None = None,\n        path: str | None = None,\n    ) -&gt; str:\n        \"\"\"Save a document.\"\"\"\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No active document\" if {doc_name!r} is None else f\"Document not found: {doc_name!r}\")\n\nsave_path = {path!r} or doc.FileName\nif not save_path:\n    raise ValueError(\"No path specified for new document\")\n\ndoc.saveAs(save_path)\n_result_ = save_path\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return result.result\n\n        error_msg = result.error_traceback or \"Failed to save document\"\n        raise ValueError(error_msg)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.socket.SocketBridge.set_view","title":"<code>set_view(view_angle, doc_name=None)</code>  <code>async</code>","text":"<p>Set the 3D view angle.</p> Source code in <code>src/freecad_mcp/bridge/socket.py</code> <pre><code>    async def set_view(\n        self,\n        view_angle: ViewAngle,\n        doc_name: str | None = None,\n    ) -&gt; None:\n        \"\"\"Set the 3D view angle.\"\"\"\n        view_angle_str = view_angle.value\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nif not FreeCAD.GuiUp:\n    _result_ = True\nelse:\n    view = FreeCADGui.ActiveDocument.ActiveView\n    if view is None:\n        raise ValueError(\"No active view\")\n\n    view_type = {view_angle_str!r}\n    if view_type == \"FitAll\":\n        view.fitAll()\n    elif view_type == \"Isometric\":\n        view.viewIsometric()\n    elif view_type == \"Front\":\n        view.viewFront()\n    elif view_type == \"Back\":\n        view.viewRear()\n    elif view_type == \"Top\":\n        view.viewTop()\n    elif view_type == \"Bottom\":\n        view.viewBottom()\n    elif view_type == \"Left\":\n        view.viewLeft()\n    elif view_type == \"Right\":\n        view.viewRight()\n\n    _result_ = True\n\"\"\"\n        await self.execute_python(code)\n</code></pre>"},{"location":"api/bridge/#embedded-bridge","title":"Embedded Bridge","text":"<p>Linux Only</p> <p>The embedded bridge only works on Linux. See Connection Modes for details.</p> <p>options: show_root_heading: true show_source: true</p>"},{"location":"api/bridge/#freecad_mcp.bridge.embedded","title":"<code>freecad_mcp.bridge.embedded</code>","text":"<p>Embedded bridge - runs FreeCAD in-process.</p> <p>This bridge imports FreeCAD directly into the Robust MCP Server process, providing the fastest execution but limited to headless mode.</p> <p>Based on learnings from competitive analysis: - Thread-safe execution using ThreadPoolExecutor (from neka-nat) - Comprehensive object info including shape geometry - Macro support with templates and validation</p>"},{"location":"api/bridge/#freecad_mcp.bridge.embedded-classes","title":"Classes","text":""},{"location":"api/bridge/#freecad_mcp.bridge.embedded.EmbeddedBridge","title":"<code>EmbeddedBridge</code>","text":"<p>               Bases: <code>FreecadBridge</code></p> <p>Bridge that runs FreeCAD embedded in the Robust MCP Server process.</p> <p>This bridge imports FreeCAD directly, providing fast execution but only supports headless mode (no GUI).</p> <p>Attributes:</p> Name Type Description <code>freecad_path</code> <p>Optional path to FreeCAD's lib directory.</p> Source code in <code>src/freecad_mcp/bridge/embedded.py</code> <pre><code>class EmbeddedBridge(FreecadBridge):\n    \"\"\"Bridge that runs FreeCAD embedded in the Robust MCP Server process.\n\n    This bridge imports FreeCAD directly, providing fast execution\n    but only supports headless mode (no GUI).\n\n    Attributes:\n        freecad_path: Optional path to FreeCAD's lib directory.\n    \"\"\"\n\n    def __init__(self, freecad_path: str | None = None) -&gt; None:\n        \"\"\"Initialize the embedded bridge.\n\n        Args:\n            freecad_path: Path to FreeCAD's lib directory. If provided,\n                this path will be added to sys.path before importing.\n        \"\"\"\n        self._freecad_path = freecad_path\n        self._fc_module: Any = None\n        self._executor = ThreadPoolExecutor(max_workers=1, thread_name_prefix=\"freecad\")\n        self._connected = False\n\n    async def connect(self) -&gt; None:\n        \"\"\"Import and initialize FreeCAD.\n\n        Raises:\n            ConnectionError: If FreeCAD cannot be imported.\n        \"\"\"\n        if self._freecad_path:\n            sys.path.insert(0, self._freecad_path)\n\n        loop = asyncio.get_event_loop()\n        try:\n            self._fc_module = await loop.run_in_executor(\n                self._executor,\n                self._import_freecad,\n            )\n            self._connected = True\n        except ImportError as e:\n            msg = f\"Failed to import FreeCAD: {e}\"\n            raise ConnectionError(msg) from e\n\n    def _import_freecad(self) -&gt; Any:\n        \"\"\"Import FreeCAD module (runs in thread pool).\"\"\"\n        import FreeCAD\n\n        return FreeCAD\n\n    async def disconnect(self) -&gt; None:\n        \"\"\"Clean up resources.\"\"\"\n        self._connected = False\n        self._executor.shutdown(wait=True)\n\n    async def is_connected(self) -&gt; bool:\n        \"\"\"Check if FreeCAD is imported and available.\"\"\"\n        return self._connected and self._fc_module is not None\n\n    async def execute_python(\n        self,\n        code: str,\n        timeout_ms: int = 30000,\n    ) -&gt; ExecutionResult:\n        \"\"\"Execute Python code in FreeCAD context.\n\n        Args:\n            code: Python code to execute.\n            timeout_ms: Maximum execution time in milliseconds.\n\n        Returns:\n            ExecutionResult with execution outcome.\n        \"\"\"\n        if not self._connected:\n            return ExecutionResult(\n                success=False,\n                result=None,\n                stdout=\"\",\n                stderr=\"FreeCAD bridge not connected\",\n                execution_time_ms=0,\n                error_type=\"ConnectionError\",\n                error_traceback=None,\n            )\n\n        loop = asyncio.get_event_loop()\n\n        try:\n            result = await asyncio.wait_for(\n                loop.run_in_executor(\n                    self._executor,\n                    lambda: self._execute_code(code),\n                ),\n                timeout=timeout_ms / 1000,\n            )\n        except TimeoutError:\n            return ExecutionResult(\n                success=False,\n                result=None,\n                stdout=\"\",\n                stderr=f\"Execution timed out after {timeout_ms}ms\",\n                execution_time_ms=float(timeout_ms),\n                error_type=\"TimeoutError\",\n                error_traceback=None,\n            )\n\n        return result\n\n    def _execute_code(self, code: str) -&gt; ExecutionResult:\n        \"\"\"Execute code synchronously (runs in thread pool).\"\"\"\n        start = time.perf_counter()\n        stdout_capture = io.StringIO()\n        stderr_capture = io.StringIO()\n\n        # Build execution context\n        exec_globals: dict[str, Any] = {\n            \"FreeCAD\": self._fc_module,\n            \"App\": self._fc_module,\n            \"__builtins__\": __builtins__,\n        }\n\n        # Try to add GUI module if available\n        try:\n            import FreeCADGui\n\n            exec_globals[\"FreeCADGui\"] = FreeCADGui\n            exec_globals[\"Gui\"] = FreeCADGui\n        except ImportError:\n            pass\n\n        try:\n            with redirect_stdout(stdout_capture), redirect_stderr(stderr_capture):\n                compiled = compile(code, \"&lt;mcp&gt;\", \"exec\")\n                exec(compiled, exec_globals)  # noqa: S102\n\n            elapsed = (time.perf_counter() - start) * 1000\n\n            return ExecutionResult(\n                success=True,\n                result=exec_globals.get(\"_result_\"),\n                stdout=stdout_capture.getvalue(),\n                stderr=stderr_capture.getvalue(),\n                execution_time_ms=elapsed,\n            )\n\n        except Exception as e:\n            import traceback\n\n            elapsed = (time.perf_counter() - start) * 1000\n\n            return ExecutionResult(\n                success=False,\n                result=None,\n                stdout=stdout_capture.getvalue(),\n                stderr=stderr_capture.getvalue(),\n                execution_time_ms=elapsed,\n                error_type=type(e).__name__,\n                error_traceback=traceback.format_exc(),\n            )\n\n    async def get_documents(self) -&gt; list[DocumentInfo]:\n        \"\"\"Get list of open documents.\"\"\"\n        result = await self.execute_python(\n            \"\"\"\n_result_ = []\nfor doc in FreeCAD.listDocuments().values():\n    _result_.append({\n        \"name\": doc.Name,\n        \"path\": doc.FileName or None,\n        \"objects\": [obj.Name for obj in doc.Objects],\n        \"is_modified\": doc.Modified if hasattr(doc, \"Modified\") else False,\n        \"label\": doc.Label,\n    })\n\"\"\"\n        )\n\n        if result.success and result.result:\n            return [DocumentInfo(**doc) for doc in result.result]\n        return []\n\n    async def get_active_document(self) -&gt; DocumentInfo | None:\n        \"\"\"Get the active document.\"\"\"\n        result = await self.execute_python(\n            \"\"\"\ndoc = FreeCAD.ActiveDocument\nif doc:\n    _result_ = {\n        \"name\": doc.Name,\n        \"path\": doc.FileName or None,\n        \"objects\": [obj.Name for obj in doc.Objects],\n        \"is_modified\": doc.Modified if hasattr(doc, \"Modified\") else False,\n        \"label\": doc.Label,\n    }\nelse:\n    _result_ = None\n\"\"\"\n        )\n\n        if result.success and result.result:\n            return DocumentInfo(**result.result)\n        return None\n\n    async def get_object(\n        self,\n        obj_name: str,\n        doc_name: str | None = None,\n    ) -&gt; ObjectInfo:\n        \"\"\"Get detailed object information.\"\"\"\n        result = await self.execute_python(\n            f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nobj = doc.getObject({obj_name!r})\nif obj is None:\n    raise ValueError(f\"Object not found: {obj_name!r}\")\n\nprops = {{}}\nfor prop in obj.PropertiesList:\n    try:\n        val = getattr(obj, prop)\n        if hasattr(val, '__class__') and val.__class__.__module__ != 'builtins':\n            val = str(val)\n        props[prop] = val\n    except Exception:\n        props[prop] = \"&lt;unreadable&gt;\"\n\nshape_info = None\nif hasattr(obj, \"Shape\"):\n    shape = obj.Shape\n    shape_info = {{\n        \"type\": shape.ShapeType,\n        \"volume\": shape.Volume if hasattr(shape, \"Volume\") else None,\n        \"area\": shape.Area if hasattr(shape, \"Area\") else None,\n        \"is_valid\": shape.isValid(),\n    }}\n\n_result_ = {{\n    \"name\": obj.Name,\n    \"label\": obj.Label,\n    \"type_id\": obj.TypeId,\n    \"properties\": props,\n    \"shape_info\": shape_info,\n    \"children\": [c.Name for c in obj.OutList] if hasattr(obj, \"OutList\") else [],\n}}\n\"\"\"\n        )\n\n        if result.success and result.result:\n            return ObjectInfo(**result.result)\n\n        error_msg = result.error_traceback or \"Failed to get object\"\n        raise ValueError(error_msg)\n\n    async def get_console_output(\n        self,\n        lines: int = 100,\n    ) -&gt; list[str]:\n        \"\"\"Get recent console output.\n\n        Note: In embedded mode, we don't have direct access to FreeCAD's\n        console history, so we return an empty list or captured output.\n        \"\"\"\n        return []\n\n    async def get_freecad_version(self) -&gt; dict[str, Any]:\n        \"\"\"Get FreeCAD version information.\"\"\"\n        result = await self.execute_python(\n            \"\"\"\nimport sys\n_result_ = {\n    \"version\": \".\".join(str(x) for x in FreeCAD.Version()[:3]),\n    \"version_tuple\": FreeCAD.Version()[:3],\n    \"build_date\": FreeCAD.Version()[3] if len(FreeCAD.Version()) &gt; 3 else \"unknown\",\n    \"python_version\": sys.version,\n    \"gui_available\": hasattr(FreeCAD, \"GuiUp\") and FreeCAD.GuiUp,\n}\n\"\"\"\n        )\n\n        if result.success and result.result:\n            return result.result\n\n        return {\n            \"version\": \"unknown\",\n            \"version_tuple\": [],\n            \"build_date\": \"unknown\",\n            \"python_version\": sys.version,\n            \"gui_available\": False,\n        }\n\n    async def is_gui_available(self) -&gt; bool:\n        \"\"\"Check if GUI is available.\"\"\"\n        result = await self.execute_python(\n            \"_result_ = hasattr(FreeCAD, 'GuiUp') and FreeCAD.GuiUp\"\n        )\n        return bool(result.success and result.result)\n\n    async def ping(self) -&gt; float:\n        \"\"\"Ping FreeCAD to check connection and measure latency.\n\n        Returns:\n            Round-trip time in milliseconds.\n\n        Raises:\n            ConnectionError: If not connected.\n        \"\"\"\n        if not self._connected:\n            msg = \"Not connected to FreeCAD\"\n            raise ConnectionError(msg)\n\n        start = time.perf_counter()\n        result = await self.execute_python(\"_result_ = True\")\n        elapsed = (time.perf_counter() - start) * 1000\n\n        if not result.success:\n            msg = \"Ping failed\"\n            raise ConnectionError(msg)\n\n        return elapsed\n\n    async def get_status(self) -&gt; ConnectionStatus:\n        \"\"\"Get detailed connection status.\n\n        Returns:\n            ConnectionStatus with full status information.\n        \"\"\"\n        if not self._connected:\n            return ConnectionStatus(\n                connected=False,\n                mode=\"embedded\",\n                error=\"Not connected\",\n            )\n\n        try:\n            ping_ms = await self.ping()\n            version_info = await self.get_freecad_version()\n            gui_available = await self.is_gui_available()\n\n            return ConnectionStatus(\n                connected=True,\n                mode=\"embedded\",\n                freecad_version=version_info.get(\"version\", \"unknown\"),\n                gui_available=gui_available,\n                last_ping_ms=ping_ms,\n            )\n        except Exception as e:\n            return ConnectionStatus(\n                connected=False,\n                mode=\"embedded\",\n                error=str(e),\n            )\n\n    # =========================================================================\n    # Document Management\n    # =========================================================================\n\n    async def create_document(\n        self, name: str, label: str | None = None\n    ) -&gt; DocumentInfo:\n        \"\"\"Create a new document.\n\n        Args:\n            name: Internal document name (no spaces).\n            label: Display label (optional, defaults to name).\n\n        Returns:\n            DocumentInfo for the created document.\n        \"\"\"\n        label = label or name\n        result = await self.execute_python(\n            f\"\"\"\ndoc = FreeCAD.newDocument({name!r})\ndoc.Label = {label!r}\n_result_ = {{\n    \"name\": doc.Name,\n    \"label\": doc.Label,\n    \"path\": doc.FileName or None,\n    \"objects\": [],\n    \"is_modified\": False,\n}}\n\"\"\"\n        )\n\n        if result.success and result.result:\n            return DocumentInfo(**result.result)\n\n        error_msg = result.error_traceback or \"Failed to create document\"\n        raise ValueError(error_msg)\n\n    async def open_document(self, path: str) -&gt; DocumentInfo:\n        \"\"\"Open an existing document.\n\n        Args:\n            path: Path to the .FCStd file.\n\n        Returns:\n            DocumentInfo for the opened document.\n\n        Raises:\n            FileNotFoundError: If file doesn't exist.\n            ValueError: If file is not a valid FreeCAD document.\n        \"\"\"\n        if not Path(path).exists():\n            msg = f\"File not found: {path}\"\n            raise FileNotFoundError(msg)\n\n        result = await self.execute_python(\n            f\"\"\"\ndoc = FreeCAD.openDocument({path!r})\n_result_ = {{\n    \"name\": doc.Name,\n    \"label\": doc.Label,\n    \"path\": doc.FileName or None,\n    \"objects\": [obj.Name for obj in doc.Objects],\n    \"is_modified\": doc.Modified if hasattr(doc, \"Modified\") else False,\n}}\n\"\"\"\n        )\n\n        if result.success and result.result:\n            return DocumentInfo(**result.result)\n\n        error_msg = result.error_traceback or \"Failed to open document\"\n        raise ValueError(error_msg)\n\n    async def save_document(\n        self,\n        doc_name: str | None = None,\n        path: str | None = None,\n    ) -&gt; str:\n        \"\"\"Save a document.\n\n        Args:\n            doc_name: Document name (uses active if None).\n            path: Save path (uses existing path if None).\n\n        Returns:\n            Path where document was saved.\n\n        Raises:\n            ValueError: If document not found or no path specified for new doc.\n        \"\"\"\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No active document\" if {doc_name!r} is None else f\"Document not found: {doc_name!r}\")\n\nsave_path = {path!r} or doc.FileName\nif not save_path:\n    raise ValueError(\"No path specified for new document\")\n\ndoc.saveAs(save_path)\n_result_ = save_path\n\"\"\"\n\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return result.result\n\n        error_msg = result.error_traceback or \"Failed to save document\"\n        raise ValueError(error_msg)\n\n    async def close_document(self, doc_name: str | None = None) -&gt; None:\n        \"\"\"Close a document.\n\n        Args:\n            doc_name: Document name (uses active if None).\n        \"\"\"\n        code = f\"\"\"\ndoc_name = {doc_name!r}\nif doc_name is None:\n    doc = FreeCAD.ActiveDocument\n    if doc:\n        doc_name = doc.Name\n    else:\n        raise ValueError(\"No active document\")\n\nFreeCAD.closeDocument(doc_name)\n_result_ = True\n\"\"\"\n        result = await self.execute_python(code)\n\n        if not result.success:\n            error_msg = result.error_traceback or \"Failed to close document\"\n            raise ValueError(error_msg)\n\n    # =========================================================================\n    # Object Management\n    # =========================================================================\n\n    async def get_objects(self, doc_name: str | None = None) -&gt; list[ObjectInfo]:\n        \"\"\"Get all objects in a document.\n\n        Args:\n            doc_name: Document name (uses active if None).\n\n        Returns:\n            List of ObjectInfo for each object.\n        \"\"\"\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nobjects = []\nfor obj in doc.Objects:\n    obj_info = {{\n        \"name\": obj.Name,\n        \"label\": obj.Label,\n        \"type_id\": obj.TypeId,\n        \"visibility\": obj.ViewObject.Visibility if hasattr(obj, \"ViewObject\") and obj.ViewObject else True,\n        \"children\": [c.Name for c in obj.OutList] if hasattr(obj, \"OutList\") else [],\n        \"parents\": [p.Name for p in obj.InList] if hasattr(obj, \"InList\") else [],\n    }}\n    objects.append(obj_info)\n\n_result_ = objects\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return [ObjectInfo(**obj) for obj in result.result]\n        return []\n\n    async def create_object(\n        self,\n        type_id: str,\n        name: str | None = None,\n        properties: dict[str, Any] | None = None,\n        doc_name: str | None = None,\n    ) -&gt; ObjectInfo:\n        \"\"\"Create a new object.\n\n        Args:\n            type_id: FreeCAD type ID (e.g., \"Part::Box\", \"Part::Cylinder\").\n            name: Object name (auto-generated if None).\n            properties: Initial property values.\n            doc_name: Target document (uses active if None).\n\n        Returns:\n            ObjectInfo for the created object.\n        \"\"\"\n        properties = properties or {}\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nobj = doc.addObject({type_id!r}, {name!r} or \"\")\n\n# Set properties\nfor prop_name, prop_val in {properties!r}.items():\n    if hasattr(obj, prop_name):\n        setattr(obj, prop_name, prop_val)\n\ndoc.recompute()\n\n_result_ = {{\n    \"name\": obj.Name,\n    \"label\": obj.Label,\n    \"type_id\": obj.TypeId,\n    \"visibility\": True,\n    \"children\": [c.Name for c in obj.OutList] if hasattr(obj, \"OutList\") else [],\n    \"parents\": [p.Name for p in obj.InList] if hasattr(obj, \"InList\") else [],\n}}\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return ObjectInfo(**result.result)\n\n        error_msg = result.error_traceback or \"Failed to create object\"\n        raise ValueError(error_msg)\n\n    async def edit_object(\n        self,\n        obj_name: str,\n        properties: dict[str, Any],\n        doc_name: str | None = None,\n    ) -&gt; ObjectInfo:\n        \"\"\"Edit object properties.\n\n        Args:\n            obj_name: Name of the object to edit.\n            properties: Property values to set.\n            doc_name: Document name (uses active if None).\n\n        Returns:\n            Updated ObjectInfo.\n\n        Raises:\n            ValueError: If object not found.\n        \"\"\"\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nobj = doc.getObject({obj_name!r})\nif obj is None:\n    raise ValueError(f\"Object not found: {obj_name!r}\")\n\n# Set properties\nfor prop_name, prop_val in {properties!r}.items():\n    if hasattr(obj, prop_name):\n        setattr(obj, prop_name, prop_val)\n\ndoc.recompute()\n\n_result_ = {{\n    \"name\": obj.Name,\n    \"label\": obj.Label,\n    \"type_id\": obj.TypeId,\n    \"visibility\": obj.ViewObject.Visibility if hasattr(obj, \"ViewObject\") and obj.ViewObject else True,\n    \"children\": [c.Name for c in obj.OutList] if hasattr(obj, \"OutList\") else [],\n    \"parents\": [p.Name for p in obj.InList] if hasattr(obj, \"InList\") else [],\n}}\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return ObjectInfo(**result.result)\n\n        error_msg = result.error_traceback or \"Failed to edit object\"\n        raise ValueError(error_msg)\n\n    async def delete_object(\n        self,\n        obj_name: str,\n        doc_name: str | None = None,\n    ) -&gt; None:\n        \"\"\"Delete an object.\n\n        Args:\n            obj_name: Name of the object to delete.\n            doc_name: Document name (uses active if None).\n\n        Raises:\n            ValueError: If object not found.\n        \"\"\"\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nobj = doc.getObject({obj_name!r})\nif obj is None:\n    raise ValueError(f\"Object not found: {obj_name!r}\")\n\ndoc.removeObject({obj_name!r})\n_result_ = True\n\"\"\"\n        result = await self.execute_python(code)\n\n        if not result.success:\n            error_msg = result.error_traceback or \"Failed to delete object\"\n            raise ValueError(error_msg)\n\n    # =========================================================================\n    # View and Screenshot\n    # =========================================================================\n\n    async def get_screenshot(\n        self,\n        view_angle: ViewAngle | None = None,\n        width: int = 800,\n        height: int = 600,\n        doc_name: str | None = None,\n    ) -&gt; ScreenshotResult:\n        \"\"\"Capture a screenshot of the 3D view.\n\n        Note: In embedded headless mode, screenshots are typically not available.\n\n        Args:\n            view_angle: View angle to set before capture.\n            width: Image width in pixels.\n            height: Image height in pixels.\n            doc_name: Document name (uses active if None).\n\n        Returns:\n            ScreenshotResult with image data or error.\n        \"\"\"\n        # Check if GUI is available\n        gui_available = await self.is_gui_available()\n\n        if not gui_available:\n            return ScreenshotResult(\n                success=False,\n                error=\"Screenshots not available in headless mode\",\n                width=width,\n                height=height,\n                view_angle=view_angle,\n            )\n\n        # If GUI is available, attempt screenshot\n        view_angle_str = view_angle.value if view_angle else \"Isometric\"\n        code = f\"\"\"\nimport base64\nimport tempfile\nimport os\n\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nview = FreeCADGui.ActiveDocument.ActiveView\nif view is None:\n    raise ValueError(\"No active view\")\n\n# Set view angle\nview_type = {view_angle_str!r}\nif view_type == \"FitAll\":\n    view.fitAll()\nelif view_type == \"Isometric\":\n    view.viewIsometric()\nelif view_type == \"Front\":\n    view.viewFront()\nelif view_type == \"Back\":\n    view.viewRear()\nelif view_type == \"Top\":\n    view.viewTop()\nelif view_type == \"Bottom\":\n    view.viewBottom()\nelif view_type == \"Left\":\n    view.viewLeft()\nelif view_type == \"Right\":\n    view.viewRight()\n\n# Save to temp file and read\nwith tempfile.NamedTemporaryFile(suffix=\".png\", delete=False) as f:\n    temp_path = f.name\n\nview.saveImage(temp_path, {width}, {height}, \"Current\")\n\nwith open(temp_path, \"rb\") as f:\n    image_data = base64.b64encode(f.read()).decode(\"utf-8\")\n\nos.unlink(temp_path)\n\n_result_ = {{\n    \"success\": True,\n    \"data\": image_data,\n    \"format\": \"png\",\n    \"width\": {width},\n    \"height\": {height},\n}}\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return ScreenshotResult(\n                success=True,\n                data=result.result[\"data\"],\n                format=result.result[\"format\"],\n                width=result.result[\"width\"],\n                height=result.result[\"height\"],\n                view_angle=view_angle,\n            )\n\n        return ScreenshotResult(\n            success=False,\n            error=result.error_traceback or \"Failed to capture screenshot\",\n            width=width,\n            height=height,\n            view_angle=view_angle,\n        )\n\n    async def set_view(\n        self,\n        view_angle: ViewAngle,\n        doc_name: str | None = None,\n    ) -&gt; None:\n        \"\"\"Set the 3D view angle.\n\n        Args:\n            view_angle: View angle to set.\n            doc_name: Document name (uses active if None).\n        \"\"\"\n        gui_available = await self.is_gui_available()\n\n        if not gui_available:\n            return  # Silently ignore in headless mode\n\n        view_angle_str = view_angle.value\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nview = FreeCADGui.ActiveDocument.ActiveView\nif view is None:\n    raise ValueError(\"No active view\")\n\nview_type = {view_angle_str!r}\nif view_type == \"FitAll\":\n    view.fitAll()\nelif view_type == \"Isometric\":\n    view.viewIsometric()\nelif view_type == \"Front\":\n    view.viewFront()\nelif view_type == \"Back\":\n    view.viewRear()\nelif view_type == \"Top\":\n    view.viewTop()\nelif view_type == \"Bottom\":\n    view.viewBottom()\nelif view_type == \"Left\":\n    view.viewLeft()\nelif view_type == \"Right\":\n    view.viewRight()\n\n_result_ = True\n\"\"\"\n        await self.execute_python(code)\n\n    # =========================================================================\n    # Macros\n    # =========================================================================\n\n    def _get_macro_path(self) -&gt; Path:\n        \"\"\"Get the FreeCAD macro directory path.\"\"\"\n        # Default FreeCAD macro locations\n        if sys.platform == \"darwin\":\n            return Path.home() / \"Library\" / \"Application Support\" / \"FreeCAD\" / \"Macro\"\n        elif sys.platform == \"win32\":\n            return Path(os.environ.get(\"APPDATA\", \"\")) / \"FreeCAD\" / \"Macro\"\n        else:\n            return Path.home() / \".local\" / \"share\" / \"FreeCAD\" / \"Macro\"\n\n    async def get_macros(self) -&gt; list[MacroInfo]:\n        \"\"\"Get list of available macros.\n\n        Returns:\n            List of MacroInfo for each macro.\n        \"\"\"\n        macro_path = self._get_macro_path()\n\n        if not macro_path.exists():\n            return []\n\n        macros = []\n        for macro_file in macro_path.glob(\"*.FCMacro\"):\n            description = \"\"\n            try:\n                content = macro_file.read_text()\n                # Extract description from first comment block\n                for line in content.split(\"\\n\"):\n                    if line.startswith(\"#\"):\n                        desc_line = line.lstrip(\"#\").strip()\n                        if desc_line and not desc_line.startswith(\"!\"):\n                            description = desc_line\n                            break\n            except Exception:\n                pass\n\n            macros.append(\n                MacroInfo(\n                    name=macro_file.stem,\n                    path=str(macro_file),\n                    description=description,\n                    is_system=False,\n                )\n            )\n\n        return macros\n\n    async def run_macro(\n        self,\n        macro_name: str,\n        args: dict[str, Any] | None = None,\n    ) -&gt; ExecutionResult:\n        \"\"\"Run a macro by name.\n\n        Args:\n            macro_name: Macro name (without .FCMacro extension).\n            args: Arguments to pass to the macro.\n\n        Returns:\n            ExecutionResult from macro execution.\n        \"\"\"\n        macro_path = self._get_macro_path() / f\"{macro_name}.FCMacro\"\n\n        if not macro_path.exists():\n            return ExecutionResult(\n                success=False,\n                result=None,\n                stdout=\"\",\n                stderr=f\"Macro not found: {macro_name}\",\n                execution_time_ms=0,\n                error_type=\"FileNotFoundError\",\n            )\n\n        try:\n            macro_code = macro_path.read_text()\n        except Exception as e:\n            return ExecutionResult(\n                success=False,\n                result=None,\n                stdout=\"\",\n                stderr=f\"Failed to read macro: {e}\",\n                execution_time_ms=0,\n                error_type=type(e).__name__,\n            )\n\n        # Prepend argument setup if provided\n        if args:\n            args_setup = \"\\n\".join(f\"{k} = {v!r}\" for k, v in args.items())\n            macro_code = args_setup + \"\\n\" + macro_code\n\n        return await self.execute_python(macro_code)\n\n    async def create_macro(\n        self,\n        name: str,\n        code: str,\n        description: str = \"\",\n    ) -&gt; MacroInfo:\n        \"\"\"Create a new macro.\n\n        Args:\n            name: Macro name (without extension).\n            code: Python code for the macro.\n            description: Macro description.\n\n        Returns:\n            MacroInfo for the created macro.\n        \"\"\"\n        macro_path = self._get_macro_path()\n        macro_path.mkdir(parents=True, exist_ok=True)\n\n        macro_file = macro_path / f\"{name}.FCMacro\"\n\n        # Add description as header comment\n        header = f\"# {description}\\n\\n\" if description else \"\"\n\n        # Add standard imports\n        full_code = f\"\"\"{header}# -*- coding: utf-8 -*-\n# FreeCAD Macro: {name}\n# Created via MCP Bridge\n\nimport FreeCAD\nimport FreeCADGui\n\n{code}\n\"\"\"\n        macro_file.write_text(full_code)\n\n        return MacroInfo(\n            name=name,\n            path=str(macro_file),\n            description=description,\n            is_system=False,\n        )\n\n    # =========================================================================\n    # Workbenches\n    # =========================================================================\n\n    async def get_workbenches(self) -&gt; list[WorkbenchInfo]:\n        \"\"\"Get list of available workbenches.\n\n        Returns:\n            List of WorkbenchInfo for each workbench.\n        \"\"\"\n        gui_available = await self.is_gui_available()\n\n        if not gui_available:\n            # Return common workbenches for headless mode\n            common_workbenches = [\n                \"StartWorkbench\",\n                \"PartWorkbench\",\n                \"PartDesignWorkbench\",\n                \"DraftWorkbench\",\n                \"SketcherWorkbench\",\n                \"MeshWorkbench\",\n                \"SpreadsheetWorkbench\",\n            ]\n            return [\n                WorkbenchInfo(name=wb, label=wb.replace(\"Workbench\", \"\"))\n                for wb in common_workbenches\n            ]\n\n        code = \"\"\"\nworkbenches = []\nactive_wb = FreeCADGui.activeWorkbench()\nactive_name = active_wb.__class__.__name__ if active_wb else None\n\nfor name in FreeCADGui.listWorkbenches():\n    wb = FreeCADGui.getWorkbench(name)\n    workbenches.append({\n        \"name\": name,\n        \"label\": wb.MenuText if hasattr(wb, \"MenuText\") else name,\n        \"icon\": wb.Icon if hasattr(wb, \"Icon\") else \"\",\n        \"is_active\": name == active_name,\n    })\n\n_result_ = workbenches\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return [WorkbenchInfo(**wb) for wb in result.result]\n        return []\n\n    async def activate_workbench(self, workbench_name: str) -&gt; None:\n        \"\"\"Activate a workbench.\n\n        Args:\n            workbench_name: Workbench internal name.\n\n        Raises:\n            ValueError: If workbench not found.\n        \"\"\"\n        gui_available = await self.is_gui_available()\n\n        if not gui_available:\n            return  # Silently ignore in headless mode\n\n        code = f\"\"\"\ntry:\n    FreeCADGui.activateWorkbench({workbench_name!r})\n    _result_ = True\nexcept Exception as e:\n    raise ValueError(f\"Failed to activate workbench: {{e}}\")\n\"\"\"\n        result = await self.execute_python(code)\n\n        if not result.success:\n            error_msg = result.error_traceback or \"Failed to activate workbench\"\n            raise ValueError(error_msg)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.embedded.EmbeddedBridge-functions","title":"Functions","text":""},{"location":"api/bridge/#freecad_mcp.bridge.embedded.EmbeddedBridge.__init__","title":"<code>__init__(freecad_path=None)</code>","text":"<p>Initialize the embedded bridge.</p> <p>Parameters:</p> Name Type Description Default <code>freecad_path</code> <code>str | None</code> <p>Path to FreeCAD's lib directory. If provided, this path will be added to sys.path before importing.</p> <code>None</code> Source code in <code>src/freecad_mcp/bridge/embedded.py</code> <pre><code>def __init__(self, freecad_path: str | None = None) -&gt; None:\n    \"\"\"Initialize the embedded bridge.\n\n    Args:\n        freecad_path: Path to FreeCAD's lib directory. If provided,\n            this path will be added to sys.path before importing.\n    \"\"\"\n    self._freecad_path = freecad_path\n    self._fc_module: Any = None\n    self._executor = ThreadPoolExecutor(max_workers=1, thread_name_prefix=\"freecad\")\n    self._connected = False\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.embedded.EmbeddedBridge.activate_workbench","title":"<code>activate_workbench(workbench_name)</code>  <code>async</code>","text":"<p>Activate a workbench.</p> <p>Parameters:</p> Name Type Description Default <code>workbench_name</code> <code>str</code> <p>Workbench internal name.</p> required <p>Raises:</p> Type Description <code>ValueError</code> <p>If workbench not found.</p> Source code in <code>src/freecad_mcp/bridge/embedded.py</code> <pre><code>    async def activate_workbench(self, workbench_name: str) -&gt; None:\n        \"\"\"Activate a workbench.\n\n        Args:\n            workbench_name: Workbench internal name.\n\n        Raises:\n            ValueError: If workbench not found.\n        \"\"\"\n        gui_available = await self.is_gui_available()\n\n        if not gui_available:\n            return  # Silently ignore in headless mode\n\n        code = f\"\"\"\ntry:\n    FreeCADGui.activateWorkbench({workbench_name!r})\n    _result_ = True\nexcept Exception as e:\n    raise ValueError(f\"Failed to activate workbench: {{e}}\")\n\"\"\"\n        result = await self.execute_python(code)\n\n        if not result.success:\n            error_msg = result.error_traceback or \"Failed to activate workbench\"\n            raise ValueError(error_msg)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.embedded.EmbeddedBridge.close_document","title":"<code>close_document(doc_name=None)</code>  <code>async</code>","text":"<p>Close a document.</p> <p>Parameters:</p> Name Type Description Default <code>doc_name</code> <code>str | None</code> <p>Document name (uses active if None).</p> <code>None</code> Source code in <code>src/freecad_mcp/bridge/embedded.py</code> <pre><code>    async def close_document(self, doc_name: str | None = None) -&gt; None:\n        \"\"\"Close a document.\n\n        Args:\n            doc_name: Document name (uses active if None).\n        \"\"\"\n        code = f\"\"\"\ndoc_name = {doc_name!r}\nif doc_name is None:\n    doc = FreeCAD.ActiveDocument\n    if doc:\n        doc_name = doc.Name\n    else:\n        raise ValueError(\"No active document\")\n\nFreeCAD.closeDocument(doc_name)\n_result_ = True\n\"\"\"\n        result = await self.execute_python(code)\n\n        if not result.success:\n            error_msg = result.error_traceback or \"Failed to close document\"\n            raise ValueError(error_msg)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.embedded.EmbeddedBridge.connect","title":"<code>connect()</code>  <code>async</code>","text":"<p>Import and initialize FreeCAD.</p> <p>Raises:</p> Type Description <code>ConnectionError</code> <p>If FreeCAD cannot be imported.</p> Source code in <code>src/freecad_mcp/bridge/embedded.py</code> <pre><code>async def connect(self) -&gt; None:\n    \"\"\"Import and initialize FreeCAD.\n\n    Raises:\n        ConnectionError: If FreeCAD cannot be imported.\n    \"\"\"\n    if self._freecad_path:\n        sys.path.insert(0, self._freecad_path)\n\n    loop = asyncio.get_event_loop()\n    try:\n        self._fc_module = await loop.run_in_executor(\n            self._executor,\n            self._import_freecad,\n        )\n        self._connected = True\n    except ImportError as e:\n        msg = f\"Failed to import FreeCAD: {e}\"\n        raise ConnectionError(msg) from e\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.embedded.EmbeddedBridge.create_document","title":"<code>create_document(name, label=None)</code>  <code>async</code>","text":"<p>Create a new document.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Internal document name (no spaces).</p> required <code>label</code> <code>str | None</code> <p>Display label (optional, defaults to name).</p> <code>None</code> <p>Returns:</p> Type Description <code>DocumentInfo</code> <p>DocumentInfo for the created document.</p> Source code in <code>src/freecad_mcp/bridge/embedded.py</code> <pre><code>    async def create_document(\n        self, name: str, label: str | None = None\n    ) -&gt; DocumentInfo:\n        \"\"\"Create a new document.\n\n        Args:\n            name: Internal document name (no spaces).\n            label: Display label (optional, defaults to name).\n\n        Returns:\n            DocumentInfo for the created document.\n        \"\"\"\n        label = label or name\n        result = await self.execute_python(\n            f\"\"\"\ndoc = FreeCAD.newDocument({name!r})\ndoc.Label = {label!r}\n_result_ = {{\n    \"name\": doc.Name,\n    \"label\": doc.Label,\n    \"path\": doc.FileName or None,\n    \"objects\": [],\n    \"is_modified\": False,\n}}\n\"\"\"\n        )\n\n        if result.success and result.result:\n            return DocumentInfo(**result.result)\n\n        error_msg = result.error_traceback or \"Failed to create document\"\n        raise ValueError(error_msg)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.embedded.EmbeddedBridge.create_macro","title":"<code>create_macro(name, code, description='')</code>  <code>async</code>","text":"<p>Create a new macro.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Macro name (without extension).</p> required <code>code</code> <code>str</code> <p>Python code for the macro.</p> required <code>description</code> <code>str</code> <p>Macro description.</p> <code>''</code> <p>Returns:</p> Type Description <code>MacroInfo</code> <p>MacroInfo for the created macro.</p> Source code in <code>src/freecad_mcp/bridge/embedded.py</code> <pre><code>    async def create_macro(\n        self,\n        name: str,\n        code: str,\n        description: str = \"\",\n    ) -&gt; MacroInfo:\n        \"\"\"Create a new macro.\n\n        Args:\n            name: Macro name (without extension).\n            code: Python code for the macro.\n            description: Macro description.\n\n        Returns:\n            MacroInfo for the created macro.\n        \"\"\"\n        macro_path = self._get_macro_path()\n        macro_path.mkdir(parents=True, exist_ok=True)\n\n        macro_file = macro_path / f\"{name}.FCMacro\"\n\n        # Add description as header comment\n        header = f\"# {description}\\n\\n\" if description else \"\"\n\n        # Add standard imports\n        full_code = f\"\"\"{header}# -*- coding: utf-8 -*-\n# FreeCAD Macro: {name}\n# Created via MCP Bridge\n\nimport FreeCAD\nimport FreeCADGui\n\n{code}\n\"\"\"\n        macro_file.write_text(full_code)\n\n        return MacroInfo(\n            name=name,\n            path=str(macro_file),\n            description=description,\n            is_system=False,\n        )\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.embedded.EmbeddedBridge.create_object","title":"<code>create_object(type_id, name=None, properties=None, doc_name=None)</code>  <code>async</code>","text":"<p>Create a new object.</p> <p>Parameters:</p> Name Type Description Default <code>type_id</code> <code>str</code> <p>FreeCAD type ID (e.g., \"Part::Box\", \"Part::Cylinder\").</p> required <code>name</code> <code>str | None</code> <p>Object name (auto-generated if None).</p> <code>None</code> <code>properties</code> <code>dict[str, Any] | None</code> <p>Initial property values.</p> <code>None</code> <code>doc_name</code> <code>str | None</code> <p>Target document (uses active if None).</p> <code>None</code> <p>Returns:</p> Type Description <code>ObjectInfo</code> <p>ObjectInfo for the created object.</p> Source code in <code>src/freecad_mcp/bridge/embedded.py</code> <pre><code>    async def create_object(\n        self,\n        type_id: str,\n        name: str | None = None,\n        properties: dict[str, Any] | None = None,\n        doc_name: str | None = None,\n    ) -&gt; ObjectInfo:\n        \"\"\"Create a new object.\n\n        Args:\n            type_id: FreeCAD type ID (e.g., \"Part::Box\", \"Part::Cylinder\").\n            name: Object name (auto-generated if None).\n            properties: Initial property values.\n            doc_name: Target document (uses active if None).\n\n        Returns:\n            ObjectInfo for the created object.\n        \"\"\"\n        properties = properties or {}\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nobj = doc.addObject({type_id!r}, {name!r} or \"\")\n\n# Set properties\nfor prop_name, prop_val in {properties!r}.items():\n    if hasattr(obj, prop_name):\n        setattr(obj, prop_name, prop_val)\n\ndoc.recompute()\n\n_result_ = {{\n    \"name\": obj.Name,\n    \"label\": obj.Label,\n    \"type_id\": obj.TypeId,\n    \"visibility\": True,\n    \"children\": [c.Name for c in obj.OutList] if hasattr(obj, \"OutList\") else [],\n    \"parents\": [p.Name for p in obj.InList] if hasattr(obj, \"InList\") else [],\n}}\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return ObjectInfo(**result.result)\n\n        error_msg = result.error_traceback or \"Failed to create object\"\n        raise ValueError(error_msg)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.embedded.EmbeddedBridge.delete_object","title":"<code>delete_object(obj_name, doc_name=None)</code>  <code>async</code>","text":"<p>Delete an object.</p> <p>Parameters:</p> Name Type Description Default <code>obj_name</code> <code>str</code> <p>Name of the object to delete.</p> required <code>doc_name</code> <code>str | None</code> <p>Document name (uses active if None).</p> <code>None</code> <p>Raises:</p> Type Description <code>ValueError</code> <p>If object not found.</p> Source code in <code>src/freecad_mcp/bridge/embedded.py</code> <pre><code>    async def delete_object(\n        self,\n        obj_name: str,\n        doc_name: str | None = None,\n    ) -&gt; None:\n        \"\"\"Delete an object.\n\n        Args:\n            obj_name: Name of the object to delete.\n            doc_name: Document name (uses active if None).\n\n        Raises:\n            ValueError: If object not found.\n        \"\"\"\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nobj = doc.getObject({obj_name!r})\nif obj is None:\n    raise ValueError(f\"Object not found: {obj_name!r}\")\n\ndoc.removeObject({obj_name!r})\n_result_ = True\n\"\"\"\n        result = await self.execute_python(code)\n\n        if not result.success:\n            error_msg = result.error_traceback or \"Failed to delete object\"\n            raise ValueError(error_msg)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.embedded.EmbeddedBridge.disconnect","title":"<code>disconnect()</code>  <code>async</code>","text":"<p>Clean up resources.</p> Source code in <code>src/freecad_mcp/bridge/embedded.py</code> <pre><code>async def disconnect(self) -&gt; None:\n    \"\"\"Clean up resources.\"\"\"\n    self._connected = False\n    self._executor.shutdown(wait=True)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.embedded.EmbeddedBridge.edit_object","title":"<code>edit_object(obj_name, properties, doc_name=None)</code>  <code>async</code>","text":"<p>Edit object properties.</p> <p>Parameters:</p> Name Type Description Default <code>obj_name</code> <code>str</code> <p>Name of the object to edit.</p> required <code>properties</code> <code>dict[str, Any]</code> <p>Property values to set.</p> required <code>doc_name</code> <code>str | None</code> <p>Document name (uses active if None).</p> <code>None</code> <p>Returns:</p> Type Description <code>ObjectInfo</code> <p>Updated ObjectInfo.</p> <p>Raises:</p> Type Description <code>ValueError</code> <p>If object not found.</p> Source code in <code>src/freecad_mcp/bridge/embedded.py</code> <pre><code>    async def edit_object(\n        self,\n        obj_name: str,\n        properties: dict[str, Any],\n        doc_name: str | None = None,\n    ) -&gt; ObjectInfo:\n        \"\"\"Edit object properties.\n\n        Args:\n            obj_name: Name of the object to edit.\n            properties: Property values to set.\n            doc_name: Document name (uses active if None).\n\n        Returns:\n            Updated ObjectInfo.\n\n        Raises:\n            ValueError: If object not found.\n        \"\"\"\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nobj = doc.getObject({obj_name!r})\nif obj is None:\n    raise ValueError(f\"Object not found: {obj_name!r}\")\n\n# Set properties\nfor prop_name, prop_val in {properties!r}.items():\n    if hasattr(obj, prop_name):\n        setattr(obj, prop_name, prop_val)\n\ndoc.recompute()\n\n_result_ = {{\n    \"name\": obj.Name,\n    \"label\": obj.Label,\n    \"type_id\": obj.TypeId,\n    \"visibility\": obj.ViewObject.Visibility if hasattr(obj, \"ViewObject\") and obj.ViewObject else True,\n    \"children\": [c.Name for c in obj.OutList] if hasattr(obj, \"OutList\") else [],\n    \"parents\": [p.Name for p in obj.InList] if hasattr(obj, \"InList\") else [],\n}}\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return ObjectInfo(**result.result)\n\n        error_msg = result.error_traceback or \"Failed to edit object\"\n        raise ValueError(error_msg)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.embedded.EmbeddedBridge.execute_python","title":"<code>execute_python(code, timeout_ms=30000)</code>  <code>async</code>","text":"<p>Execute Python code in FreeCAD context.</p> <p>Parameters:</p> Name Type Description Default <code>code</code> <code>str</code> <p>Python code to execute.</p> required <code>timeout_ms</code> <code>int</code> <p>Maximum execution time in milliseconds.</p> <code>30000</code> <p>Returns:</p> Type Description <code>ExecutionResult</code> <p>ExecutionResult with execution outcome.</p> Source code in <code>src/freecad_mcp/bridge/embedded.py</code> <pre><code>async def execute_python(\n    self,\n    code: str,\n    timeout_ms: int = 30000,\n) -&gt; ExecutionResult:\n    \"\"\"Execute Python code in FreeCAD context.\n\n    Args:\n        code: Python code to execute.\n        timeout_ms: Maximum execution time in milliseconds.\n\n    Returns:\n        ExecutionResult with execution outcome.\n    \"\"\"\n    if not self._connected:\n        return ExecutionResult(\n            success=False,\n            result=None,\n            stdout=\"\",\n            stderr=\"FreeCAD bridge not connected\",\n            execution_time_ms=0,\n            error_type=\"ConnectionError\",\n            error_traceback=None,\n        )\n\n    loop = asyncio.get_event_loop()\n\n    try:\n        result = await asyncio.wait_for(\n            loop.run_in_executor(\n                self._executor,\n                lambda: self._execute_code(code),\n            ),\n            timeout=timeout_ms / 1000,\n        )\n    except TimeoutError:\n        return ExecutionResult(\n            success=False,\n            result=None,\n            stdout=\"\",\n            stderr=f\"Execution timed out after {timeout_ms}ms\",\n            execution_time_ms=float(timeout_ms),\n            error_type=\"TimeoutError\",\n            error_traceback=None,\n        )\n\n    return result\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.embedded.EmbeddedBridge.get_active_document","title":"<code>get_active_document()</code>  <code>async</code>","text":"<p>Get the active document.</p> Source code in <code>src/freecad_mcp/bridge/embedded.py</code> <pre><code>    async def get_active_document(self) -&gt; DocumentInfo | None:\n        \"\"\"Get the active document.\"\"\"\n        result = await self.execute_python(\n            \"\"\"\ndoc = FreeCAD.ActiveDocument\nif doc:\n    _result_ = {\n        \"name\": doc.Name,\n        \"path\": doc.FileName or None,\n        \"objects\": [obj.Name for obj in doc.Objects],\n        \"is_modified\": doc.Modified if hasattr(doc, \"Modified\") else False,\n        \"label\": doc.Label,\n    }\nelse:\n    _result_ = None\n\"\"\"\n        )\n\n        if result.success and result.result:\n            return DocumentInfo(**result.result)\n        return None\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.embedded.EmbeddedBridge.get_console_output","title":"<code>get_console_output(lines=100)</code>  <code>async</code>","text":"<p>Get recent console output.</p> <p>Note: In embedded mode, we don't have direct access to FreeCAD's console history, so we return an empty list or captured output.</p> Source code in <code>src/freecad_mcp/bridge/embedded.py</code> <pre><code>async def get_console_output(\n    self,\n    lines: int = 100,\n) -&gt; list[str]:\n    \"\"\"Get recent console output.\n\n    Note: In embedded mode, we don't have direct access to FreeCAD's\n    console history, so we return an empty list or captured output.\n    \"\"\"\n    return []\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.embedded.EmbeddedBridge.get_documents","title":"<code>get_documents()</code>  <code>async</code>","text":"<p>Get list of open documents.</p> Source code in <code>src/freecad_mcp/bridge/embedded.py</code> <pre><code>    async def get_documents(self) -&gt; list[DocumentInfo]:\n        \"\"\"Get list of open documents.\"\"\"\n        result = await self.execute_python(\n            \"\"\"\n_result_ = []\nfor doc in FreeCAD.listDocuments().values():\n    _result_.append({\n        \"name\": doc.Name,\n        \"path\": doc.FileName or None,\n        \"objects\": [obj.Name for obj in doc.Objects],\n        \"is_modified\": doc.Modified if hasattr(doc, \"Modified\") else False,\n        \"label\": doc.Label,\n    })\n\"\"\"\n        )\n\n        if result.success and result.result:\n            return [DocumentInfo(**doc) for doc in result.result]\n        return []\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.embedded.EmbeddedBridge.get_freecad_version","title":"<code>get_freecad_version()</code>  <code>async</code>","text":"<p>Get FreeCAD version information.</p> Source code in <code>src/freecad_mcp/bridge/embedded.py</code> <pre><code>    async def get_freecad_version(self) -&gt; dict[str, Any]:\n        \"\"\"Get FreeCAD version information.\"\"\"\n        result = await self.execute_python(\n            \"\"\"\nimport sys\n_result_ = {\n    \"version\": \".\".join(str(x) for x in FreeCAD.Version()[:3]),\n    \"version_tuple\": FreeCAD.Version()[:3],\n    \"build_date\": FreeCAD.Version()[3] if len(FreeCAD.Version()) &gt; 3 else \"unknown\",\n    \"python_version\": sys.version,\n    \"gui_available\": hasattr(FreeCAD, \"GuiUp\") and FreeCAD.GuiUp,\n}\n\"\"\"\n        )\n\n        if result.success and result.result:\n            return result.result\n\n        return {\n            \"version\": \"unknown\",\n            \"version_tuple\": [],\n            \"build_date\": \"unknown\",\n            \"python_version\": sys.version,\n            \"gui_available\": False,\n        }\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.embedded.EmbeddedBridge.get_macros","title":"<code>get_macros()</code>  <code>async</code>","text":"<p>Get list of available macros.</p> <p>Returns:</p> Type Description <code>list[MacroInfo]</code> <p>List of MacroInfo for each macro.</p> Source code in <code>src/freecad_mcp/bridge/embedded.py</code> <pre><code>async def get_macros(self) -&gt; list[MacroInfo]:\n    \"\"\"Get list of available macros.\n\n    Returns:\n        List of MacroInfo for each macro.\n    \"\"\"\n    macro_path = self._get_macro_path()\n\n    if not macro_path.exists():\n        return []\n\n    macros = []\n    for macro_file in macro_path.glob(\"*.FCMacro\"):\n        description = \"\"\n        try:\n            content = macro_file.read_text()\n            # Extract description from first comment block\n            for line in content.split(\"\\n\"):\n                if line.startswith(\"#\"):\n                    desc_line = line.lstrip(\"#\").strip()\n                    if desc_line and not desc_line.startswith(\"!\"):\n                        description = desc_line\n                        break\n        except Exception:\n            pass\n\n        macros.append(\n            MacroInfo(\n                name=macro_file.stem,\n                path=str(macro_file),\n                description=description,\n                is_system=False,\n            )\n        )\n\n    return macros\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.embedded.EmbeddedBridge.get_object","title":"<code>get_object(obj_name, doc_name=None)</code>  <code>async</code>","text":"<p>Get detailed object information.</p> Source code in <code>src/freecad_mcp/bridge/embedded.py</code> <pre><code>    async def get_object(\n        self,\n        obj_name: str,\n        doc_name: str | None = None,\n    ) -&gt; ObjectInfo:\n        \"\"\"Get detailed object information.\"\"\"\n        result = await self.execute_python(\n            f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nobj = doc.getObject({obj_name!r})\nif obj is None:\n    raise ValueError(f\"Object not found: {obj_name!r}\")\n\nprops = {{}}\nfor prop in obj.PropertiesList:\n    try:\n        val = getattr(obj, prop)\n        if hasattr(val, '__class__') and val.__class__.__module__ != 'builtins':\n            val = str(val)\n        props[prop] = val\n    except Exception:\n        props[prop] = \"&lt;unreadable&gt;\"\n\nshape_info = None\nif hasattr(obj, \"Shape\"):\n    shape = obj.Shape\n    shape_info = {{\n        \"type\": shape.ShapeType,\n        \"volume\": shape.Volume if hasattr(shape, \"Volume\") else None,\n        \"area\": shape.Area if hasattr(shape, \"Area\") else None,\n        \"is_valid\": shape.isValid(),\n    }}\n\n_result_ = {{\n    \"name\": obj.Name,\n    \"label\": obj.Label,\n    \"type_id\": obj.TypeId,\n    \"properties\": props,\n    \"shape_info\": shape_info,\n    \"children\": [c.Name for c in obj.OutList] if hasattr(obj, \"OutList\") else [],\n}}\n\"\"\"\n        )\n\n        if result.success and result.result:\n            return ObjectInfo(**result.result)\n\n        error_msg = result.error_traceback or \"Failed to get object\"\n        raise ValueError(error_msg)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.embedded.EmbeddedBridge.get_objects","title":"<code>get_objects(doc_name=None)</code>  <code>async</code>","text":"<p>Get all objects in a document.</p> <p>Parameters:</p> Name Type Description Default <code>doc_name</code> <code>str | None</code> <p>Document name (uses active if None).</p> <code>None</code> <p>Returns:</p> Type Description <code>list[ObjectInfo]</code> <p>List of ObjectInfo for each object.</p> Source code in <code>src/freecad_mcp/bridge/embedded.py</code> <pre><code>    async def get_objects(self, doc_name: str | None = None) -&gt; list[ObjectInfo]:\n        \"\"\"Get all objects in a document.\n\n        Args:\n            doc_name: Document name (uses active if None).\n\n        Returns:\n            List of ObjectInfo for each object.\n        \"\"\"\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nobjects = []\nfor obj in doc.Objects:\n    obj_info = {{\n        \"name\": obj.Name,\n        \"label\": obj.Label,\n        \"type_id\": obj.TypeId,\n        \"visibility\": obj.ViewObject.Visibility if hasattr(obj, \"ViewObject\") and obj.ViewObject else True,\n        \"children\": [c.Name for c in obj.OutList] if hasattr(obj, \"OutList\") else [],\n        \"parents\": [p.Name for p in obj.InList] if hasattr(obj, \"InList\") else [],\n    }}\n    objects.append(obj_info)\n\n_result_ = objects\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return [ObjectInfo(**obj) for obj in result.result]\n        return []\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.embedded.EmbeddedBridge.get_screenshot","title":"<code>get_screenshot(view_angle=None, width=800, height=600, doc_name=None)</code>  <code>async</code>","text":"<p>Capture a screenshot of the 3D view.</p> <p>Note: In embedded headless mode, screenshots are typically not available.</p> <p>Parameters:</p> Name Type Description Default <code>view_angle</code> <code>ViewAngle | None</code> <p>View angle to set before capture.</p> <code>None</code> <code>width</code> <code>int</code> <p>Image width in pixels.</p> <code>800</code> <code>height</code> <code>int</code> <p>Image height in pixels.</p> <code>600</code> <code>doc_name</code> <code>str | None</code> <p>Document name (uses active if None).</p> <code>None</code> <p>Returns:</p> Type Description <code>ScreenshotResult</code> <p>ScreenshotResult with image data or error.</p> Source code in <code>src/freecad_mcp/bridge/embedded.py</code> <pre><code>    async def get_screenshot(\n        self,\n        view_angle: ViewAngle | None = None,\n        width: int = 800,\n        height: int = 600,\n        doc_name: str | None = None,\n    ) -&gt; ScreenshotResult:\n        \"\"\"Capture a screenshot of the 3D view.\n\n        Note: In embedded headless mode, screenshots are typically not available.\n\n        Args:\n            view_angle: View angle to set before capture.\n            width: Image width in pixels.\n            height: Image height in pixels.\n            doc_name: Document name (uses active if None).\n\n        Returns:\n            ScreenshotResult with image data or error.\n        \"\"\"\n        # Check if GUI is available\n        gui_available = await self.is_gui_available()\n\n        if not gui_available:\n            return ScreenshotResult(\n                success=False,\n                error=\"Screenshots not available in headless mode\",\n                width=width,\n                height=height,\n                view_angle=view_angle,\n            )\n\n        # If GUI is available, attempt screenshot\n        view_angle_str = view_angle.value if view_angle else \"Isometric\"\n        code = f\"\"\"\nimport base64\nimport tempfile\nimport os\n\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nview = FreeCADGui.ActiveDocument.ActiveView\nif view is None:\n    raise ValueError(\"No active view\")\n\n# Set view angle\nview_type = {view_angle_str!r}\nif view_type == \"FitAll\":\n    view.fitAll()\nelif view_type == \"Isometric\":\n    view.viewIsometric()\nelif view_type == \"Front\":\n    view.viewFront()\nelif view_type == \"Back\":\n    view.viewRear()\nelif view_type == \"Top\":\n    view.viewTop()\nelif view_type == \"Bottom\":\n    view.viewBottom()\nelif view_type == \"Left\":\n    view.viewLeft()\nelif view_type == \"Right\":\n    view.viewRight()\n\n# Save to temp file and read\nwith tempfile.NamedTemporaryFile(suffix=\".png\", delete=False) as f:\n    temp_path = f.name\n\nview.saveImage(temp_path, {width}, {height}, \"Current\")\n\nwith open(temp_path, \"rb\") as f:\n    image_data = base64.b64encode(f.read()).decode(\"utf-8\")\n\nos.unlink(temp_path)\n\n_result_ = {{\n    \"success\": True,\n    \"data\": image_data,\n    \"format\": \"png\",\n    \"width\": {width},\n    \"height\": {height},\n}}\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return ScreenshotResult(\n                success=True,\n                data=result.result[\"data\"],\n                format=result.result[\"format\"],\n                width=result.result[\"width\"],\n                height=result.result[\"height\"],\n                view_angle=view_angle,\n            )\n\n        return ScreenshotResult(\n            success=False,\n            error=result.error_traceback or \"Failed to capture screenshot\",\n            width=width,\n            height=height,\n            view_angle=view_angle,\n        )\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.embedded.EmbeddedBridge.get_status","title":"<code>get_status()</code>  <code>async</code>","text":"<p>Get detailed connection status.</p> <p>Returns:</p> Type Description <code>ConnectionStatus</code> <p>ConnectionStatus with full status information.</p> Source code in <code>src/freecad_mcp/bridge/embedded.py</code> <pre><code>async def get_status(self) -&gt; ConnectionStatus:\n    \"\"\"Get detailed connection status.\n\n    Returns:\n        ConnectionStatus with full status information.\n    \"\"\"\n    if not self._connected:\n        return ConnectionStatus(\n            connected=False,\n            mode=\"embedded\",\n            error=\"Not connected\",\n        )\n\n    try:\n        ping_ms = await self.ping()\n        version_info = await self.get_freecad_version()\n        gui_available = await self.is_gui_available()\n\n        return ConnectionStatus(\n            connected=True,\n            mode=\"embedded\",\n            freecad_version=version_info.get(\"version\", \"unknown\"),\n            gui_available=gui_available,\n            last_ping_ms=ping_ms,\n        )\n    except Exception as e:\n        return ConnectionStatus(\n            connected=False,\n            mode=\"embedded\",\n            error=str(e),\n        )\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.embedded.EmbeddedBridge.get_workbenches","title":"<code>get_workbenches()</code>  <code>async</code>","text":"<p>Get list of available workbenches.</p> <p>Returns:</p> Type Description <code>list[WorkbenchInfo]</code> <p>List of WorkbenchInfo for each workbench.</p> Source code in <code>src/freecad_mcp/bridge/embedded.py</code> <pre><code>    async def get_workbenches(self) -&gt; list[WorkbenchInfo]:\n        \"\"\"Get list of available workbenches.\n\n        Returns:\n            List of WorkbenchInfo for each workbench.\n        \"\"\"\n        gui_available = await self.is_gui_available()\n\n        if not gui_available:\n            # Return common workbenches for headless mode\n            common_workbenches = [\n                \"StartWorkbench\",\n                \"PartWorkbench\",\n                \"PartDesignWorkbench\",\n                \"DraftWorkbench\",\n                \"SketcherWorkbench\",\n                \"MeshWorkbench\",\n                \"SpreadsheetWorkbench\",\n            ]\n            return [\n                WorkbenchInfo(name=wb, label=wb.replace(\"Workbench\", \"\"))\n                for wb in common_workbenches\n            ]\n\n        code = \"\"\"\nworkbenches = []\nactive_wb = FreeCADGui.activeWorkbench()\nactive_name = active_wb.__class__.__name__ if active_wb else None\n\nfor name in FreeCADGui.listWorkbenches():\n    wb = FreeCADGui.getWorkbench(name)\n    workbenches.append({\n        \"name\": name,\n        \"label\": wb.MenuText if hasattr(wb, \"MenuText\") else name,\n        \"icon\": wb.Icon if hasattr(wb, \"Icon\") else \"\",\n        \"is_active\": name == active_name,\n    })\n\n_result_ = workbenches\n\"\"\"\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return [WorkbenchInfo(**wb) for wb in result.result]\n        return []\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.embedded.EmbeddedBridge.is_connected","title":"<code>is_connected()</code>  <code>async</code>","text":"<p>Check if FreeCAD is imported and available.</p> Source code in <code>src/freecad_mcp/bridge/embedded.py</code> <pre><code>async def is_connected(self) -&gt; bool:\n    \"\"\"Check if FreeCAD is imported and available.\"\"\"\n    return self._connected and self._fc_module is not None\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.embedded.EmbeddedBridge.is_gui_available","title":"<code>is_gui_available()</code>  <code>async</code>","text":"<p>Check if GUI is available.</p> Source code in <code>src/freecad_mcp/bridge/embedded.py</code> <pre><code>async def is_gui_available(self) -&gt; bool:\n    \"\"\"Check if GUI is available.\"\"\"\n    result = await self.execute_python(\n        \"_result_ = hasattr(FreeCAD, 'GuiUp') and FreeCAD.GuiUp\"\n    )\n    return bool(result.success and result.result)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.embedded.EmbeddedBridge.open_document","title":"<code>open_document(path)</code>  <code>async</code>","text":"<p>Open an existing document.</p> <p>Parameters:</p> Name Type Description Default <code>path</code> <code>str</code> <p>Path to the .FCStd file.</p> required <p>Returns:</p> Type Description <code>DocumentInfo</code> <p>DocumentInfo for the opened document.</p> <p>Raises:</p> Type Description <code>FileNotFoundError</code> <p>If file doesn't exist.</p> <code>ValueError</code> <p>If file is not a valid FreeCAD document.</p> Source code in <code>src/freecad_mcp/bridge/embedded.py</code> <pre><code>    async def open_document(self, path: str) -&gt; DocumentInfo:\n        \"\"\"Open an existing document.\n\n        Args:\n            path: Path to the .FCStd file.\n\n        Returns:\n            DocumentInfo for the opened document.\n\n        Raises:\n            FileNotFoundError: If file doesn't exist.\n            ValueError: If file is not a valid FreeCAD document.\n        \"\"\"\n        if not Path(path).exists():\n            msg = f\"File not found: {path}\"\n            raise FileNotFoundError(msg)\n\n        result = await self.execute_python(\n            f\"\"\"\ndoc = FreeCAD.openDocument({path!r})\n_result_ = {{\n    \"name\": doc.Name,\n    \"label\": doc.Label,\n    \"path\": doc.FileName or None,\n    \"objects\": [obj.Name for obj in doc.Objects],\n    \"is_modified\": doc.Modified if hasattr(doc, \"Modified\") else False,\n}}\n\"\"\"\n        )\n\n        if result.success and result.result:\n            return DocumentInfo(**result.result)\n\n        error_msg = result.error_traceback or \"Failed to open document\"\n        raise ValueError(error_msg)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.embedded.EmbeddedBridge.ping","title":"<code>ping()</code>  <code>async</code>","text":"<p>Ping FreeCAD to check connection and measure latency.</p> <p>Returns:</p> Type Description <code>float</code> <p>Round-trip time in milliseconds.</p> <p>Raises:</p> Type Description <code>ConnectionError</code> <p>If not connected.</p> Source code in <code>src/freecad_mcp/bridge/embedded.py</code> <pre><code>async def ping(self) -&gt; float:\n    \"\"\"Ping FreeCAD to check connection and measure latency.\n\n    Returns:\n        Round-trip time in milliseconds.\n\n    Raises:\n        ConnectionError: If not connected.\n    \"\"\"\n    if not self._connected:\n        msg = \"Not connected to FreeCAD\"\n        raise ConnectionError(msg)\n\n    start = time.perf_counter()\n    result = await self.execute_python(\"_result_ = True\")\n    elapsed = (time.perf_counter() - start) * 1000\n\n    if not result.success:\n        msg = \"Ping failed\"\n        raise ConnectionError(msg)\n\n    return elapsed\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.embedded.EmbeddedBridge.run_macro","title":"<code>run_macro(macro_name, args=None)</code>  <code>async</code>","text":"<p>Run a macro by name.</p> <p>Parameters:</p> Name Type Description Default <code>macro_name</code> <code>str</code> <p>Macro name (without .FCMacro extension).</p> required <code>args</code> <code>dict[str, Any] | None</code> <p>Arguments to pass to the macro.</p> <code>None</code> <p>Returns:</p> Type Description <code>ExecutionResult</code> <p>ExecutionResult from macro execution.</p> Source code in <code>src/freecad_mcp/bridge/embedded.py</code> <pre><code>async def run_macro(\n    self,\n    macro_name: str,\n    args: dict[str, Any] | None = None,\n) -&gt; ExecutionResult:\n    \"\"\"Run a macro by name.\n\n    Args:\n        macro_name: Macro name (without .FCMacro extension).\n        args: Arguments to pass to the macro.\n\n    Returns:\n        ExecutionResult from macro execution.\n    \"\"\"\n    macro_path = self._get_macro_path() / f\"{macro_name}.FCMacro\"\n\n    if not macro_path.exists():\n        return ExecutionResult(\n            success=False,\n            result=None,\n            stdout=\"\",\n            stderr=f\"Macro not found: {macro_name}\",\n            execution_time_ms=0,\n            error_type=\"FileNotFoundError\",\n        )\n\n    try:\n        macro_code = macro_path.read_text()\n    except Exception as e:\n        return ExecutionResult(\n            success=False,\n            result=None,\n            stdout=\"\",\n            stderr=f\"Failed to read macro: {e}\",\n            execution_time_ms=0,\n            error_type=type(e).__name__,\n        )\n\n    # Prepend argument setup if provided\n    if args:\n        args_setup = \"\\n\".join(f\"{k} = {v!r}\" for k, v in args.items())\n        macro_code = args_setup + \"\\n\" + macro_code\n\n    return await self.execute_python(macro_code)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.embedded.EmbeddedBridge.save_document","title":"<code>save_document(doc_name=None, path=None)</code>  <code>async</code>","text":"<p>Save a document.</p> <p>Parameters:</p> Name Type Description Default <code>doc_name</code> <code>str | None</code> <p>Document name (uses active if None).</p> <code>None</code> <code>path</code> <code>str | None</code> <p>Save path (uses existing path if None).</p> <code>None</code> <p>Returns:</p> Type Description <code>str</code> <p>Path where document was saved.</p> <p>Raises:</p> Type Description <code>ValueError</code> <p>If document not found or no path specified for new doc.</p> Source code in <code>src/freecad_mcp/bridge/embedded.py</code> <pre><code>    async def save_document(\n        self,\n        doc_name: str | None = None,\n        path: str | None = None,\n    ) -&gt; str:\n        \"\"\"Save a document.\n\n        Args:\n            doc_name: Document name (uses active if None).\n            path: Save path (uses existing path if None).\n\n        Returns:\n            Path where document was saved.\n\n        Raises:\n            ValueError: If document not found or no path specified for new doc.\n        \"\"\"\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No active document\" if {doc_name!r} is None else f\"Document not found: {doc_name!r}\")\n\nsave_path = {path!r} or doc.FileName\nif not save_path:\n    raise ValueError(\"No path specified for new document\")\n\ndoc.saveAs(save_path)\n_result_ = save_path\n\"\"\"\n\n        result = await self.execute_python(code)\n\n        if result.success and result.result:\n            return result.result\n\n        error_msg = result.error_traceback or \"Failed to save document\"\n        raise ValueError(error_msg)\n</code></pre>"},{"location":"api/bridge/#freecad_mcp.bridge.embedded.EmbeddedBridge.set_view","title":"<code>set_view(view_angle, doc_name=None)</code>  <code>async</code>","text":"<p>Set the 3D view angle.</p> <p>Parameters:</p> Name Type Description Default <code>view_angle</code> <code>ViewAngle</code> <p>View angle to set.</p> required <code>doc_name</code> <code>str | None</code> <p>Document name (uses active if None).</p> <code>None</code> Source code in <code>src/freecad_mcp/bridge/embedded.py</code> <pre><code>    async def set_view(\n        self,\n        view_angle: ViewAngle,\n        doc_name: str | None = None,\n    ) -&gt; None:\n        \"\"\"Set the 3D view angle.\n\n        Args:\n            view_angle: View angle to set.\n            doc_name: Document name (uses active if None).\n        \"\"\"\n        gui_available = await self.is_gui_available()\n\n        if not gui_available:\n            return  # Silently ignore in headless mode\n\n        view_angle_str = view_angle.value\n        code = f\"\"\"\ndoc = FreeCAD.ActiveDocument if {doc_name!r} is None else FreeCAD.getDocument({doc_name!r})\nif doc is None:\n    raise ValueError(\"No document found\")\n\nview = FreeCADGui.ActiveDocument.ActiveView\nif view is None:\n    raise ValueError(\"No active view\")\n\nview_type = {view_angle_str!r}\nif view_type == \"FitAll\":\n    view.fitAll()\nelif view_type == \"Isometric\":\n    view.viewIsometric()\nelif view_type == \"Front\":\n    view.viewFront()\nelif view_type == \"Back\":\n    view.viewRear()\nelif view_type == \"Top\":\n    view.viewTop()\nelif view_type == \"Bottom\":\n    view.viewBottom()\nelif view_type == \"Left\":\n    view.viewLeft()\nelif view_type == \"Right\":\n    view.viewRight()\n\n_result_ = True\n\"\"\"\n        await self.execute_python(code)\n</code></pre>"},{"location":"api/config/","title":"Config","text":""},{"location":"api/config/#configuration-api-reference","title":"Configuration API Reference","text":"<p>options: show_root_heading: true show_source: true</p>"},{"location":"api/config/#freecad_mcp.config","title":"<code>freecad_mcp.config</code>","text":"<p>Configuration management for FreeCAD Robust MCP Server.</p> <p>This module handles all configuration settings for the Robust MCP Server, including FreeCAD connection settings, execution limits, and logging.</p>"},{"location":"api/config/#freecad_mcp.config-classes","title":"Classes","text":""},{"location":"api/config/#freecad_mcp.config.FreecadMode","title":"<code>FreecadMode</code>","text":"<p>               Bases: <code>str</code>, <code>Enum</code></p> <p>FreeCAD connection mode.</p> Source code in <code>src/freecad_mcp/config.py</code> <pre><code>class FreecadMode(str, Enum):\n    \"\"\"FreeCAD connection mode.\"\"\"\n\n    EMBEDDED = \"embedded\"\n    SOCKET = \"socket\"\n    XMLRPC = \"xmlrpc\"\n</code></pre>"},{"location":"api/config/#freecad_mcp.config.ServerConfig","title":"<code>ServerConfig</code>","text":"<p>               Bases: <code>BaseSettings</code></p> <p>Configuration for the FreeCAD Robust MCP Server.</p> <p>Settings are loaded from environment variables with the FREECAD_ prefix. For example, FREECAD_MODE sets the mode field.</p> <p>Attributes:</p> Name Type Description <code>mode</code> <code>FreecadMode</code> <p>Connection mode - 'embedded', 'socket', or 'xmlrpc'.</p> <code>freecad_path</code> <code>Annotated[Path | None, Field(description=\"Path to FreeCAD's lib directory\", alias=FREECAD_PATH)]</code> <p>Path to FreeCAD's lib directory (for embedded mode).</p> <code>socket_host</code> <code>Annotated[str, Field(description='Socket/XML-RPC server hostname')]</code> <p>Hostname for socket/xmlrpc connection.</p> <code>socket_port</code> <code>Annotated[int, Field(ge=1, le=65535, description='Socket server port (JSON-RPC)')]</code> <p>Port for JSON-RPC socket connection (default 9876).</p> <code>xmlrpc_port</code> <code>Annotated[int, Field(ge=1, le=65535, description='XML-RPC server port (neka-nat compatible)')]</code> <p>Port for XML-RPC connection (default 9875, neka-nat compatible).</p> <code>timeout_ms</code> <code>Annotated[int, Field(ge=1000, le=600000, description='Execution timeout in ms')]</code> <p>Default execution timeout in milliseconds.</p> <code>max_output_size</code> <code>Annotated[int, Field(ge=1000, description='Maximum output size in bytes')]</code> <p>Maximum output size in bytes.</p> <code>transport</code> <code>TransportType</code> <p>MCP transport type.</p> <code>http_port</code> <code>Annotated[int, Field(ge=1, le=65535, description='HTTP server port')]</code> <p>Port for HTTP transport.</p> <code>log_level</code> <code>str</code> <p>Logging level.</p> Source code in <code>src/freecad_mcp/config.py</code> <pre><code>class ServerConfig(BaseSettings):\n    \"\"\"Configuration for the FreeCAD Robust MCP Server.\n\n    Settings are loaded from environment variables with the FREECAD_ prefix.\n    For example, FREECAD_MODE sets the mode field.\n\n    Attributes:\n        mode: Connection mode - 'embedded', 'socket', or 'xmlrpc'.\n        freecad_path: Path to FreeCAD's lib directory (for embedded mode).\n        socket_host: Hostname for socket/xmlrpc connection.\n        socket_port: Port for JSON-RPC socket connection (default 9876).\n        xmlrpc_port: Port for XML-RPC connection (default 9875, neka-nat compatible).\n        timeout_ms: Default execution timeout in milliseconds.\n        max_output_size: Maximum output size in bytes.\n        transport: MCP transport type.\n        http_port: Port for HTTP transport.\n        log_level: Logging level.\n    \"\"\"\n\n    model_config = SettingsConfigDict(\n        env_prefix=\"FREECAD_\",\n        env_file=\".env\",\n        env_file_encoding=\"utf-8\",\n        case_sensitive=False,\n    )\n\n    # FreeCAD connection settings\n    mode: FreecadMode = FreecadMode.EMBEDDED\n    freecad_path: Annotated[\n        Path | None,\n        Field(\n            description=\"Path to FreeCAD's lib directory\",\n            alias=\"FREECAD_PATH\",\n        ),\n    ] = None\n\n    # Socket settings (for socket mode)\n    socket_host: Annotated[\n        str,\n        Field(description=\"Socket/XML-RPC server hostname\"),\n    ] = \"localhost\"\n    socket_port: Annotated[\n        int,\n        Field(ge=1, le=65535, description=\"Socket server port (JSON-RPC)\"),\n    ] = 9876\n    xmlrpc_port: Annotated[\n        int,\n        Field(ge=1, le=65535, description=\"XML-RPC server port (neka-nat compatible)\"),\n    ] = 9875\n\n    # Execution limits\n    timeout_ms: Annotated[\n        int,\n        Field(ge=1000, le=600000, description=\"Execution timeout in ms\"),\n    ] = 30000\n    max_output_size: Annotated[\n        int,\n        Field(ge=1000, description=\"Maximum output size in bytes\"),\n    ] = 1_000_000\n\n    # MCP transport settings\n    transport: TransportType = TransportType.STDIO\n    http_port: Annotated[\n        int,\n        Field(ge=1, le=65535, description=\"HTTP server port\"),\n    ] = 8000\n\n    # Logging\n    log_level: str = \"INFO\"\n\n    # Security settings\n    enable_sandbox: bool = True\n    allow_file_access: bool = True\n    allow_network_access: bool = False\n</code></pre>"},{"location":"api/config/#freecad_mcp.config.TransportType","title":"<code>TransportType</code>","text":"<p>               Bases: <code>str</code>, <code>Enum</code></p> <p>MCP transport type.</p> Source code in <code>src/freecad_mcp/config.py</code> <pre><code>class TransportType(str, Enum):\n    \"\"\"MCP transport type.\"\"\"\n\n    STDIO = \"stdio\"\n    HTTP = \"http\"\n</code></pre>"},{"location":"api/config/#freecad_mcp.config-functions","title":"Functions","text":""},{"location":"api/config/#freecad_mcp.config.get_config","title":"<code>get_config()</code>","text":"<p>Get the server configuration.</p> <p>Returns:</p> Type Description <code>ServerConfig</code> <p>ServerConfig instance populated from environment variables.</p> Source code in <code>src/freecad_mcp/config.py</code> <pre><code>def get_config() -&gt; ServerConfig:\n    \"\"\"Get the server configuration.\n\n    Returns:\n        ServerConfig instance populated from environment variables.\n    \"\"\"\n    return ServerConfig()\n</code></pre>"},{"location":"api/server/","title":"Server","text":""},{"location":"api/server/#server-api-reference","title":"Server API Reference","text":"<p>options: show_root_heading: true show_source: true members: - mcp - get_bridge - startup - shutdown</p>"},{"location":"api/server/#freecad_mcp.server","title":"<code>freecad_mcp.server</code>","text":"<p>FreeCAD Robust MCP Server - Main entry point.</p> <p>This module provides the main Robust MCP Server implementation for FreeCAD integration with AI assistants (Claude, GPT, and other MCP-compatible tools). It exposes tools, resources, and prompts for interacting with FreeCAD.</p> Features <ul> <li>Full Python console access (GUI and headless modes)</li> <li>Document and object management</li> <li>PartDesign workflow (sketches, pads, pockets, fillets)</li> <li>Import/export (STEP, STL, OBJ, IGES)</li> <li>Macro management</li> <li>Screenshot capture</li> <li>Multiple connection modes (embedded, XML-RPC, socket)</li> </ul> Example <p>Run as a module::</p> <pre><code>$ python -m freecad_mcp.server\n</code></pre> <p>Or use the installed command::</p> <pre><code>$ freecad-mcp\n</code></pre> <p>With environment variables::</p> <pre><code>$ FREECAD_MODE=socket FREECAD_SOCKET_HOST=localhost freecad-mcp\n</code></pre> <p>Show help::</p> <pre><code>$ freecad-mcp --help\n</code></pre>"},{"location":"api/server/#freecad_mcp.server-classes","title":"Classes","text":""},{"location":"api/server/#freecad_mcp.server-functions","title":"Functions","text":""},{"location":"api/server/#freecad_mcp.server.apply_cli_args_to_env","title":"<code>apply_cli_args_to_env(args)</code>","text":"<p>Apply CLI arguments as environment variables.</p> <p>CLI arguments override existing environment variables.</p> <p>Parameters:</p> Name Type Description Default <code>args</code> <code>Namespace</code> <p>Parsed command-line arguments.</p> required Source code in <code>src/freecad_mcp/server.py</code> <pre><code>def apply_cli_args_to_env(args: argparse.Namespace) -&gt; None:\n    \"\"\"Apply CLI arguments as environment variables.\n\n    CLI arguments override existing environment variables.\n\n    Args:\n        args: Parsed command-line arguments.\n    \"\"\"\n    import os\n\n    if args.mode:\n        os.environ[\"FREECAD_MODE\"] = args.mode\n    if args.transport:\n        os.environ[\"FREECAD_TRANSPORT\"] = args.transport\n    if args.host:\n        os.environ[\"FREECAD_SOCKET_HOST\"] = args.host\n    if args.port:\n        # Set appropriate port based on mode\n        mode = os.environ.get(\"FREECAD_MODE\", \"xmlrpc\")\n        if mode == \"xmlrpc\":\n            os.environ[\"FREECAD_XMLRPC_PORT\"] = str(args.port)\n        else:\n            os.environ[\"FREECAD_SOCKET_PORT\"] = str(args.port)\n    if args.http_port:\n        os.environ[\"FREECAD_HTTP_PORT\"] = str(args.http_port)\n    if args.log_level:\n        os.environ[\"FREECAD_LOG_LEVEL\"] = args.log_level\n</code></pre>"},{"location":"api/server/#freecad_mcp.server.check_freecad_connection","title":"<code>check_freecad_connection(mode=None, host=None, port=None)</code>  <code>async</code>","text":"<p>Test FreeCAD bridge connection.</p> <p>Parameters:</p> Name Type Description Default <code>mode</code> <code>str | None</code> <p>Connection mode override (xmlrpc, socket, embedded).</p> <code>None</code> <code>host</code> <code>str | None</code> <p>Host override for connection.</p> <code>None</code> <code>port</code> <code>int | None</code> <p>Port override for connection.</p> <code>None</code> <p>Returns:</p> Type Description <code>bool</code> <p>True if connection successful, False otherwise.</p> Source code in <code>src/freecad_mcp/server.py</code> <pre><code>async def check_freecad_connection(\n    mode: str | None = None, host: str | None = None, port: int | None = None\n) -&gt; bool:\n    \"\"\"Test FreeCAD bridge connection.\n\n    Args:\n        mode: Connection mode override (xmlrpc, socket, embedded).\n        host: Host override for connection.\n        port: Port override for connection.\n\n    Returns:\n        True if connection successful, False otherwise.\n    \"\"\"\n    import os\n\n    # Apply overrides to env\n    if mode:\n        os.environ[\"FREECAD_MODE\"] = mode\n    if host:\n        os.environ[\"FREECAD_SOCKET_HOST\"] = host\n    if port:\n        mode_val = mode or os.environ.get(\"FREECAD_MODE\", \"xmlrpc\")\n        if mode_val == \"xmlrpc\":\n            os.environ[\"FREECAD_XMLRPC_PORT\"] = str(port)\n        else:\n            os.environ[\"FREECAD_SOCKET_PORT\"] = str(port)\n\n    config = get_config()\n    print(f\"Testing connection to FreeCAD ({config.mode.value} mode)...\")\n\n    try:\n        bridge: FreecadBridge\n        if config.mode == FreecadMode.EMBEDDED:\n            from freecad_mcp.bridge.embedded import EmbeddedBridge\n\n            bridge = EmbeddedBridge(\n                freecad_path=(\n                    str(config.freecad_path) if config.freecad_path else None\n                ),\n            )\n        elif config.mode == FreecadMode.XMLRPC:\n            from freecad_mcp.bridge.xmlrpc import XmlRpcBridge\n\n            bridge = XmlRpcBridge(\n                host=config.socket_host,\n                port=config.xmlrpc_port,\n            )\n            print(f\"  Host: {config.socket_host}:{config.xmlrpc_port}\")\n        else:\n            from freecad_mcp.bridge.socket import SocketBridge\n\n            bridge = SocketBridge(\n                host=config.socket_host,\n                port=config.socket_port,\n            )\n            print(f\"  Host: {config.socket_host}:{config.socket_port}\")\n\n        await bridge.connect()\n        version_info = await bridge.get_freecad_version()\n        await bridge.disconnect()\n\n        print(\"\u2713 Connection successful!\")\n        print(f\"  FreeCAD version: {version_info.get('version', 'unknown')}\")\n        print(f\"  GUI available: {version_info.get('gui_available', 'unknown')}\")\n        return True\n    except Exception as e:\n        print(f\"\u2717 Connection failed: {e}\")\n        return False\n</code></pre>"},{"location":"api/server/#freecad_mcp.server.get_bridge","title":"<code>get_bridge()</code>  <code>async</code>","text":"<p>Get the active FreeCAD bridge.</p> <p>Returns:</p> Type Description <code>FreecadBridge</code> <p>The active FreecadBridge instance.</p> <p>Raises:</p> Type Description <code>RuntimeError</code> <p>If bridge is not initialized.</p> Source code in <code>src/freecad_mcp/server.py</code> <pre><code>async def get_bridge() -&gt; \"FreecadBridge\":\n    \"\"\"Get the active FreeCAD bridge.\n\n    Returns:\n        The active FreecadBridge instance.\n\n    Raises:\n        RuntimeError: If bridge is not initialized.\n    \"\"\"\n    if _bridge is None:\n        msg = \"FreeCAD bridge not initialized\"\n        raise RuntimeError(msg)\n    return _bridge\n</code></pre>"},{"location":"api/server/#freecad_mcp.server.get_instance_id","title":"<code>get_instance_id()</code>","text":"<p>Get the unique instance ID for this Robust MCP Server process.</p> <p>Returns:</p> Type Description <code>str</code> <p>The UUID string that uniquely identifies this server instance.</p> Source code in <code>src/freecad_mcp/server.py</code> <pre><code>def get_instance_id() -&gt; str:\n    \"\"\"Get the unique instance ID for this Robust MCP Server process.\n\n    Returns:\n        The UUID string that uniquely identifies this server instance.\n    \"\"\"\n    return INSTANCE_ID\n</code></pre>"},{"location":"api/server/#freecad_mcp.server.lifespan","title":"<code>lifespan(_server)</code>  <code>async</code>","text":"<p>Manage FreeCAD bridge lifecycle.</p> <p>This async context manager initializes the FreeCAD bridge on startup and disconnects it on shutdown.</p> <p>Parameters:</p> Name Type Description Default <code>_server</code> <code>FastMCP</code> <p>The FastMCP server instance (unused).</p> required <p>Yields:</p> Type Description <code>AsyncIterator[None]</code> <p>None - the bridge is stored in the global _bridge variable.</p> Source code in <code>src/freecad_mcp/server.py</code> <pre><code>@asynccontextmanager\nasync def lifespan(_server: FastMCP) -&gt; AsyncIterator[None]:\n    \"\"\"Manage FreeCAD bridge lifecycle.\n\n    This async context manager initializes the FreeCAD bridge on startup\n    and disconnects it on shutdown.\n\n    Args:\n        _server: The FastMCP server instance (unused).\n\n    Yields:\n        None - the bridge is stored in the global _bridge variable.\n    \"\"\"\n    global _bridge\n    config = get_config()\n\n    logger.info(\"Initializing FreeCAD bridge...\")\n\n    if config.mode == FreecadMode.EMBEDDED:\n        from freecad_mcp.bridge.embedded import EmbeddedBridge\n\n        _bridge = EmbeddedBridge(\n            freecad_path=str(config.freecad_path) if config.freecad_path else None,\n        )\n        logger.info(\"Using embedded bridge (headless mode)\")\n\n    elif config.mode == FreecadMode.XMLRPC:\n        from freecad_mcp.bridge.xmlrpc import XmlRpcBridge\n\n        _bridge = XmlRpcBridge(\n            host=config.socket_host,\n            port=config.xmlrpc_port,\n        )\n        logger.info(\n            \"Using XML-RPC bridge: %s:%d\", config.socket_host, config.xmlrpc_port\n        )\n\n    else:  # SOCKET mode\n        from freecad_mcp.bridge.socket import SocketBridge\n\n        _bridge = SocketBridge(\n            host=config.socket_host,\n            port=config.socket_port,\n        )\n        logger.info(\n            \"Using socket bridge: %s:%d\", config.socket_host, config.socket_port\n        )\n\n    await _bridge.connect()\n    logger.info(\"FreeCAD bridge connected\")\n\n    # Log FreeCAD version\n    try:\n        version = await _bridge.get_freecad_version()\n        logger.info(\n            \"FreeCAD %s (GUI: %s)\",\n            version.get(\"version\", \"unknown\"),\n            \"available\" if version.get(\"gui_available\") else \"headless\",\n        )\n    except Exception as e:\n        logger.warning(\"Could not get FreeCAD version: %s\", e)\n\n    try:\n        yield\n    finally:\n        # Shutdown\n        if _bridge:\n            logger.info(\"Disconnecting FreeCAD bridge...\")\n            await _bridge.disconnect()\n            _bridge = None\n</code></pre>"},{"location":"api/server/#freecad_mcp.server.main","title":"<code>main()</code>","text":"<p>Run the FreeCAD Robust MCP Server.</p> Source code in <code>src/freecad_mcp/server.py</code> <pre><code>def main() -&gt; None:\n    \"\"\"Run the FreeCAD Robust MCP Server.\"\"\"\n    # Parse arguments first - this handles --help without connecting to FreeCAD\n    args = parse_args()\n\n    # Handle --version\n    if args.version:\n        try:\n            from importlib.metadata import version\n\n            ver = version(\"freecad-mcp\")\n        except Exception:\n            ver = \"unknown\"\n        print(f\"freecad-mcp {ver}\")\n        print(f\"Instance ID: {INSTANCE_ID}\")\n        sys.exit(0)\n\n    # Handle --check (test connection without starting MCP server)\n    if args.check:\n        import asyncio\n\n        success = asyncio.run(\n            check_freecad_connection(mode=args.mode, host=args.host, port=args.port)\n        )\n        sys.exit(0 if success else 1)\n\n    # Apply CLI arguments as environment variables (they override existing ones)\n    apply_cli_args_to_env(args)\n\n    # Now get config (which reads from environment)\n    config = get_config()\n\n    # Set up logging\n    logging.getLogger().setLevel(config.log_level)\n\n    # Print instance ID to stderr for test automation to capture\n    # Must use stderr because stdout is reserved for JSON-RPC in stdio mode\n    print(f\"FREECAD_MCP_INSTANCE_ID={INSTANCE_ID}\", file=sys.stderr, flush=True)\n\n    logger.info(\"Starting FreeCAD Robust MCP Server\")\n    logger.info(\"Instance ID: %s\", INSTANCE_ID)\n    logger.info(\"Mode: %s\", config.mode.value)\n    logger.info(\"Transport: %s\", config.transport.value)\n\n    # Run the server\n    if config.transport == TransportType.HTTP:\n        logger.info(\"Starting HTTP transport on port %d\", config.http_port)\n        mcp.run(  # type: ignore[call-arg]\n            transport=\"streamable-http\",\n            host=\"0.0.0.0\",  # noqa: S104\n            port=config.http_port,\n        )\n    else:\n        logger.info(\"Starting stdio transport\")\n        logger.info(\n            \"Waiting for MCP client connection (FreeCAD connection tested on first request)...\"\n        )\n        logger.info(\n            \"Tip: Use 'freecad-mcp --check' to test FreeCAD connection directly\"\n        )\n        mcp.run()\n</code></pre>"},{"location":"api/server/#freecad_mcp.server.parse_args","title":"<code>parse_args()</code>","text":"<p>Parse command-line arguments.</p> <p>Returns:</p> Type Description <code>Namespace</code> <p>Parsed arguments namespace.</p> Source code in <code>src/freecad_mcp/server.py</code> <pre><code>def parse_args() -&gt; argparse.Namespace:\n    \"\"\"Parse command-line arguments.\n\n    Returns:\n        Parsed arguments namespace.\n    \"\"\"\n    parser = argparse.ArgumentParser(\n        prog=\"freecad-mcp\",\n        description=\"FreeCAD Robust MCP Server - Connect AI assistants to FreeCAD\",\n        formatter_class=argparse.RawDescriptionHelpFormatter,\n        epilog=\"\"\"\nEnvironment Variables:\n  FREECAD_MODE           Connection mode: xmlrpc, socket, or embedded\n                         (default: xmlrpc)\n  FREECAD_SOCKET_HOST    Host for socket/XML-RPC connection (default: localhost)\n  FREECAD_SOCKET_PORT    Port for socket connection (default: 9876)\n  FREECAD_XMLRPC_PORT    Port for XML-RPC connection (default: 9875)\n  FREECAD_TRANSPORT      Transport type: stdio or http (default: stdio)\n  FREECAD_HTTP_PORT      Port for HTTP transport (default: 8000)\n  FREECAD_LOG_LEVEL      Logging level: DEBUG, INFO, WARNING, ERROR\n                         (default: INFO)\n\nExamples:\n  # Start with default settings (XML-RPC mode, stdio transport)\n  freecad-mcp\n\n  # Use socket mode\n  FREECAD_MODE=socket freecad-mcp\n\n  # Use HTTP transport for remote access\n  FREECAD_TRANSPORT=http FREECAD_HTTP_PORT=8080 freecad-mcp\n\n  # Connect to remote FreeCAD instance\n  FREECAD_SOCKET_HOST=192.168.1.100 freecad-mcp\n\nPrerequisites:\n  The FreeCAD Robust MCP Bridge must be running before starting this server.\n  Start it via:\n    - FreeCAD GUI: Install Robust MCP Bridge workbench, enable auto-start\n    - Headless: just freecad::run-headless\n    - Development: just freecad::run-gui\n\"\"\",\n    )\n\n    parser.add_argument(\n        \"--version\",\n        action=\"store_true\",\n        help=\"Show version information and exit\",\n    )\n\n    parser.add_argument(\n        \"--check\",\n        action=\"store_true\",\n        help=\"Test FreeCAD connection and exit (doesn't start MCP server)\",\n    )\n\n    parser.add_argument(\n        \"--mode\",\n        choices=[\"xmlrpc\", \"socket\", \"embedded\"],\n        help=\"Connection mode (overrides FREECAD_MODE env var)\",\n    )\n\n    parser.add_argument(\n        \"--transport\",\n        choices=[\"stdio\", \"http\"],\n        help=\"Transport type (overrides FREECAD_TRANSPORT env var)\",\n    )\n\n    parser.add_argument(\n        \"--host\",\n        help=\"Host for FreeCAD connection (overrides FREECAD_SOCKET_HOST)\",\n    )\n\n    parser.add_argument(\n        \"--port\",\n        type=int,\n        help=\"Port for FreeCAD connection (mode-dependent)\",\n    )\n\n    parser.add_argument(\n        \"--http-port\",\n        type=int,\n        help=\"Port for HTTP transport (overrides FREECAD_HTTP_PORT)\",\n    )\n\n    parser.add_argument(\n        \"--log-level\",\n        choices=[\"DEBUG\", \"INFO\", \"WARNING\", \"ERROR\"],\n        help=\"Logging level (overrides FREECAD_LOG_LEVEL)\",\n    )\n\n    return parser.parse_args()\n</code></pre>"},{"location":"api/server/#freecad_mcp.server.register_all_components","title":"<code>register_all_components()</code>","text":"<p>Register all MCP components (tools, resources, prompts).</p> Source code in <code>src/freecad_mcp/server.py</code> <pre><code>def register_all_components() -&gt; None:\n    \"\"\"Register all MCP components (tools, resources, prompts).\"\"\"\n    # Register tools\n    from freecad_mcp.tools import register_all_tools\n\n    register_all_tools(mcp, get_bridge)\n\n    # Register resources\n    from freecad_mcp.resources import register_resources\n\n    register_resources(mcp, get_bridge)\n\n    # Register prompts\n    from freecad_mcp.prompts import register_prompts\n\n    register_prompts(mcp, get_bridge)\n</code></pre>"},{"location":"development/architecture-detailed/","title":"Detailed Architecture","text":""},{"location":"development/architecture-detailed/#freecad-robust-mcp-server-architecture","title":"FreeCAD Robust MCP Server Architecture","text":""},{"location":"development/architecture-detailed/#executive-summary","title":"Executive Summary","text":"<p>This document describes the architecture for a Model Context Protocol (MCP) server that enables tight integration between AI assistants (Claude, GPT, and other MCP-compatible tools) and FreeCAD. The server provides AI assistants with full access to FreeCAD's Python console capabilities in both GUI and headless modes, enabling AI-assisted development and debugging of models, macros, and workbenches.</p>"},{"location":"development/architecture-detailed/#table-of-contents","title":"Table of Contents","text":"<ul> <li>FreeCAD Robust MCP Server Architecture</li> <li>Executive Summary</li> <li>Table of Contents</li> <li>Competitive Analysis<ul> <li>Existing FreeCAD Robust MCP Servers</li> <li>Our Differentiators</li> <li>Key Learnings Applied</li> </ul> </li> <li>System Overview<ul> <li>What is MCP?</li> <li>What is FreeCAD?</li> <li>Integration Vision</li> </ul> </li> <li>Architecture Goals<ul> <li>Primary Goals</li> <li>Secondary Goals</li> </ul> </li> <li>High-Level Architecture<ul> <li>Architecture Pattern: Bridge with Adapter</li> <li>Module Structure</li> </ul> </li> <li>Component Design<ul> <li>1. MCP Server (<code>server.py</code>)</li> <li>2. Bridge Interface (<code>bridge/base.py</code>)</li> <li>3. Embedded Bridge (<code>bridge/embedded.py</code>)</li> <li>4. Socket Bridge (<code>bridge/socket.py</code>)</li> <li>5. FreeCAD Plugin (<code>freecad_plugin/server.py</code>)</li> </ul> </li> <li>MCP Tools Specification<ul> <li>Core Execution Tools</li> <li><code>execute_python</code></li> <li><code>execute_macro</code></li> <li>Document Management Tools</li> <li><code>create_document</code></li> <li><code>open_document</code></li> <li><code>save_document</code></li> <li>Object Creation Tools</li> <li><code>create_primitive</code></li> <li><code>create_sketch</code></li> <li>Geometry Tools</li> <li><code>add_sketch_geometry</code></li> <li><code>boolean_operation</code></li> <li>Export/Import Tools</li> <li><code>export_mesh</code></li> <li><code>export_step</code></li> <li>Debugging Tools</li> <li><code>inspect_object</code></li> <li><code>validate_model</code></li> <li>Workbench Tools</li> <li><code>activate_workbench</code></li> <li><code>list_workbench_commands</code></li> </ul> </li> <li>MCP Resources Specification<ul> <li>Document Resources</li> <li>Console Resources</li> <li>Environment Resources</li> </ul> </li> <li>Communication Patterns<ul> <li>Pattern 1: Stdio Transport (Default for MCP Clients)</li> <li>Pattern 2: HTTP Transport (Remote/Shared)</li> <li>Pattern 3: GUI Integration</li> </ul> </li> <li>Security Considerations<ul> <li>Code Execution Sandboxing</li> <li>Resource Limits</li> <li>Authentication (for HTTP transport)</li> </ul> </li> <li>Deployment Modes<ul> <li>Mode 1: XML-RPC Mode (Recommended)</li> <li>Mode 2: Local Embedded (Linux Only)</li> <li>Mode 3: Local GUI with Plugin</li> <li>Mode 4: Remote/Docker</li> </ul> </li> <li>Error Handling<ul> <li>Error Categories</li> <li>Error Response Format</li> </ul> </li> <li>Future Extensibility<ul> <li>Planned Features</li> <li>Extension Points</li> </ul> </li> <li>Summary</li> </ul>"},{"location":"development/architecture-detailed/#competitive-analysis","title":"Competitive Analysis","text":"<p>See COMPARISON.md for detailed analysis of existing implementations.</p>"},{"location":"development/architecture-detailed/#existing-freecad-robust-mcp-servers","title":"Existing FreeCAD Robust MCP Servers","text":"Project Stars Approach Strengths neka-nat/freecad-mcp 380+ XML-RPC Thread-safe GUI ops, screenshots, parts library jango-blockchained/mcp-freecad - Multi-mode 6 connection modes, multi-AI, connection recovery contextform/freecad-mcp - Node.js bridge 31+ CAD operations, installer, demos ATOI-Ming/FreeCAD-MCP - Macro-centric GUI panel, macro templates, validation bonninr/freecad_mcp - Simple socket Minimal, lightweight"},{"location":"development/architecture-detailed/#our-differentiators","title":"Our Differentiators","text":"<ol> <li>True Headless Mode: Embedded bridge runs FreeCAD in-process (unique)</li> <li>Dual Protocol: XML-RPC (compatibility) + JSON-RPC (modern)</li> <li>MCP Resources: Document/object introspection (no other impl has this)</li> <li>MCP Prompts: Guided workflow templates (unique)</li> <li>Developer Focus: Debugging tools, console access, macro development</li> <li>Thread-Safe Design: Queue-based GUI operations (learned from neka-nat)</li> <li>Connection Resilience: Auto-reconnect with health monitoring</li> </ol>"},{"location":"development/architecture-detailed/#key-learnings-applied","title":"Key Learnings Applied","text":"<ol> <li>From neka-nat: Queue-based GUI thread safety, smart screenshot handling</li> <li>From jango: Multiple connection modes, connection recovery</li> <li>From contextform: Comprehensive PartDesign/Part operations</li> <li>From ATOI-Ming: Macro templates, validation, automatic imports</li> </ol>"},{"location":"development/architecture-detailed/#system-overview","title":"System Overview","text":""},{"location":"development/architecture-detailed/#what-is-mcp","title":"What is MCP?","text":"<p>The Model Context Protocol (MCP) is a standardized protocol that allows LLM applications (like Claude Code, GPT-based tools, and other MCP clients) to interact with external systems through:</p> <ul> <li>Tools: Executable functions that perform actions (like POST endpoints)</li> <li>Resources: Data sources that provide context (like GET endpoints)</li> <li>Prompts: Reusable templates for LLM interactions</li> </ul>"},{"location":"development/architecture-detailed/#what-is-freecad","title":"What is FreeCAD?","text":"<p>FreeCAD is an open-source parametric 3D CAD modeler with:</p> <ul> <li>A comprehensive Python API for scripting</li> <li>GUI mode with interactive Python console</li> <li>Headless mode (<code>freecadcmd</code>) for batch processing</li> <li>Workbench architecture for domain-specific tools</li> <li>Full access to geometry, constraints, and document structure via Python</li> </ul>"},{"location":"development/architecture-detailed/#integration-vision","title":"Integration Vision","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                           Claude Code                                    \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502  User Request: \"Create a parametric gear with 20 teeth\"         \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                \u2502                                         \u2502\n\u2502                                \u25bc                                         \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502               MCP Client (Claude Code, GPT, etc.)                \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                 \u2502\n                     MCP Protocol (stdio/HTTP)\n                                 \u2502\n                                 \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      FreeCAD Robust MCP Server                                  \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                   \u2502\n\u2502  \u2502    Tools     \u2502  \u2502  Resources   \u2502  \u2502   Prompts    \u2502                   \u2502\n\u2502  \u2502 - execute_py \u2502  \u2502 - documents  \u2502  \u2502 - modeling   \u2502                   \u2502\n\u2502  \u2502 - create_obj \u2502  \u2502 - objects    \u2502  \u2502 - debugging  \u2502                   \u2502\n\u2502  \u2502 - export     \u2502  \u2502 - console    \u2502  \u2502 - macros     \u2502                   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                   \u2502\n\u2502                                \u2502                                         \u2502\n\u2502                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                            \u2502\n\u2502                    \u25bc                       \u25bc                            \u2502\n\u2502         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                    \u2502\n\u2502         \u2502  FreeCAD Bridge  \u2502    \u2502  FreeCAD Bridge  \u2502                    \u2502\n\u2502         \u2502   (GUI Mode)     \u2502    \u2502 (Headless Mode)  \u2502                    \u2502\n\u2502         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                 \u2502\n                                 \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                         FreeCAD Instance                                 \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502  Documents  \u2502  \u2502   Objects   \u2502  \u2502 Workbenches \u2502  \u2502   Macros    \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"development/architecture-detailed/#architecture-goals","title":"Architecture Goals","text":""},{"location":"development/architecture-detailed/#primary-goals","title":"Primary Goals","text":"<ol> <li>Full Python Console Access: Execute arbitrary Python code in FreeCAD's context</li> <li>Bidirectional Communication: Send commands and receive results/errors</li> <li>Dual Mode Support: Work with both GUI and headless FreeCAD instances</li> <li>Real-time Feedback: Stream console output and execution results</li> <li>Document Introspection: Query and understand FreeCAD document structure</li> <li>Safe Execution: Sandboxed execution with timeout and resource limits</li> </ol>"},{"location":"development/architecture-detailed/#secondary-goals","title":"Secondary Goals","text":"<ol> <li>Macro Development: Assist in writing, testing, and debugging macros</li> <li>Workbench Integration: Access workbench-specific functionality</li> <li>Model Validation: Check model integrity and constraints</li> <li>Export Capabilities: Generate various output formats (STEP, STL, etc.)</li> <li>Version Compatibility: Support FreeCAD 0.21+ and 1.0+</li> </ol>"},{"location":"development/architecture-detailed/#high-level-architecture","title":"High-Level Architecture","text":""},{"location":"development/architecture-detailed/#architecture-pattern-bridge-with-adapter","title":"Architecture Pattern: Bridge with Adapter","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                         MCP Server Layer                                 \u2502\n\u2502                                                                          \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502                     FastMCP Application                             \u2502 \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510           \u2502 \u2502\n\u2502  \u2502  \u2502 Tool     \u2502  \u2502 Resource \u2502  \u2502 Prompt   \u2502  \u2502 Lifecycle\u2502           \u2502 \u2502\n\u2502  \u2502  \u2502 Registry \u2502  \u2502 Registry \u2502  \u2502 Registry \u2502  \u2502 Manager  \u2502           \u2502 \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518           \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                    \u2502                                     \u2502\n\u2502                                    \u25bc                                     \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502                    FreeCAD Bridge Interface                         \u2502 \u2502\n\u2502  \u2502                    (Abstract Base Class)                            \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                    \u2571                               \u2572                     \u2502\n\u2502                   \u2571                                 \u2572                    \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u2502\n\u2502  \u2502   EmbeddedBridge            \u2502  \u2502   SocketBridge              \u2502      \u2502\n\u2502  \u2502   (In-process FreeCAD)      \u2502  \u2502   (Remote FreeCAD)          \u2502      \u2502\n\u2502  \u2502                             \u2502  \u2502                             \u2502      \u2502\n\u2502  \u2502 - Direct Python API access  \u2502  \u2502 - TCP/Unix socket comm      \u2502      \u2502\n\u2502  \u2502 - Headless mode only        \u2502  \u2502 - GUI or headless mode      \u2502      \u2502\n\u2502  \u2502 - Fastest execution         \u2502  \u2502 - Process isolation         \u2502      \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"development/architecture-detailed/#module-structure","title":"Module Structure","text":"<pre><code>freecad_mcp/\n\u251c\u2500\u2500 __init__.py\n\u251c\u2500\u2500 server.py                 # Main MCP server entry point\n\u251c\u2500\u2500 config.py                 # Configuration management\n\u2502\n\u251c\u2500\u2500 bridge/                   # FreeCAD communication layer\n\u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u251c\u2500\u2500 base.py              # Abstract bridge interface\n\u2502   \u251c\u2500\u2500 embedded.py          # In-process FreeCAD bridge (Linux only)\n\u2502   \u251c\u2500\u2500 socket.py            # JSON-RPC socket bridge\n\u2502   \u251c\u2500\u2500 xmlrpc.py            # XML-RPC bridge (recommended)\n\u2502   \u2514\u2500\u2500 protocol.py          # Wire protocol for socket communication\n\u2502\n\u251c\u2500\u2500 tools/                    # MCP tool implementations (82 tools)\n\u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u251c\u2500\u2500 execution.py         # Python execution &amp; debugging (4 tools)\n\u2502   \u251c\u2500\u2500 documents.py         # Document management (7 tools)\n\u2502   \u251c\u2500\u2500 objects.py           # Object creation/manipulation (12 tools)\n\u2502   \u251c\u2500\u2500 partdesign.py        # PartDesign parametric modeling (19 tools)\n\u2502   \u251c\u2500\u2500 view.py              # View, camera, display (11 tools)\n\u2502   \u251c\u2500\u2500 export.py            # Export/import operations (7 tools)\n\u2502   \u2514\u2500\u2500 macros.py            # Macro management (6 tools)\n\u2502\n\u251c\u2500\u2500 resources/                # MCP resource implementations\n\u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u2514\u2500\u2500 freecad.py           # Document, console, capabilities resources\n\u2502\n\u251c\u2500\u2500 prompts/                  # MCP prompt templates\n\u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u2514\u2500\u2500 freecad.py           # Modeling and debugging prompts\n\u2502\n\u251c\u2500\u2500 freecad_plugin/          # Plugin to install IN FreeCAD\n\u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u251c\u2500\u2500 server.py            # XML-RPC/JSON-RPC server\n\u2502   \u251c\u2500\u2500 handlers.py          # Request handlers\n\u2502   \u251c\u2500\u2500 blocking_bridge.py   # Blocking server (keeps FreeCAD running)\n\u2502   \u2514\u2500\u2500 startup_bridge.py    # Non-blocking startup (for interactive GUI)\n\u2502\n\u2514\u2500\u2500 utils/                    # Utility modules\n    \u2514\u2500\u2500 __init__.py\n</code></pre>"},{"location":"development/architecture-detailed/#component-design","title":"Component Design","text":""},{"location":"development/architecture-detailed/#1-mcp-server-serverpy","title":"1. MCP Server (<code>server.py</code>)","text":"<p>The main entry point using FastMCP from the official MCP Python SDK.</p> <pre><code>\"\"\"FreeCAD Robust MCP Server - Main entry point.\"\"\"\n\nfrom mcp.server.fastmcp import FastMCP\n\nfrom freecad_mcp.config import ServerConfig\nfrom freecad_mcp.bridge import create_bridge\nfrom freecad_mcp.tools import register_all_tools\nfrom freecad_mcp.resources import register_all_resources\nfrom freecad_mcp.prompts import register_all_prompts\n\nmcp = FastMCP(\n    name=\"freecad-mcp\",\n    version=\"0.1.0\",\n    description=\"MCP server for FreeCAD integration with AI assistants\"\n)\n\n# Bridge instance (initialized on startup)\nbridge = None\n\n@mcp.on_startup\nasync def startup():\n    \"\"\"Initialize FreeCAD bridge on server startup.\"\"\"\n    global bridge\n    config = ServerConfig.from_env()\n    bridge = await create_bridge(config)\n\n@mcp.on_shutdown\nasync def shutdown():\n    \"\"\"Clean up FreeCAD bridge on server shutdown.\"\"\"\n    if bridge:\n        await bridge.close()\n</code></pre>"},{"location":"development/architecture-detailed/#2-bridge-interface-bridgebasepy","title":"2. Bridge Interface (<code>bridge/base.py</code>)","text":"<p>Abstract interface for FreeCAD communication.</p> <pre><code>\"\"\"Abstract bridge interface for FreeCAD communication.\"\"\"\n\nfrom abc import ABC, abstractmethod\nfrom dataclasses import dataclass\nfrom typing import Any\n\n@dataclass\nclass ExecutionResult:\n    \"\"\"Result of Python code execution.\"\"\"\n    success: bool\n    result: Any\n    stdout: str\n    stderr: str\n    execution_time_ms: float\n    error_type: str | None = None\n    error_traceback: str | None = None\n\n@dataclass\nclass DocumentInfo:\n    \"\"\"Information about a FreeCAD document.\"\"\"\n    name: str\n    path: str | None\n    objects: list[str]\n    is_modified: bool\n\n@dataclass\nclass ObjectInfo:\n    \"\"\"Information about a FreeCAD object.\"\"\"\n    name: str\n    label: str\n    type_id: str\n    properties: dict[str, Any]\n    shape_info: dict[str, Any] | None\n    children: list[str]\n\nclass FreecadBridge(ABC):\n    \"\"\"Abstract base class for FreeCAD bridges.\"\"\"\n\n    @abstractmethod\n    async def connect(self) -&gt; None:\n        \"\"\"Establish connection to FreeCAD.\"\"\"\n        pass\n\n    @abstractmethod\n    async def disconnect(self) -&gt; None:\n        \"\"\"Close connection to FreeCAD.\"\"\"\n        pass\n\n    @abstractmethod\n    async def is_connected(self) -&gt; bool:\n        \"\"\"Check if bridge is connected.\"\"\"\n        pass\n\n    @abstractmethod\n    async def execute_python(\n        self,\n        code: str,\n        timeout_ms: int = 30000\n    ) -&gt; ExecutionResult:\n        \"\"\"Execute Python code in FreeCAD context.\"\"\"\n        pass\n\n    @abstractmethod\n    async def get_documents(self) -&gt; list[DocumentInfo]:\n        \"\"\"Get list of open documents.\"\"\"\n        pass\n\n    @abstractmethod\n    async def get_active_document(self) -&gt; DocumentInfo | None:\n        \"\"\"Get the active document.\"\"\"\n        pass\n\n    @abstractmethod\n    async def get_object(\n        self,\n        doc_name: str,\n        obj_name: str\n    ) -&gt; ObjectInfo:\n        \"\"\"Get detailed object information.\"\"\"\n        pass\n\n    @abstractmethod\n    async def get_console_output(\n        self,\n        lines: int = 100\n    ) -&gt; list[str]:\n        \"\"\"Get recent console output.\"\"\"\n        pass\n\n    @abstractmethod\n    async def get_freecad_version(self) -&gt; dict[str, Any]:\n        \"\"\"Get FreeCAD version information.\"\"\"\n        pass\n\n    @abstractmethod\n    async def is_gui_available(self) -&gt; bool:\n        \"\"\"Check if GUI is available.\"\"\"\n        pass\n</code></pre>"},{"location":"development/architecture-detailed/#3-embedded-bridge-bridgeembeddedpy","title":"3. Embedded Bridge (<code>bridge/embedded.py</code>)","text":"<p>For running FreeCAD in-process (headless mode).</p> <pre><code>\"\"\"Embedded bridge - runs FreeCAD in-process.\"\"\"\n\nimport asyncio\nimport sys\nimport io\nfrom contextlib import redirect_stdout, redirect_stderr\nfrom typing import Any\n\nfrom freecad_mcp.bridge.base import (\n    FreecadBridge,\n    ExecutionResult,\n    DocumentInfo,\n    ObjectInfo,\n)\n\nclass EmbeddedBridge(FreecadBridge):\n    \"\"\"Bridge that runs FreeCAD embedded in the MCP server process.\"\"\"\n\n    def __init__(self, freecad_path: str | None = None):\n        self._freecad_path = freecad_path\n        self._fc_module = None\n        self._executor = None\n\n    async def connect(self) -&gt; None:\n        \"\"\"Import and initialize FreeCAD.\"\"\"\n        if self._freecad_path:\n            sys.path.insert(0, self._freecad_path)\n\n        # Run import in thread pool to avoid blocking\n        loop = asyncio.get_event_loop()\n        self._fc_module = await loop.run_in_executor(\n            None, self._import_freecad\n        )\n\n    def _import_freecad(self):\n        \"\"\"Import FreeCAD module.\"\"\"\n        import FreeCAD\n        return FreeCAD\n\n    async def execute_python(\n        self,\n        code: str,\n        timeout_ms: int = 30000\n    ) -&gt; ExecutionResult:\n        \"\"\"Execute Python code in FreeCAD context.\"\"\"\n        import time\n\n        start = time.perf_counter()\n        stdout_capture = io.StringIO()\n        stderr_capture = io.StringIO()\n\n        # Build execution context with FreeCAD modules\n        exec_globals = {\n            \"FreeCAD\": self._fc_module,\n            \"App\": self._fc_module,\n            \"__builtins__\": __builtins__,\n        }\n\n        # Add GUI module if available\n        if await self.is_gui_available():\n            import FreeCADGui\n            exec_globals[\"FreeCADGui\"] = FreeCADGui\n            exec_globals[\"Gui\"] = FreeCADGui\n\n        try:\n            with redirect_stdout(stdout_capture), redirect_stderr(stderr_capture):\n                # Execute with timeout\n                loop = asyncio.get_event_loop()\n                result = await asyncio.wait_for(\n                    loop.run_in_executor(\n                        None,\n                        lambda: exec(compile(code, \"&lt;mcp&gt;\", \"exec\"), exec_globals)\n                    ),\n                    timeout=timeout_ms / 1000\n                )\n\n            elapsed = (time.perf_counter() - start) * 1000\n\n            return ExecutionResult(\n                success=True,\n                result=exec_globals.get(\"_result_\"),  # Convention for return values\n                stdout=stdout_capture.getvalue(),\n                stderr=stderr_capture.getvalue(),\n                execution_time_ms=elapsed,\n            )\n\n        except asyncio.TimeoutError:\n            return ExecutionResult(\n                success=False,\n                result=None,\n                stdout=stdout_capture.getvalue(),\n                stderr=stderr_capture.getvalue(),\n                execution_time_ms=timeout_ms,\n                error_type=\"TimeoutError\",\n                error_traceback=f\"Execution timed out after {timeout_ms}ms\",\n            )\n        except Exception as e:\n            import traceback\n            elapsed = (time.perf_counter() - start) * 1000\n\n            return ExecutionResult(\n                success=False,\n                result=None,\n                stdout=stdout_capture.getvalue(),\n                stderr=stderr_capture.getvalue(),\n                execution_time_ms=elapsed,\n                error_type=type(e).__name__,\n                error_traceback=traceback.format_exc(),\n            )\n</code></pre>"},{"location":"development/architecture-detailed/#4-socket-bridge-bridgesocketpy","title":"4. Socket Bridge (<code>bridge/socket.py</code>)","text":"<p>For communicating with a running FreeCAD instance (GUI or remote).</p> <pre><code>\"\"\"Socket bridge - communicates with FreeCAD over TCP/Unix socket.\"\"\"\n\nimport asyncio\nimport json\nfrom typing import Any\n\nfrom freecad_mcp.bridge.base import (\n    FreecadBridge,\n    ExecutionResult,\n    DocumentInfo,\n    ObjectInfo,\n)\nfrom freecad_mcp.bridge.protocol import MCPWireProtocol\n\nclass SocketBridge(FreecadBridge):\n    \"\"\"Bridge that communicates with FreeCAD over sockets.\"\"\"\n\n    def __init__(\n        self,\n        host: str = \"localhost\",\n        port: int = 9876,\n        unix_socket: str | None = None,\n    ):\n        self._host = host\n        self._port = port\n        self._unix_socket = unix_socket\n        self._reader: asyncio.StreamReader | None = None\n        self._writer: asyncio.StreamWriter | None = None\n        self._protocol = MCPWireProtocol()\n        self._request_id = 0\n        self._pending: dict[int, asyncio.Future] = {}\n\n    async def connect(self) -&gt; None:\n        \"\"\"Connect to FreeCAD socket server.\"\"\"\n        if self._unix_socket:\n            self._reader, self._writer = await asyncio.open_unix_connection(\n                self._unix_socket\n            )\n        else:\n            self._reader, self._writer = await asyncio.open_connection(\n                self._host, self._port\n            )\n\n        # Start response reader task\n        asyncio.create_task(self._read_responses())\n\n    async def _read_responses(self) -&gt; None:\n        \"\"\"Background task to read responses from FreeCAD.\"\"\"\n        while self._reader:\n            try:\n                data = await self._reader.readline()\n                if not data:\n                    break\n\n                response = self._protocol.decode(data)\n                request_id = response.get(\"id\")\n\n                if request_id in self._pending:\n                    self._pending[request_id].set_result(response)\n\n            except Exception as e:\n                # Handle connection errors\n                break\n\n    async def _send_request(\n        self,\n        method: str,\n        params: dict[str, Any]\n    ) -&gt; dict[str, Any]:\n        \"\"\"Send a request and wait for response.\"\"\"\n        self._request_id += 1\n        request_id = self._request_id\n\n        request = {\n            \"id\": request_id,\n            \"method\": method,\n            \"params\": params,\n        }\n\n        future: asyncio.Future = asyncio.get_event_loop().create_future()\n        self._pending[request_id] = future\n\n        try:\n            data = self._protocol.encode(request)\n            self._writer.write(data)\n            await self._writer.drain()\n\n            response = await asyncio.wait_for(future, timeout=60.0)\n            return response\n\n        finally:\n            del self._pending[request_id]\n\n    async def execute_python(\n        self,\n        code: str,\n        timeout_ms: int = 30000\n    ) -&gt; ExecutionResult:\n        \"\"\"Execute Python code in FreeCAD context.\"\"\"\n        response = await self._send_request(\"execute\", {\n            \"code\": code,\n            \"timeout_ms\": timeout_ms,\n        })\n\n        if \"error\" in response:\n            return ExecutionResult(\n                success=False,\n                result=None,\n                stdout=\"\",\n                stderr=response[\"error\"][\"message\"],\n                execution_time_ms=0,\n                error_type=response[\"error\"].get(\"type\", \"Error\"),\n                error_traceback=response[\"error\"].get(\"traceback\"),\n            )\n\n        result = response[\"result\"]\n        return ExecutionResult(\n            success=True,\n            result=result.get(\"value\"),\n            stdout=result.get(\"stdout\", \"\"),\n            stderr=result.get(\"stderr\", \"\"),\n            execution_time_ms=result.get(\"execution_time_ms\", 0),\n        )\n</code></pre>"},{"location":"development/architecture-detailed/#5-freecad-plugin-freecad_pluginserverpy","title":"5. FreeCAD Plugin (<code>freecad_plugin/server.py</code>)","text":"<p>Plugin that runs inside FreeCAD to accept socket connections.</p> <pre><code>\"\"\"FreeCAD plugin - Socket server running inside FreeCAD.\"\"\"\n\nimport asyncio\nimport json\nimport threading\nimport io\nfrom contextlib import redirect_stdout, redirect_stderr\nimport FreeCAD\nimport FreeCADGui\n\nclass FreecadMCPPlugin:\n    \"\"\"Plugin that runs inside FreeCAD to handle MCP bridge requests.\"\"\"\n\n    def __init__(self, host: str = \"localhost\", port: int = 9876):\n        self._host = host\n        self._port = port\n        self._server = None\n        self._loop = None\n        self._thread = None\n\n    def start(self) -&gt; None:\n        \"\"\"Start the socket server in a background thread.\"\"\"\n        self._thread = threading.Thread(target=self._run_server, daemon=True)\n        self._thread.start()\n        FreeCAD.Console.PrintMessage(\n            f\"MCP Bridge server started on {self._host}:{self._port}\\n\"\n        )\n\n    def _run_server(self) -&gt; None:\n        \"\"\"Run the asyncio event loop in background thread.\"\"\"\n        self._loop = asyncio.new_event_loop()\n        asyncio.set_event_loop(self._loop)\n\n        self._loop.run_until_complete(self._start_server())\n        self._loop.run_forever()\n\n    async def _start_server(self) -&gt; None:\n        \"\"\"Start the TCP server.\"\"\"\n        self._server = await asyncio.start_server(\n            self._handle_client,\n            self._host,\n            self._port,\n        )\n\n    async def _handle_client(\n        self,\n        reader: asyncio.StreamReader,\n        writer: asyncio.StreamWriter\n    ) -&gt; None:\n        \"\"\"Handle a connected client.\"\"\"\n        try:\n            while True:\n                data = await reader.readline()\n                if not data:\n                    break\n\n                request = json.loads(data.decode())\n                response = await self._process_request(request)\n\n                writer.write(json.dumps(response).encode() + b\"\\n\")\n                await writer.drain()\n\n        except Exception as e:\n            FreeCAD.Console.PrintError(f\"MCP client error: {e}\\n\")\n        finally:\n            writer.close()\n\n    async def _process_request(self, request: dict) -&gt; dict:\n        \"\"\"Process a single request.\"\"\"\n        request_id = request.get(\"id\")\n        method = request.get(\"method\")\n        params = request.get(\"params\", {})\n\n        try:\n            if method == \"execute\":\n                result = await self._execute_python(params)\n            elif method == \"get_documents\":\n                result = self._get_documents()\n            elif method == \"get_object\":\n                result = self._get_object(params)\n            elif method == \"get_version\":\n                result = self._get_version()\n            else:\n                return {\n                    \"id\": request_id,\n                    \"error\": {\"message\": f\"Unknown method: {method}\"}\n                }\n\n            return {\"id\": request_id, \"result\": result}\n\n        except Exception as e:\n            import traceback\n            return {\n                \"id\": request_id,\n                \"error\": {\n                    \"type\": type(e).__name__,\n                    \"message\": str(e),\n                    \"traceback\": traceback.format_exc(),\n                }\n            }\n\n    async def _execute_python(self, params: dict) -&gt; dict:\n        \"\"\"Execute Python code in FreeCAD's main thread.\"\"\"\n        import time\n\n        code = params[\"code\"]\n        timeout_ms = params.get(\"timeout_ms\", 30000)\n\n        # Must execute in main thread for FreeCAD compatibility\n        result_holder = {}\n\n        def execute():\n            start = time.perf_counter()\n            stdout_capture = io.StringIO()\n            stderr_capture = io.StringIO()\n\n            exec_globals = {\n                \"FreeCAD\": FreeCAD,\n                \"App\": FreeCAD,\n                \"FreeCADGui\": FreeCADGui,\n                \"Gui\": FreeCADGui,\n                \"__builtins__\": __builtins__,\n            }\n\n            try:\n                with redirect_stdout(stdout_capture), redirect_stderr(stderr_capture):\n                    exec(compile(code, \"&lt;mcp&gt;\", \"exec\"), exec_globals)\n\n                result_holder[\"value\"] = exec_globals.get(\"_result_\")\n                result_holder[\"stdout\"] = stdout_capture.getvalue()\n                result_holder[\"stderr\"] = stderr_capture.getvalue()\n                result_holder[\"execution_time_ms\"] = (\n                    time.perf_counter() - start\n                ) * 1000\n                result_holder[\"success\"] = True\n\n            except Exception as e:\n                import traceback\n                result_holder[\"success\"] = False\n                result_holder[\"error_type\"] = type(e).__name__\n                result_holder[\"error_message\"] = str(e)\n                result_holder[\"error_traceback\"] = traceback.format_exc()\n                result_holder[\"stdout\"] = stdout_capture.getvalue()\n                result_holder[\"stderr\"] = stderr_capture.getvalue()\n                result_holder[\"execution_time_ms\"] = (\n                    time.perf_counter() - start\n                ) * 1000\n\n        # Schedule execution in FreeCAD's main thread\n        # Use FreeCAD's timer mechanism for thread safety\n        from PySide2 import QtCore\n\n        event = threading.Event()\n\n        def main_thread_execute():\n            execute()\n            event.set()\n\n        QtCore.QTimer.singleShot(0, main_thread_execute)\n\n        # Wait for execution with timeout\n        if not event.wait(timeout=timeout_ms / 1000):\n            return {\n                \"success\": False,\n                \"error_type\": \"TimeoutError\",\n                \"error_message\": f\"Execution timed out after {timeout_ms}ms\",\n            }\n\n        return result_holder\n</code></pre>"},{"location":"development/architecture-detailed/#mcp-tools-specification","title":"MCP Tools Specification","text":""},{"location":"development/architecture-detailed/#core-execution-tools","title":"Core Execution Tools","text":""},{"location":"development/architecture-detailed/#execute_python","title":"<code>execute_python</code>","text":"<p>Execute arbitrary Python code in FreeCAD's context.</p> <pre><code>@mcp.tool()\nasync def execute_python(\n    code: str,\n    timeout_ms: int = 30000,\n    capture_result: bool = True,\n) -&gt; dict:\n    \"\"\"Execute Python code in FreeCAD's Python console context.\n\n    Args:\n        code: Python code to execute. Use `_result_ = value` to return data.\n        timeout_ms: Maximum execution time in milliseconds.\n        capture_result: Whether to capture and return the result value.\n\n    Returns:\n        Dictionary containing:\n        - success: Whether execution completed without errors\n        - result: The value assigned to `_result_` if capture_result is True\n        - stdout: Captured standard output\n        - stderr: Captured standard error\n        - execution_time_ms: Time taken in milliseconds\n        - error_type: Type of exception if failed\n        - error_traceback: Full traceback if failed\n\n    Example:\n        &gt;&gt;&gt; execute_python('''\n        ... import Part\n        ... box = Part.makeBox(10, 10, 10)\n        ... _result_ = {\"volume\": box.Volume, \"area\": box.Area}\n        ... ''')\n    \"\"\"\n    result = await bridge.execute_python(code, timeout_ms)\n    return result.__dict__\n</code></pre>"},{"location":"development/architecture-detailed/#execute_macro","title":"<code>execute_macro</code>","text":"<p>Run a FreeCAD macro file.</p> <pre><code>@mcp.tool()\nasync def execute_macro(\n    macro_name: str,\n    args: dict | None = None,\n) -&gt; dict:\n    \"\"\"Execute a FreeCAD macro by name.\n\n    Args:\n        macro_name: Name of the macro (without .FCMacro extension)\n        args: Optional arguments to pass to the macro as variables\n\n    Returns:\n        Execution result with stdout/stderr and any errors\n    \"\"\"\n    # Build code that loads and runs the macro\n    code = f'''\nimport FreeCAD\nmacro_path = FreeCAD.getUserMacroDir(True) + \"/{macro_name}.FCMacro\"\nwith open(macro_path) as f:\n    macro_code = f.read()\nexec(macro_code)\n'''\n    return await bridge.execute_python(code)\n</code></pre>"},{"location":"development/architecture-detailed/#document-management-tools","title":"Document Management Tools","text":""},{"location":"development/architecture-detailed/#create_document","title":"<code>create_document</code>","text":"<pre><code>@mcp.tool()\nasync def create_document(\n    name: str = \"Unnamed\",\n    label: str | None = None,\n) -&gt; dict:\n    \"\"\"Create a new FreeCAD document.\n\n    Args:\n        name: Internal document name (no spaces)\n        label: Display label (can contain spaces)\n\n    Returns:\n        Document information including name and path\n    \"\"\"\n    code = f'''\ndoc = FreeCAD.newDocument(\"{name}\")\nif {repr(label)}:\n    doc.Label = {repr(label)}\n_result_ = {{\"name\": doc.Name, \"label\": doc.Label}}\n'''\n    return await bridge.execute_python(code)\n</code></pre>"},{"location":"development/architecture-detailed/#open_document","title":"<code>open_document</code>","text":"<pre><code>@mcp.tool()\nasync def open_document(path: str) -&gt; dict:\n    \"\"\"Open an existing FreeCAD document.\n\n    Args:\n        path: Full path to the .FCStd file\n\n    Returns:\n        Document information\n    \"\"\"\n    code = f'''\ndoc = FreeCAD.openDocument({repr(path)})\n_result_ = {{\n    \"name\": doc.Name,\n    \"label\": doc.Label,\n    \"path\": doc.FileName,\n    \"objects\": [obj.Name for obj in doc.Objects],\n}}\n'''\n    return await bridge.execute_python(code)\n</code></pre>"},{"location":"development/architecture-detailed/#save_document","title":"<code>save_document</code>","text":"<pre><code>@mcp.tool()\nasync def save_document(\n    doc_name: str | None = None,\n    path: str | None = None,\n) -&gt; dict:\n    \"\"\"Save a FreeCAD document.\n\n    Args:\n        doc_name: Document name (uses active document if None)\n        path: Save path (uses existing path if None)\n\n    Returns:\n        Save status and path\n    \"\"\"\n    code = f'''\ndoc = FreeCAD.getDocument({repr(doc_name)}) if {repr(doc_name)} else FreeCAD.ActiveDocument\nif {repr(path)}:\n    doc.saveAs({repr(path)})\nelse:\n    doc.save()\n_result_ = {{\"saved\": True, \"path\": doc.FileName}}\n'''\n    return await bridge.execute_python(code)\n</code></pre>"},{"location":"development/architecture-detailed/#object-creation-tools","title":"Object Creation Tools","text":""},{"location":"development/architecture-detailed/#create_primitive","title":"<code>create_primitive</code>","text":"<pre><code>@mcp.tool()\nasync def create_primitive(\n    primitive_type: str,\n    name: str | None = None,\n    parameters: dict | None = None,\n    doc_name: str | None = None,\n) -&gt; dict:\n    \"\"\"Create a Part primitive object.\n\n    Args:\n        primitive_type: One of 'Box', 'Cylinder', 'Sphere', 'Cone', 'Torus'\n        name: Object name (auto-generated if None)\n        parameters: Primitive-specific parameters (e.g., {\"Length\": 10, \"Width\": 5})\n        doc_name: Target document (active document if None)\n\n    Returns:\n        Created object information\n    \"\"\"\n    params = parameters or {}\n    code = f'''\nimport Part\ndoc = FreeCAD.getDocument({repr(doc_name)}) if {repr(doc_name)} else FreeCAD.ActiveDocument\nobj = doc.addObject(\"Part::{primitive_type}\", {repr(name) if name else repr(primitive_type)})\nfor key, value in {repr(params)}.items():\n    setattr(obj, key, value)\ndoc.recompute()\n_result_ = {{\n    \"name\": obj.Name,\n    \"label\": obj.Label,\n    \"type\": obj.TypeId,\n    \"properties\": {{p: getattr(obj, p) for p in obj.PropertiesList[:20]}},\n}}\n'''\n    return await bridge.execute_python(code)\n</code></pre>"},{"location":"development/architecture-detailed/#create_sketch","title":"<code>create_sketch</code>","text":"<pre><code>@mcp.tool()\nasync def create_sketch(\n    plane: str = \"XY\",\n    name: str | None = None,\n    doc_name: str | None = None,\n) -&gt; dict:\n    \"\"\"Create a new sketch on a standard plane.\n\n    Args:\n        plane: One of 'XY', 'XZ', 'YZ'\n        name: Sketch name\n        doc_name: Target document\n\n    Returns:\n        Sketch object information\n    \"\"\"\n    plane_vectors = {\n        \"XY\": \"FreeCAD.Vector(0, 0, 1)\",\n        \"XZ\": \"FreeCAD.Vector(0, 1, 0)\",\n        \"YZ\": \"FreeCAD.Vector(1, 0, 0)\",\n    }\n    code = f'''\ndoc = FreeCAD.getDocument({repr(doc_name)}) if {repr(doc_name)} else FreeCAD.ActiveDocument\nsketch = doc.addObject(\"Sketcher::SketchObject\", {repr(name) or '\"Sketch\"'})\nsketch.MapMode = \"Deactivated\"\nsketch.Placement = FreeCAD.Placement(\n    FreeCAD.Vector(0, 0, 0),\n    FreeCAD.Rotation({plane_vectors[plane]}, 0)\n)\ndoc.recompute()\n_result_ = {{\"name\": sketch.Name, \"geometry_count\": sketch.GeometryCount}}\n'''\n    return await bridge.execute_python(code)\n</code></pre>"},{"location":"development/architecture-detailed/#geometry-tools","title":"Geometry Tools","text":""},{"location":"development/architecture-detailed/#add_sketch_geometry","title":"<code>add_sketch_geometry</code>","text":"<pre><code>@mcp.tool()\nasync def add_sketch_geometry(\n    sketch_name: str,\n    geometry_type: str,\n    parameters: dict,\n    doc_name: str | None = None,\n) -&gt; dict:\n    \"\"\"Add geometry to a sketch.\n\n    Args:\n        sketch_name: Name of the sketch object\n        geometry_type: One of 'line', 'circle', 'arc', 'rectangle', 'point'\n        parameters: Geometry-specific parameters\n        doc_name: Document containing the sketch\n\n    Returns:\n        Geometry index and sketch state\n\n    Example parameters:\n        line: {\"start\": [0, 0], \"end\": [10, 10]}\n        circle: {\"center\": [0, 0], \"radius\": 5}\n        rectangle: {\"corner1\": [0, 0], \"corner2\": [10, 10]}\n    \"\"\"\n    pass  # Implementation depends on geometry_type\n</code></pre>"},{"location":"development/architecture-detailed/#boolean_operation","title":"<code>boolean_operation</code>","text":"<pre><code>@mcp.tool()\nasync def boolean_operation(\n    operation: str,\n    base_object: str,\n    tool_objects: list[str],\n    doc_name: str | None = None,\n) -&gt; dict:\n    \"\"\"Perform boolean operation on Part objects.\n\n    Args:\n        operation: One of 'fuse' (union), 'cut' (subtract), 'common' (intersect)\n        base_object: Name of the base object\n        tool_objects: List of tool object names\n        doc_name: Document name\n\n    Returns:\n        Resulting object information\n    \"\"\"\n    pass\n</code></pre>"},{"location":"development/architecture-detailed/#exportimport-tools","title":"Export/Import Tools","text":""},{"location":"development/architecture-detailed/#export_mesh","title":"<code>export_mesh</code>","text":"<pre><code>@mcp.tool()\nasync def export_mesh(\n    objects: list[str],\n    path: str,\n    format: str = \"stl\",\n    options: dict | None = None,\n    doc_name: str | None = None,\n) -&gt; dict:\n    \"\"\"Export objects as mesh (STL, OBJ, etc.).\n\n    Args:\n        objects: List of object names to export\n        path: Output file path\n        format: Export format ('stl', 'obj', 'ply', 'off')\n        options: Format-specific options (e.g., mesh deflection)\n        doc_name: Document name\n\n    Returns:\n        Export status and file info\n    \"\"\"\n    pass\n</code></pre>"},{"location":"development/architecture-detailed/#export_step","title":"<code>export_step</code>","text":"<pre><code>@mcp.tool()\nasync def export_step(\n    objects: list[str],\n    path: str,\n    doc_name: str | None = None,\n) -&gt; dict:\n    \"\"\"Export objects as STEP file.\n\n    Args:\n        objects: List of object names to export\n        path: Output file path (.step or .stp)\n        doc_name: Document name\n\n    Returns:\n        Export status\n    \"\"\"\n    pass\n</code></pre>"},{"location":"development/architecture-detailed/#debugging-tools","title":"Debugging Tools","text":""},{"location":"development/architecture-detailed/#inspect_object","title":"<code>inspect_object</code>","text":"<pre><code>@mcp.tool()\nasync def inspect_object(\n    object_name: str,\n    doc_name: str | None = None,\n    include_shape: bool = True,\n) -&gt; dict:\n    \"\"\"Get detailed information about an object.\n\n    Args:\n        object_name: Name of the object\n        doc_name: Document name\n        include_shape: Include shape geometry details\n\n    Returns:\n        Comprehensive object information including:\n        - All properties and their values\n        - Shape information (if applicable)\n        - Parent/child relationships\n        - Placement/position data\n    \"\"\"\n    pass\n</code></pre>"},{"location":"development/architecture-detailed/#validate_model","title":"<code>validate_model</code>","text":"<pre><code>@mcp.tool()\nasync def validate_model(\n    doc_name: str | None = None,\n    check_geometry: bool = True,\n    check_constraints: bool = True,\n) -&gt; dict:\n    \"\"\"Validate model integrity and constraints.\n\n    Args:\n        doc_name: Document to validate\n        check_geometry: Check for geometry errors\n        check_constraints: Check sketch constraints\n\n    Returns:\n        Validation results with any issues found\n    \"\"\"\n    pass\n</code></pre>"},{"location":"development/architecture-detailed/#workbench-tools","title":"Workbench Tools","text":""},{"location":"development/architecture-detailed/#activate_workbench","title":"<code>activate_workbench</code>","text":"<pre><code>@mcp.tool()\nasync def activate_workbench(workbench_name: str) -&gt; dict:\n    \"\"\"Activate a FreeCAD workbench.\n\n    Args:\n        workbench_name: Workbench identifier (e.g., 'PartDesignWorkbench')\n\n    Returns:\n        Activation status and available commands\n    \"\"\"\n    pass\n</code></pre>"},{"location":"development/architecture-detailed/#list_workbench_commands","title":"<code>list_workbench_commands</code>","text":"<pre><code>@mcp.tool()\nasync def list_workbench_commands(\n    workbench_name: str | None = None,\n) -&gt; dict:\n    \"\"\"List available commands in a workbench.\n\n    Args:\n        workbench_name: Workbench to query (active if None)\n\n    Returns:\n        List of commands with descriptions\n    \"\"\"\n    pass\n</code></pre>"},{"location":"development/architecture-detailed/#mcp-resources-specification","title":"MCP Resources Specification","text":""},{"location":"development/architecture-detailed/#document-resources","title":"Document Resources","text":"<pre><code>@mcp.resource(\"freecad://documents\")\nasync def list_documents() -&gt; str:\n    \"\"\"List all open FreeCAD documents.\"\"\"\n    docs = await bridge.get_documents()\n    return json.dumps([d.__dict__ for d in docs], indent=2)\n\n@mcp.resource(\"freecad://documents/{doc_name}\")\nasync def get_document(doc_name: str) -&gt; str:\n    \"\"\"Get detailed document information.\"\"\"\n    pass\n\n@mcp.resource(\"freecad://documents/{doc_name}/objects\")\nasync def list_objects(doc_name: str) -&gt; str:\n    \"\"\"List all objects in a document with hierarchy.\"\"\"\n    pass\n\n@mcp.resource(\"freecad://documents/{doc_name}/objects/{obj_name}\")\nasync def get_object_details(doc_name: str, obj_name: str) -&gt; str:\n    \"\"\"Get full object details including properties and shape.\"\"\"\n    pass\n</code></pre>"},{"location":"development/architecture-detailed/#console-resources","title":"Console Resources","text":"<pre><code>@mcp.resource(\"freecad://console/history\")\nasync def get_console_history() -&gt; str:\n    \"\"\"Get Python console command history.\"\"\"\n    pass\n\n@mcp.resource(\"freecad://console/output\")\nasync def get_console_output() -&gt; str:\n    \"\"\"Get recent console output (stdout/stderr).\"\"\"\n    pass\n</code></pre>"},{"location":"development/architecture-detailed/#environment-resources","title":"Environment Resources","text":"<pre><code>@mcp.resource(\"freecad://version\")\nasync def get_version() -&gt; str:\n    \"\"\"Get FreeCAD version and build information.\"\"\"\n    pass\n\n@mcp.resource(\"freecad://workbenches\")\nasync def list_workbenches() -&gt; str:\n    \"\"\"List installed workbenches with status.\"\"\"\n    pass\n\n@mcp.resource(\"freecad://macros\")\nasync def list_macros() -&gt; str:\n    \"\"\"List installed macros.\"\"\"\n    pass\n\n@mcp.resource(\"freecad://preferences/{path}\")\nasync def get_preference(path: str) -&gt; str:\n    \"\"\"Get FreeCAD preference value.\"\"\"\n    pass\n</code></pre>"},{"location":"development/architecture-detailed/#communication-patterns","title":"Communication Patterns","text":""},{"location":"development/architecture-detailed/#pattern-1-stdio-transport-default-for-mcp-clients","title":"Pattern 1: Stdio Transport (Default for MCP Clients)","text":"<pre><code>MCP Client &lt;--stdio--&gt; MCP Server &lt;--embedded/socket--&gt; FreeCAD\n</code></pre> <p>Configuration in Claude Code settings (similar for other MCP clients):</p> <pre><code>{\n  \"mcpServers\": {\n    \"freecad\": {\n      \"command\": \"uv\",\n      \"args\": [\"run\", \"freecad-mcp\"],\n      \"env\": {\n        \"FREECAD_MODE\": \"xmlrpc\"\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"development/architecture-detailed/#pattern-2-http-transport-remoteshared","title":"Pattern 2: HTTP Transport (Remote/Shared)","text":"<pre><code>MCP Client &lt;--HTTP--&gt; MCP Server &lt;--socket--&gt; FreeCAD\n</code></pre> <p>For shared or remote setups:</p> <pre><code>{\n  \"mcpServers\": {\n    \"freecad\": {\n      \"url\": \"http://localhost:8000/mcp\",\n      \"transport\": \"streamable-http\"\n    }\n  }\n}\n</code></pre>"},{"location":"development/architecture-detailed/#pattern-3-gui-integration","title":"Pattern 3: GUI Integration","text":"<p>When FreeCAD GUI is running:</p> <ol> <li>User installs FreeCAD plugin via Addon Manager</li> <li>Plugin starts socket server on FreeCAD startup</li> <li>MCP server connects via socket bridge</li> <li>Full GUI access including view manipulation</li> </ol> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    FreeCAD GUI                               \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502              MCP Bridge Plugin                       \u2502    \u2502\n\u2502  \u2502         (Socket Server on port 9876)                \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                           \u25b2\n                           \u2502 TCP Socket\n                           \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              MCP Server (SocketBridge mode)                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                           \u25b2\n                           \u2502 stdio\n                           \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                MCP Client (Claude Code, etc.)                \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"development/architecture-detailed/#security-considerations","title":"Security Considerations","text":""},{"location":"development/architecture-detailed/#code-execution-sandboxing","title":"Code Execution Sandboxing","text":"<pre><code>class CodeSandbox:\n    \"\"\"Sandbox for restricting Python code execution.\"\"\"\n\n    FORBIDDEN_MODULES = {\n        \"subprocess\", \"os.system\", \"pty\", \"socket\",  # System access\n        \"pickle\", \"marshal\",  # Serialization attacks\n        \"__import__\",  # Dynamic imports\n    }\n\n    FORBIDDEN_BUILTINS = {\n        \"exec\", \"eval\", \"compile\",  # Meta-execution\n        \"open\", \"__import__\",  # File/module access\n    }\n\n    def validate_code(self, code: str) -&gt; list[str]:\n        \"\"\"Check code for dangerous patterns.\"\"\"\n        import ast\n\n        issues = []\n        tree = ast.parse(code)\n\n        for node in ast.walk(tree):\n            if isinstance(node, ast.Import):\n                for alias in node.names:\n                    if alias.name in self.FORBIDDEN_MODULES:\n                        issues.append(f\"Forbidden import: {alias.name}\")\n\n            elif isinstance(node, ast.ImportFrom):\n                if node.module in self.FORBIDDEN_MODULES:\n                    issues.append(f\"Forbidden import: {node.module}\")\n\n        return issues\n</code></pre>"},{"location":"development/architecture-detailed/#resource-limits","title":"Resource Limits","text":"<pre><code>@dataclass\nclass ExecutionLimits:\n    \"\"\"Resource limits for code execution.\"\"\"\n\n    max_execution_time_ms: int = 30000  # 30 seconds\n    max_memory_mb: int = 512\n    max_output_size_bytes: int = 1_000_000  # 1 MB\n    max_objects_created: int = 1000\n</code></pre>"},{"location":"development/architecture-detailed/#authentication-for-http-transport","title":"Authentication (for HTTP transport)","text":"<pre><code># OAuth 2.1 resource server implementation\nfrom mcp.server.auth import ResourceServer\n\nauth = ResourceServer(\n    issuer=\"https://auth.example.com\",\n    audience=\"freecad-mcp\",\n)\n\n@mcp.middleware\nasync def auth_middleware(request, call_next):\n    \"\"\"Validate OAuth tokens for HTTP transport.\"\"\"\n    if mcp.transport_type == \"http\":\n        await auth.validate_request(request)\n    return await call_next(request)\n</code></pre>"},{"location":"development/architecture-detailed/#deployment-modes","title":"Deployment Modes","text":""},{"location":"development/architecture-detailed/#mode-1-xml-rpc-mode-recommended","title":"Mode 1: XML-RPC Mode (Recommended)","text":"<p>Connects to FreeCAD via XML-RPC protocol. Works on all platforms (macOS, Linux, Windows).</p> <pre><code># .mise.toml\n[tools]\npython = \"3.11\"  # Required for FreeCAD ABI compatibility\nuv = \"latest\"\n\n[env]\nFREECAD_MODE = \"xmlrpc\"\nFREECAD_XMLRPC_PORT = \"9875\"\n</code></pre> <p>Setup:</p> <ol> <li>Install the Robust MCP Bridge workbench via FreeCAD Addon Manager, or run <code>just freecad::run-gui</code> from source</li> <li>Start the bridge using the workbench toolbar button or menu</li> <li>The bridge starts both XML-RPC (port 9875) and JSON-RPC (port 9876) servers</li> </ol>"},{"location":"development/architecture-detailed/#mode-2-local-embedded-linux-only","title":"Mode 2: Local Embedded (Linux Only)","text":"<p>Runs FreeCAD in-process for fastest execution. Only works on Linux - crashes on macOS/Windows due to <code>@rpath/libpython3.11.dylib</code> conflicts.</p> <pre><code># .mise.toml\n[tools]\npython = \"3.11\"  # Must match FreeCAD's bundled Python version\nuv = \"latest\"\n\n[env]\nFREECAD_MODE = \"embedded\"\nFREECAD_PATH = \"/usr/lib/freecad/lib\"  # Linux only\n</code></pre>"},{"location":"development/architecture-detailed/#mode-3-local-gui-with-plugin","title":"Mode 3: Local GUI with Plugin","text":"<ol> <li>Install FreeCAD plugin:</li> </ol> <pre><code>just install-freecad-plugin\n</code></pre> <ol> <li>Configure MCP server:</li> </ol> <pre><code>FREECAD_MODE = \"socket\"\nFREECAD_SOCKET_HOST = \"localhost\"\nFREECAD_SOCKET_PORT = \"9876\"\n</code></pre>"},{"location":"development/architecture-detailed/#mode-4-remotedocker","title":"Mode 4: Remote/Docker","text":"<pre><code>FROM freecad/freecad:latest\n\n# Install MCP plugin\nCOPY freecad_plugin /root/.FreeCAD/Mod/MCPBridge\n\n# Expose socket port\nEXPOSE 9876\n\nCMD [\"freecadcmd\", \"-c\", \"from freecad_mcp.plugin import start; start()\"]\n</code></pre>"},{"location":"development/architecture-detailed/#error-handling","title":"Error Handling","text":""},{"location":"development/architecture-detailed/#error-categories","title":"Error Categories","text":"<pre><code>class MCPError(Exception):\n    \"\"\"Base MCP error.\"\"\"\n    pass\n\nclass ConnectionError(MCPError):\n    \"\"\"Failed to connect to FreeCAD.\"\"\"\n    pass\n\nclass ExecutionError(MCPError):\n    \"\"\"Python code execution failed.\"\"\"\n    pass\n\nclass TimeoutError(MCPError):\n    \"\"\"Execution timed out.\"\"\"\n    pass\n\nclass ValidationError(MCPError):\n    \"\"\"Input validation failed.\"\"\"\n    pass\n\nclass ResourceNotFoundError(MCPError):\n    \"\"\"Requested resource does not exist.\"\"\"\n    pass\n</code></pre>"},{"location":"development/architecture-detailed/#error-response-format","title":"Error Response Format","text":"<pre><code>{\n  \"success\": false,\n  \"error\": {\n    \"type\": \"ExecutionError\",\n    \"message\": \"NameError: name 'foo' is not defined\",\n    \"traceback\": \"Traceback (most recent call last):\\n  File \\\"&lt;mcp&gt;\\\", line 1, in &lt;module&gt;\\nNameError: name 'foo' is not defined\",\n    \"context\": {\n      \"code_snippet\": \"foo.bar()\",\n      \"line_number\": 1\n    }\n  }\n}\n</code></pre>"},{"location":"development/architecture-detailed/#future-extensibility","title":"Future Extensibility","text":""},{"location":"development/architecture-detailed/#planned-features","title":"Planned Features","text":"<ol> <li>Streaming Execution Output: Real-time stdout/stderr streaming for long operations</li> <li>View Manipulation: Camera control, section views, rendering in GUI mode</li> <li>Parametric Updates: Modify parameters and observe model updates</li> <li>Assembly Support: Integration with Assembly3/4 workbenches</li> <li>FEM Integration: Finite Element Analysis setup and results</li> <li>Path/CAM Support: CAM toolpath generation and simulation</li> <li>Multi-Document: Work across multiple documents simultaneously</li> <li>Undo/Redo: Transaction management with rollback capability</li> </ol>"},{"location":"development/architecture-detailed/#extension-points","title":"Extension Points","text":"<pre><code># Plugin system for custom tools\nclass ToolPlugin(Protocol):\n    \"\"\"Protocol for tool plugins.\"\"\"\n\n    @property\n    def name(self) -&gt; str: ...\n\n    @property\n    def tools(self) -&gt; list[Callable]: ...\n\n    async def initialize(self, bridge: FreecadBridge) -&gt; None: ...\n\n# Register custom plugins\nmcp.register_plugin(MyCustomToolPlugin())\n</code></pre>"},{"location":"development/architecture-detailed/#summary","title":"Summary","text":"<p>This architecture provides:</p> <ol> <li>Full Python Console Access: Execute any FreeCAD Python code</li> <li>Dual Mode Support: Works with GUI and headless FreeCAD</li> <li>Comprehensive Tooling: Document, object, geometry, export tools</li> <li>Rich Resources: Query documents, objects, console, workbenches</li> <li>Secure Execution: Sandboxing, timeouts, resource limits</li> <li>Flexible Deployment: Embedded, socket, remote modes</li> <li>Extensible Design: Plugin system for custom functionality</li> </ol> <p>The MCP server acts as a powerful bridge enabling AI assistants to become intelligent FreeCAD development partners.</p>"},{"location":"development/architecture/","title":"Architecture","text":""},{"location":"development/architecture/#architecture","title":"Architecture","text":"<p>This document provides a technical overview of the FreeCAD Robust MCP Server architecture.</p> <p>For the full architecture document with design decisions and rationale, see Detailed Architecture.</p>"},{"location":"development/architecture/#overview","title":"Overview","text":"<p>The FreeCAD Robust MCP Server follows a Bridge with Adapter pattern:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                         MCP Server Layer                                 \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502                     FastMCP Application                             \u2502 \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510           \u2502 \u2502\n\u2502  \u2502  \u2502  Tools   \u2502  \u2502 Resources\u2502  \u2502  Prompts \u2502  \u2502 Lifecycle\u2502           \u2502 \u2502\n\u2502  \u2502  \u2502 (82+)    \u2502  \u2502          \u2502  \u2502          \u2502  \u2502 Manager  \u2502           \u2502 \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518           \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                    \u2502                                     \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502                    FreeCAD Bridge Interface                         \u2502 \u2502\n\u2502  \u2502                    (Abstract Base Class)                            \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502           \u2571               \u2502               \u2572                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510              \u2502\n\u2502  \u2502 EmbeddedBridge \u2502 \u2502  SocketBridge  \u2502 \u2502  XMLRPCBridge  \u2502              \u2502\n\u2502  \u2502 (Linux only)   \u2502 \u2502 (JSON-RPC)     \u2502 \u2502 (Recommended)  \u2502              \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"development/architecture/#module-structure","title":"Module Structure","text":"<pre><code>src/freecad_mcp/\n\u251c\u2500\u2500 __init__.py            # Package entry point\n\u251c\u2500\u2500 _version.py            # Version info (auto-generated)\n\u251c\u2500\u2500 server.py              # Main MCP server entry point\n\u251c\u2500\u2500 config.py              # Configuration management\n\u251c\u2500\u2500 py.typed               # PEP 561 marker for type hints\n\u2502\n\u251c\u2500\u2500 bridge/                # FreeCAD communication layer\n\u2502   \u251c\u2500\u2500 __init__.py        # Bridge factory\n\u2502   \u251c\u2500\u2500 base.py            # Abstract bridge interface\n\u2502   \u251c\u2500\u2500 embedded.py        # In-process FreeCAD (Linux only)\n\u2502   \u251c\u2500\u2500 socket.py          # JSON-RPC socket bridge\n\u2502   \u2514\u2500\u2500 xmlrpc.py          # XML-RPC bridge (recommended)\n\u2502\n\u251c\u2500\u2500 tools/                 # MCP tool implementations\n\u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u251c\u2500\u2500 execution.py       # Python execution &amp; debugging\n\u2502   \u251c\u2500\u2500 documents.py       # Document management\n\u2502   \u251c\u2500\u2500 objects.py         # Object creation/manipulation\n\u2502   \u251c\u2500\u2500 partdesign.py      # PartDesign parametric modeling\n\u2502   \u251c\u2500\u2500 view.py            # View, camera, display\n\u2502   \u251c\u2500\u2500 export.py          # Export/import operations\n\u2502   \u2514\u2500\u2500 macros.py          # Macro management\n\u2502\n\u251c\u2500\u2500 resources/             # MCP resource implementations\n\u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u2514\u2500\u2500 freecad.py         # Document, console, capabilities\n\u2502\n\u251c\u2500\u2500 prompts/               # MCP prompt templates\n\u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u2514\u2500\u2500 freecad.py         # Modeling and debugging prompts\n\u2502\n\u2514\u2500\u2500 utils/                 # Utility modules\n    \u2514\u2500\u2500 __init__.py\n</code></pre>"},{"location":"development/architecture/#bridge-architecture","title":"Bridge Architecture","text":""},{"location":"development/architecture/#base-interface","title":"Base Interface","text":"<p>All bridges implement <code>FreecadBridge</code>:</p> <pre><code>class FreecadBridge(ABC):\n    @abstractmethod\n    async def connect(self) -&gt; None: ...\n\n    @abstractmethod\n    async def disconnect(self) -&gt; None: ...\n\n    @abstractmethod\n    async def is_connected(self) -&gt; bool: ...\n\n    @abstractmethod\n    async def execute_python(\n        self, code: str, timeout_ms: int = 30000\n    ) -&gt; ExecutionResult: ...\n</code></pre>"},{"location":"development/architecture/#xml-rpc-bridge-recommended","title":"XML-RPC Bridge (Recommended)","text":"<ul> <li>Connects to FreeCAD via XML-RPC on port 9875</li> <li>Proven, reliable protocol</li> <li>Works on all platforms</li> </ul>"},{"location":"development/architecture/#socket-bridge","title":"Socket Bridge","text":"<ul> <li>Uses JSON-RPC over TCP sockets on port 9876</li> <li>Lower overhead than XML-RPC</li> <li>Easier to debug (JSON format)</li> </ul>"},{"location":"development/architecture/#embedded-bridge","title":"Embedded Bridge","text":"<ul> <li>Imports FreeCAD directly into the MCP server process</li> <li>Linux only (crashes on macOS/Windows)</li> <li>Fastest execution (no IPC overhead)</li> <li>Headless mode only</li> </ul>"},{"location":"development/architecture/#workbench-addon-architecture","title":"Workbench Addon Architecture","text":"<p>The workbench addon runs inside FreeCAD:</p> <pre><code>addon/FreecadRobustMCPBridge/\n\u251c\u2500\u2500 Init.py                # Module initialization\n\u251c\u2500\u2500 InitGui.py             # GUI initialization (workbench)\n\u251c\u2500\u2500 FreecadRobustMCPBridge.svg   # Workbench icon\n\u2514\u2500\u2500 freecad_mcp_bridge/    # Bridge plugin\n    \u251c\u2500\u2500 __init__.py\n    \u251c\u2500\u2500 server.py          # XML-RPC/JSON-RPC server\n    \u251c\u2500\u2500 blocking_bridge.py # Blocking server (keeps FreeCAD running)\n    \u2514\u2500\u2500 startup_bridge.py  # Non-blocking startup (for interactive GUI)\n\npackage.xml                # FreeCAD addon metadata (in project root)\n</code></pre> <p>Note: The <code>package.xml</code> file is in the project root, not inside the addon directory. This is because it defines metadata for multiple components (workbench and macros) in a single manifest.</p>"},{"location":"development/architecture/#thread-safety","title":"Thread Safety","text":"<p>The workbench uses a queue-based system for thread-safe GUI operations:</p> <pre><code># Operations queued from network thread\nrequest_queue.put(operation)\n\n# Executed on main GUI thread via QTimer\ndef process_queue():\n    while not request_queue.empty():\n        op = request_queue.get()\n        result = op()\n        response_queue.put(result)\n</code></pre>"},{"location":"development/architecture/#data-flow","title":"Data Flow","text":""},{"location":"development/architecture/#tool-execution","title":"Tool Execution","text":"<pre><code>1. AI Assistant sends tool request\n   \u2193\n2. MCP Server receives request\n   \u2193\n3. Tool handler prepares Python code\n   \u2193\n4. Bridge.execute_python() sends code\n   \u2193\n5. FreeCAD executes code (main thread)\n   \u2193\n6. Result returned via bridge\n   \u2193\n7. MCP Server formats response\n   \u2193\n8. AI Assistant receives result\n</code></pre>"},{"location":"development/architecture/#code-execution-pattern","title":"Code Execution Pattern","text":"<p>Tools generate Python code that runs in FreeCAD:</p> <pre><code>@mcp.tool()\nasync def create_box(length: float = 10.0, ...) -&gt; dict:\n    bridge = await get_bridge()\n\n    code = f'''\ndoc = FreeCAD.ActiveDocument or FreeCAD.newDocument(\"Unnamed\")\nobj = doc.addObject(\"Part::Box\", \"Box\")\nobj.Length = {length}\ndoc.recompute()\n_result_ = {{\"name\": obj.Name, \"volume\": obj.Shape.Volume}}\n'''\n\n    result = await bridge.execute_python(code)\n    return result.result\n</code></pre>"},{"location":"development/architecture/#gui-detection","title":"GUI Detection","text":"<p>Tools check <code>FreeCAD.GuiUp</code> to handle headless mode:</p> <pre><code>code = f'''\nif not FreeCAD.GuiUp:\n    _result_ = {{\"success\": False, \"error\": \"GUI not available\"}}\nelse:\n    # GUI-only operations\n    obj.ViewObject.Visibility = True\n    _result_ = {{\"success\": True}}\n'''\n</code></pre>"},{"location":"development/architecture/#configuration","title":"Configuration","text":"<p>Configuration via environment variables:</p> Variable Default Description <code>FREECAD_MODE</code> <code>xmlrpc</code> Connection mode <code>FREECAD_PATH</code> auto FreeCAD lib path (embedded) <code>FREECAD_SOCKET_HOST</code> <code>localhost</code> Socket/XML-RPC host <code>FREECAD_SOCKET_PORT</code> <code>9876</code> JSON-RPC socket port <code>FREECAD_XMLRPC_PORT</code> <code>9875</code> XML-RPC port <code>FREECAD_TIMEOUT_MS</code> <code>30000</code> Execution timeout"},{"location":"development/architecture/#testing-strategy","title":"Testing Strategy","text":""},{"location":"development/architecture/#unit-tests","title":"Unit Tests","text":"<ul> <li>Mock FreeCAD module</li> <li>Test bridge logic in isolation</li> <li>Run on all platforms</li> </ul>"},{"location":"development/architecture/#integration-tests","title":"Integration Tests","text":"<ul> <li>Use FreeCAD AppImage in CI</li> <li>Test actual FreeCAD operations</li> <li>Run in headless mode</li> </ul>"},{"location":"development/architecture/#embedded-mode-testing","title":"Embedded Mode Testing","text":"<p>Embedded mode receives minimal testing:</p> <ul> <li>Unit tests with mocked FreeCAD</li> <li>No CI integration tests (would require Linux + FreeCAD in-process)</li> <li>Recommended to use xmlrpc/socket modes for production</li> </ul>"},{"location":"development/architecture/#next-steps","title":"Next Steps","text":"<ul> <li>Contributing - How to contribute</li> <li>Detailed Architecture - Complete design details</li> </ul>"},{"location":"development/contributing/","title":"Contributing","text":""},{"location":"development/contributing/#contributing","title":"Contributing","text":"<p>Thank you for your interest in contributing to FreeCAD Robust MCP Server!</p>"},{"location":"development/contributing/#development-setup","title":"Development Setup","text":""},{"location":"development/contributing/#prerequisites","title":"Prerequisites","text":"<ul> <li>Python 3.11 (must match FreeCAD's bundled version)</li> <li>mise for tool management</li> <li>FreeCAD 0.21+ or 1.0+ installed</li> </ul>"},{"location":"development/contributing/#initial-setup","title":"Initial Setup","text":"<pre><code>git clone https://github.com/spkane/freecad-robust-mcp-and-more.git\ncd freecad-robust-mcp-and-more\n\n# Install mise if not already installed\ncurl https://mise.run | sh\n\n# Install project tools and dependencies\nmise trust\nmise install\njust setup\n</code></pre>"},{"location":"development/contributing/#safety-cli-account-required-for-security-scanning","title":"Safety CLI Account (Required for Security Scanning)","text":"<p>This project uses Safety CLI for dependency vulnerability scanning. Safety requires a free account for the <code>safety scan</code> command used in pre-commit hooks.</p> <pre><code># Register for a free account (interactive)\nuv run safety auth\n\n# Or login if you already have an account\nuv run safety auth --login\n</code></pre> <p>Note: Authentication is stored locally and only needs to be done once per machine. If you skip this step, the <code>safety</code> pre-commit hook will fail with an authentication prompt.</p> <p>CI/CD: Safety runs in CI using the <code>SAFETY_API_KEY</code> repository secret.</p>"},{"location":"development/contributing/#running-tests","title":"Running Tests","text":"<pre><code># Run unit tests\njust testing::unit\n\n# Run with coverage\njust testing::cov\n\n# Run all tests including integration\njust testing::all\n\n# Run type checking\nuv run mypy src/\n</code></pre>"},{"location":"development/contributing/#code-quality","title":"Code Quality","text":"<pre><code># Run all pre-commit checks\njust quality::check\n\n# Run linting\njust quality::lint\n\n# Format code\njust quality::format\n\n# Run security checks\njust quality::security\n</code></pre>"},{"location":"development/contributing/#project-structure","title":"Project Structure","text":"<pre><code>freecad-robust-mcp-and-more/\n\u251c\u2500\u2500 src/freecad_mcp/           # Main package\n\u2502   \u251c\u2500\u2500 bridge/                # FreeCAD connection bridges\n\u2502   \u251c\u2500\u2500 tools/                 # MCP tool implementations\n\u2502   \u251c\u2500\u2500 resources/             # MCP resource implementations\n\u2502   \u251c\u2500\u2500 prompts/               # MCP prompt templates\n\u2502   \u2514\u2500\u2500 server.py              # Main server entry point\n\u251c\u2500\u2500 addon/                     # FreeCAD workbench addon\n\u2502   \u2514\u2500\u2500 FreecadRobustMCPBridge/      # Workbench files\n\u251c\u2500\u2500 macros/                    # Standalone FreeCAD macros\n\u251c\u2500\u2500 tests/                     # Test suite\n\u2502   \u251c\u2500\u2500 unit/                  # Unit tests\n\u2502   \u2514\u2500\u2500 integration/           # Integration tests\n\u251c\u2500\u2500 docs/                      # Documentation\n\u2514\u2500\u2500 just/                      # Justfile modules\n</code></pre>"},{"location":"development/contributing/#contribution-guidelines","title":"Contribution Guidelines","text":""},{"location":"development/contributing/#code-style","title":"Code Style","text":"<ul> <li>Follow PEP 8 with 88-character line length (ruff/black)</li> <li>Use type hints for all function signatures</li> <li>Write Google-style docstrings</li> <li>Run <code>just quality::format</code> before committing</li> </ul>"},{"location":"development/contributing/#testing","title":"Testing","text":"<ul> <li>Write tests for all new functionality</li> <li>Maintain test coverage</li> <li>Run <code>just all</code> before submitting PRs (runs quality checks + unit tests)</li> <li>Integration tests require FreeCAD (run via CI)</li> </ul>"},{"location":"development/contributing/#documentation","title":"Documentation","text":"<ul> <li>Update docstrings for API changes</li> <li>Update user docs for feature changes</li> <li>Run <code>just documentation::build</code> to build and verify</li> </ul>"},{"location":"development/contributing/#commits","title":"Commits","text":"<ul> <li>Use conventional commit format</li> <li>Keep commits focused and atomic</li> <li>Reference issues when applicable</li> </ul>"},{"location":"development/contributing/#adding-new-mcp-tools","title":"Adding New MCP Tools","text":"<ol> <li>Choose the right module in <code>src/freecad_mcp/tools/</code></li> <li>Add the tool function with proper docstring:</li> </ol> <pre><code>@mcp.tool()\nasync def my_new_tool(\n    param1: str,\n    param2: int = 10,\n    doc_name: str | None = None,\n) -&gt; dict[str, Any]:\n    \"\"\"Short description of what the tool does.\n\n    Args:\n        param1: Description of param1.\n        param2: Description of param2.\n        doc_name: Document name. Uses active if None.\n\n    Returns:\n        Dictionary with result information.\n    \"\"\"\n    bridge = await get_bridge()\n    code = f'''\n# FreeCAD Python code here\n_result_ = {{\"success\": True}}\n'''\n    result = await bridge.execute_python(code)\n    return result.result or {\"success\": False}\n</code></pre> <ol> <li>Add tests in the appropriate test file</li> <li>Update documentation in <code>docs/guide/tools.md</code></li> <li>Update capabilities resource in <code>src/freecad_mcp/resources/freecad.py</code></li> </ol>"},{"location":"development/contributing/#adding-new-connection-modes","title":"Adding New Connection Modes","text":"<ol> <li>Create a new bridge class in <code>src/freecad_mcp/bridge/</code></li> <li>Inherit from <code>FreecadBridge</code> base class</li> <li>Implement all abstract methods</li> <li>Add to bridge factory in <code>src/freecad_mcp/bridge/__init__.py</code></li> <li>Add configuration option in <code>src/freecad_mcp/config.py</code></li> <li>Update documentation</li> </ol>"},{"location":"development/contributing/#release-process","title":"Release Process","text":"<p>Releases are automated via GitHub Actions:</p> <ol> <li>Update <code>CHANGELOG.md</code></li> <li>Create a GitHub Release with a version tag</li> <li>CI builds and publishes:</li> <li>PyPI package</li> <li>Docker images</li> <li>Macro release archives</li> </ol>"},{"location":"development/contributing/#future-work","title":"Future Work","text":"<p>The following items are on the roadmap and welcome contributions:</p>"},{"location":"development/contributing/#embedded-mode-integration-tests","title":"Embedded Mode Integration Tests","text":"<p>Currently, embedded mode has only mocked unit tests. Adding live integration tests would require:</p> <ol> <li>CI workflow that runs on Linux (embedded mode is Linux-only)</li> <li>Uses FreeCAD AppImage's bundled Python interpreter</li> <li>Sets up <code>PYTHONPATH</code> and <code>LD_LIBRARY_PATH</code> to point to AppImage libs</li> <li>Runs tests with <code>FREECAD_MODE=embedded</code></li> </ol> <p>Challenge: The AppImage bundles Python 3.11, so tests must run using that interpreter (not the system Python) to avoid ABI incompatibility.</p> <p>Reference: See <code>macro-test.yaml</code> for how integration tests currently work with xmlrpc mode.</p>"},{"location":"development/contributing/#getting-help","title":"Getting Help","text":"<ul> <li>Issues: GitHub Issues</li> </ul>"},{"location":"development/contributing/#license","title":"License","text":"<p>This project is licensed under the MIT License. See LICENSE for details.</p>"},{"location":"development/mkdocs-guide/","title":"MkDocs Guide","text":""},{"location":"development/mkdocs-guide/#mkdocs-documentation-guide","title":"MkDocs Documentation Guide","text":"<p>This project uses MkDocs with the Material theme for documentation. This guide covers our specific configuration, extensions, and how to use them.</p>"},{"location":"development/mkdocs-guide/#quick-start","title":"Quick Start","text":"<pre><code># Serve docs locally with live reload\njust documentation::serve\n\n# Build static site\njust documentation::build\n\n# Open docs in browser\njust documentation::open\n</code></pre>"},{"location":"development/mkdocs-guide/#theme-configuration","title":"Theme Configuration","text":"<p>We use Material for MkDocs with dark mode as the default. Users can toggle between dark and light modes using the sun/moon icon in the header.</p> <p>Color scheme: Deep purple primary with purple accent.</p>"},{"location":"development/mkdocs-guide/#markdown-extensions","title":"Markdown Extensions","text":""},{"location":"development/mkdocs-guide/#code-blocks","title":"Code Blocks","text":""},{"location":"development/mkdocs-guide/#syntax-highlighting","title":"Syntax Highlighting","text":"<p>Standard fenced code blocks with language hints:</p> <pre><code>```python\ndef hello():\n    print(\"Hello, world!\")\n```\n</code></pre>"},{"location":"development/mkdocs-guide/#line-numbers-and-highlighting","title":"Line Numbers and Highlighting","text":"<pre><code>```python linenums=\"1\" hl_lines=\"2 3\"\ndef hello():\n    # These lines are highlighted\n    print(\"Hello!\")\n```\n</code></pre>"},{"location":"development/mkdocs-guide/#code-annotations","title":"Code Annotations","text":"<p>Add numbered annotations that expand on hover:</p> <pre><code>```python\ndef process(data):  # (1)!\n    return data.strip()  # (2)!\n```\n\n1. This function processes input data\n2. Removes leading/trailing whitespace\n</code></pre>"},{"location":"development/mkdocs-guide/#inline-code-highlighting","title":"Inline Code Highlighting","text":"<p>Use <code>print(\"inline\")</code> for inline syntax highlighting:</p> <pre><code>Use `#!python print(\"inline\")` for inline code with highlighting.\n</code></pre>"},{"location":"development/mkdocs-guide/#tabbed-content","title":"Tabbed Content","text":"<p>Create tabs for platform-specific or alternative content:</p> <pre><code>=== \"macOS\"\n\n    ```bash\n    ~/Library/Application Support/FreeCAD/Macro/\n    ```\n\n=== \"Linux\"\n\n    ```bash\n    ~/.local/share/FreeCAD/Macro/\n    ```\n\n=== \"Windows\"\n\n    ```bash\n    %APPDATA%/FreeCAD/Macro/\n    ```\n</code></pre> <p>Renders as:</p> macOSLinuxWindows <pre><code>~/Library/Application Support/FreeCAD/Macro/\n</code></pre> <pre><code>~/.local/share/FreeCAD/Macro/\n</code></pre> <pre><code>%APPDATA%/FreeCAD/Macro/\n</code></pre>"},{"location":"development/mkdocs-guide/#admonitions-call-outs","title":"Admonitions (Call-outs)","text":"<p>Create styled call-out boxes:</p> <pre><code>!!! note \"Optional Title\"\n    This is a note admonition.\n\n!!! warning\n    This is a warning without a custom title.\n\n!!! danger \"Critical\"\n    This is a danger/error admonition.\n\n!!! tip\n    This is a tip admonition.\n\n!!! info\n    This is an info admonition.\n\n!!! example\n    This is an example admonition.\n</code></pre> <p>Collapsible admonitions:</p> <pre><code>??? note \"Click to expand\"\n    This content is hidden by default.\n\n???+ note \"Expanded by default\"\n    This content is visible but can be collapsed.\n</code></pre> <p>Available types: <code>note</code>, <code>abstract</code>, <code>info</code>, <code>tip</code>, <code>success</code>, <code>question</code>, <code>warning</code>, <code>failure</code>, <code>danger</code>, <code>bug</code>, <code>example</code>, <code>quote</code></p>"},{"location":"development/mkdocs-guide/#task-lists","title":"Task Lists","text":"<p>Create checkbox lists:</p> <pre><code>- [x] Completed task\n- [ ] Incomplete task\n- [ ] Another task\n</code></pre> <p>Renders as:</p> <ul> <li> Completed task</li> <li> Incomplete task</li> <li> Another task</li> </ul>"},{"location":"development/mkdocs-guide/#keyboard-keys","title":"Keyboard Keys","text":"<p>Style keyboard shortcuts:</p> <pre><code>Press ++ctrl+c++ to copy.\nPress ++cmd+shift+p++ on macOS.\nPress ++enter++ to confirm.\n</code></pre> <p>Renders as: Press Ctrl+C to copy.</p> <p>Common keys: <code>ctrl</code>, <code>alt</code>, <code>shift</code>, <code>cmd</code>, <code>enter</code>, <code>tab</code>, <code>esc</code>, <code>backspace</code>, <code>delete</code>, <code>up</code>, <code>down</code>, <code>left</code>, <code>right</code>, <code>f1</code>-<code>f12</code></p>"},{"location":"development/mkdocs-guide/#text-formatting","title":"Text Formatting","text":""},{"location":"development/mkdocs-guide/#highlighting","title":"Highlighting","text":"<pre><code>==This text is highlighted==\n</code></pre> <p>Renders as: This text is highlighted</p>"},{"location":"development/mkdocs-guide/#subscript-and-superscript","title":"Subscript and Superscript","text":"<pre><code>H~2~O (subscript)\nx^2^ (superscript)\n</code></pre> <p>Renders as: H<sub>2</sub>O and x<sup>2</sup></p>"},{"location":"development/mkdocs-guide/#strikethrough","title":"Strikethrough","text":"<pre><code>~~deleted text~~\n</code></pre> <p>Renders as: deleted text</p>"},{"location":"development/mkdocs-guide/#critic-markup-for-diffsreviews","title":"Critic Markup (for diffs/reviews)","text":"<pre><code>deleted\nadded\noldnew\nhighlighted\ncomment\n</code></pre>"},{"location":"development/mkdocs-guide/#definition-lists","title":"Definition Lists","text":"<pre><code>Term 1\n:   Definition for term 1\n\nTerm 2\n:   Definition for term 2\n:   Can have multiple definitions\n</code></pre> <p>Renders as:</p> Term 1 Definition for term 1 Term 2 Definition for term 2 Can have multiple definitions"},{"location":"development/mkdocs-guide/#footnotes","title":"Footnotes","text":"<pre><code>This needs a citation[^1].\n\n[^1]: This is the footnote content.\n</code></pre>"},{"location":"development/mkdocs-guide/#mermaid-diagrams","title":"Mermaid Diagrams","text":"<p>Create diagrams using Mermaid syntax:</p> <pre><code>```mermaid\ngraph LR\n    A[MCP Client] --&gt; B[Robust MCP Server]\n    B --&gt; C[FreeCAD Bridge]\n    C --&gt; D[FreeCAD]\n```\n</code></pre> <p>Renders as:</p> <pre><code>graph LR\n    A[MCP Client] --&gt; B[Robust MCP Server]\n    B --&gt; C[FreeCAD Bridge]\n    C --&gt; D[FreeCAD]</code></pre> <p>Supported diagram types: flowchart, sequence, class, state, ER, gantt, pie, journey</p>"},{"location":"development/mkdocs-guide/#plugins","title":"Plugins","text":""},{"location":"development/mkdocs-guide/#git-revision-date","title":"Git Revision Date","text":"<p>Pages automatically show \"Last updated X ago\" at the bottom. No action needed.</p>"},{"location":"development/mkdocs-guide/#image-lightbox-glightbox","title":"Image Lightbox (GLightbox)","text":"<p>All images are automatically zoomable. Click any image to open in a lightbox overlay.</p> <p>To exclude an image from lightbox:</p> <pre><code>![Image](path/to/image.png){ .off-glb }\n</code></pre>"},{"location":"development/mkdocs-guide/#minification","title":"Minification","text":"<p>HTML is automatically minified in production builds. No action needed.</p>"},{"location":"development/mkdocs-guide/#search","title":"Search","text":"<p>Full-text search is enabled. Features:</p> <ul> <li>Search suggestions as you type</li> <li>Search result highlighting</li> <li>Shareable search URLs</li> </ul>"},{"location":"development/mkdocs-guide/#macros-plugin","title":"Macros Plugin","text":""},{"location":"development/mkdocs-guide/#custom-delimiters","title":"Custom Delimiters","text":"<p>Important</p> <p>We use custom delimiters to avoid conflicts with Python dict literals in code blocks.</p> <ul> <li>Variables: <code>{</code> <code>{@</code> and <code>@}</code> <code>}</code></li> <li>Blocks: <code>{%</code> <code>@</code> and <code>@</code> <code>%}</code></li> </ul> <p>Standard Jinja2 <code>{</code> <code>{</code> <code>}</code> <code>}</code> syntax will NOT work.</p>"},{"location":"development/mkdocs-guide/#using-variables","title":"Using Variables","text":"<p>Variables are defined in <code>docs/variables.yaml</code>:</p> <pre><code># docs/variables.yaml\nproject_name: FreeCAD Robust MCP Suite\npackage_name: freecad-robust-mcp\nxmlrpc_port: 9875\nsocket_port: 9876\n</code></pre> <p>Use in Markdown:</p> <pre><code>The default XML-RPC port is 9875.\nInstall with: `pip install freecad-robust-mcp`\n</code></pre>"},{"location":"development/mkdocs-guide/#available-variables","title":"Available Variables","text":"Variable Value Description <code>project_name</code> FreeCAD Robust MCP Suite Display name <code>package_name</code> freecad-robust-mcp PyPI package name <code>docker_image</code> spkane/freecad-robust-mcp Docker image <code>xmlrpc_port</code> 9875 XML-RPC server port <code>socket_port</code> 9876 Socket server port <code>paths.macos.macro</code> ~/Library/... macOS macro path <code>paths.linux.macro</code> ~/.local/share/... Linux macro path <code>paths.windows.macro</code> %APPDATA%/... Windows macro path"},{"location":"development/mkdocs-guide/#built-in-macros","title":"Built-in Macros","text":"<pre><code>Current time: 2026-01-12 23:19:43.456162\nPage URL: development/mkdocs-guide/\n</code></pre>"},{"location":"development/mkdocs-guide/#api-documentation-mkdocstrings","title":"API Documentation (mkdocstrings)","text":"<p>Auto-generate API docs from Python docstrings:</p> <pre><code>::: freecad_mcp.server\n    options:\n      show_source: true\n      heading_level: 3\n</code></pre> <p>This renders the module's docstrings, classes, and functions automatically.</p> <p>Options:</p> <ul> <li><code>show_source: true</code> - Show source code</li> <li><code>heading_level: 3</code> - Start headings at h3</li> <li><code>members: [func1, func2]</code> - Only show specific members</li> <li><code>filters: [\"!^_\"]</code> - Exclude private members</li> </ul>"},{"location":"development/mkdocs-guide/#navigation","title":"Navigation","text":""},{"location":"development/mkdocs-guide/#features-enabled","title":"Features Enabled","text":"<ul> <li>Instant navigation - Pages load without full refresh</li> <li>Navigation tabs - Top-level sections as tabs</li> <li>Section index pages - Click section to see overview</li> <li>Back to top - Button appears when scrolling</li> <li>Table of contents - Follows scroll position</li> </ul>"},{"location":"development/mkdocs-guide/#images","title":"Images","text":""},{"location":"development/mkdocs-guide/#basic-image","title":"Basic Image","text":"<pre><code>![Alt text](path/to/image.png)\n</code></pre>"},{"location":"development/mkdocs-guide/#image-with-caption","title":"Image with Caption","text":"<pre><code>&lt;figure markdown&gt;\n  ![Alt text](path/to/image.png)\n  &lt;figcaption&gt;This is the caption&lt;/figcaption&gt;\n&lt;/figure&gt;\n</code></pre>"},{"location":"development/mkdocs-guide/#image-alignment","title":"Image Alignment","text":"<pre><code>![Image](image.png){ align=left }\n![Image](image.png){ align=right }\n</code></pre>"},{"location":"development/mkdocs-guide/#image-size","title":"Image Size","text":"<pre><code>![Image](image.png){ width=\"300\" }\n</code></pre>"},{"location":"development/mkdocs-guide/#links","title":"Links","text":""},{"location":"development/mkdocs-guide/#internal-links","title":"Internal Links","text":"<pre><code>[Installation Guide](../getting-started/installation.md)\n[Config section](configuration.md#environment-variables)\n</code></pre>"},{"location":"development/mkdocs-guide/#external-links","title":"External Links","text":"<p>External links automatically open in new tab (Material theme default).</p> <pre><code>[FreeCAD](https://www.freecad.org/)\n</code></pre>"},{"location":"development/mkdocs-guide/#tables","title":"Tables","text":"<p>Standard Markdown tables with sorting enabled:</p> <pre><code>| Column 1 | Column 2 | Column 3 |\n|----------|----------|----------|\n| Data 1   | Data 2   | Data 3   |\n| Data 4   | Data 5   | Data 6   |\n</code></pre>"},{"location":"development/mkdocs-guide/#file-structure","title":"File Structure","text":"<pre><code>docs/\n\u251c\u2500\u2500 index.md                 # Home page\n\u251c\u2500\u2500 variables.yaml           # Macros variables\n\u251c\u2500\u2500 overrides/               # Theme customizations\n\u2502   \u2514\u2500\u2500 .gitkeep\n\u251c\u2500\u2500 assets/                  # Images, favicon, etc.\n\u251c\u2500\u2500 getting-started/\n\u2502   \u251c\u2500\u2500 installation.md\n\u2502   \u251c\u2500\u2500 configuration.md\n\u2502   \u2514\u2500\u2500 quickstart.md\n\u251c\u2500\u2500 guide/\n\u2502   \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 api/\n\u2502   \u2514\u2500\u2500 ...\n\u2514\u2500\u2500 development/\n    \u251c\u2500\u2500 contributing.md\n    \u251c\u2500\u2500 architecture.md\n    \u251c\u2500\u2500 releasing.md\n    \u2514\u2500\u2500 mkdocs-guide.md      # This file\n</code></pre>"},{"location":"development/mkdocs-guide/#common-tasks","title":"Common Tasks","text":""},{"location":"development/mkdocs-guide/#adding-a-new-page","title":"Adding a New Page","text":"<ol> <li>Create the markdown file in the appropriate directory</li> <li>Add to <code>nav:</code> section in <code>mkdocs.yaml</code></li> </ol>"},{"location":"development/mkdocs-guide/#adding-redirects","title":"Adding Redirects","text":"<p>If you move/rename a page, add a redirect in <code>mkdocs.yaml</code>:</p> <pre><code>plugins:\n  - redirects:\n      redirect_maps:\n        'old-page.md': 'new-location/new-page.md'\n</code></pre>"},{"location":"development/mkdocs-guide/#custom-css","title":"Custom CSS","text":"<p>Add custom styles in <code>docs/overrides/stylesheets/extra.css</code> and reference in <code>mkdocs.yaml</code>:</p> <pre><code>extra_css:\n  - overrides/stylesheets/extra.css\n</code></pre>"},{"location":"development/mkdocs-guide/#custom-javascript","title":"Custom JavaScript","text":"<p>Add scripts in <code>docs/overrides/javascripts/extra.js</code> and reference in <code>mkdocs.yaml</code>:</p> <pre><code>extra_javascript:\n  - overrides/javascripts/extra.js\n</code></pre>"},{"location":"development/mkdocs-guide/#troubleshooting","title":"Troubleshooting","text":""},{"location":"development/mkdocs-guide/#macros-not-rendering","title":"Macros Not Rendering","text":"<p>Remember to use custom delimiters: <code>{{ variable }}</code> not <code>{{ variable }}</code>.</p>"},{"location":"development/mkdocs-guide/#git-revision-date-warnings","title":"Git Revision Date Warnings","text":"<p>New files not yet committed will show warnings. Commit the file to fix.</p>"},{"location":"development/mkdocs-guide/#build-errors","title":"Build Errors","text":"<pre><code># Check for syntax errors\nuv run mkdocs build --strict\n\n# Verbose output\nuv run mkdocs build -v\n</code></pre>"},{"location":"development/mkdocs-guide/#serve-not-auto-reloading","title":"Serve Not Auto-Reloading","text":"<p>Some changes (like <code>mkdocs.yaml</code>) require restarting the server.</p>"},{"location":"development/mkdocs-guide/#reference-links","title":"Reference Links","text":"<ul> <li>MkDocs Documentation</li> <li>Material for MkDocs</li> <li>PyMdown Extensions</li> <li>mkdocstrings</li> <li>mkdocs-macros-plugin</li> </ul>"},{"location":"development/releasing/","title":"Release Process","text":""},{"location":"development/releasing/#release-process","title":"Release Process","text":"<p>This project uses component-specific versioning. Each component (MCP Server, Workbench, Macros) has its own version and release cycle, allowing independent updates without affecting other components.</p>"},{"location":"development/releasing/#quick-start","title":"Quick Start","text":"<p>The complete release workflow in order:</p> <pre><code># 1. Pre-release checks\njust release::status                        # Check which components have unreleased changes\njust release::changes-since mcp-server      # View specific changes (or workbench, macro-magnets, macro-export)\njust all                                    # Run all quality checks (must pass)\n\n# 2. Update changelog\njust release::draft-notes mcp-server        # Generate draft notes from commits\n# Then manually edit CHANGELOG.md with appropriate section header\n\n# 3. Version bump (workbench &amp; macros only - MCP Server uses setuptools-scm)\njust release::bump-workbench 1.0.0          # or bump-macro-magnets, bump-macro-export\n\n# 4. Commit changes\ngit add -A\ngit commit -m \"chore: bump workbench to 1.0.0\"  # or appropriate component/message\n\n# 5. Create &amp; push tag (triggers CI/CD automatically)\njust release::tag-workbench 1.0.0           # or tag-mcp-server, tag-macro-magnets, tag-macro-export\n\n# 6. Monitor release at GitHub Actions, then verify\njust release::list-tags\njust release::latest-versions\n\n# 7. Update FreeCAD wiki (macros only)\njust release::wiki-update macro-magnets     # Copies content to clipboard &amp; opens wiki edit page\n</code></pre> Component Bump Command Tag Command MCP Server (none - uses setuptools-scm) <code>just release::tag-mcp-server X.Y.Z</code> Workbench <code>just release::bump-workbench X.Y.Z</code> <code>just release::tag-workbench X.Y.Z</code> Magnets Macro <code>just release::bump-macro-magnets X.Y.Z</code> <code>just release::tag-macro-magnets X.Y.Z</code> Export Macro <code>just release::bump-macro-export X.Y.Z</code> <code>just release::tag-macro-export X.Y.Z</code>"},{"location":"development/releasing/#components-and-their-release-targets","title":"Components and Their Release Targets","text":"Component Tag Format Releases To MCP Server <code>robust-mcp-server-vX.Y.Z</code> PyPI/TestPyPI*, Docker Hub, GitHub Release Robust MCP Bridge Workbench <code>robust-mcp-workbench-vX.Y.Z</code> GitHub Release (archive) Cut Object for Magnets Macro <code>macro-cut-object-for-magnets-vX.Y.Z</code> GitHub Release (archive) Multi Export Macro <code>macro-multi-export-vX.Y.Z</code> GitHub Release (archive) <p>*Stable releases (<code>X.Y.Z</code>) publish to PyPI; non-stable releases (alpha, beta, rc) publish to TestPyPI only.</p>"},{"location":"development/releasing/#version-format","title":"Version Format","text":"<p>All versions follow Semantic Versioning 2.0:</p> <ul> <li><code>X.Y.Z</code> - Stable release (published to PyPI only)</li> <li><code>X.Y.Z-alpha</code> or <code>X.Y.Z-alpha.N</code> - Alpha pre-release (published to TestPyPI only)</li> <li><code>X.Y.Z-beta</code> or <code>X.Y.Z-beta.N</code> - Beta pre-release (published to TestPyPI only)</li> <li><code>X.Y.Z-rc.N</code> - Release candidate (published to TestPyPI only)</li> </ul>"},{"location":"development/releasing/#release-workflow-overview","title":"Release Workflow Overview","text":"<p>Releases follow a two-step process:</p> <ol> <li>Bump: Update version in all source files locally, then commit</li> <li>Tag: Create and push the git tag (triggers CI/CD)</li> </ol> <p>This ensures the version in source files matches the git tag on the same commit.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  1. just release::bump-&lt;component&gt; X.Y.Z                        \u2502\n\u2502     \u2514\u2500\u2500 Updates version in all relevant files                   \u2502\n\u2502                                                                 \u2502\n\u2502  2. git add -A &amp;&amp; git commit -m \"chore: bump ... to X.Y.Z\"      \u2502\n\u2502     \u2514\u2500\u2500 Commit the version changes                              \u2502\n\u2502                                                                 \u2502\n\u2502  3. just release::tag-&lt;component&gt; X.Y.Z                         \u2502\n\u2502     \u2514\u2500\u2500 Verifies versions match, then creates &amp; pushes tag      \u2502\n\u2502                                                                 \u2502\n\u2502  4. GitHub Actions workflow runs automatically                  \u2502\n\u2502     \u2514\u2500\u2500 Verifies versions, builds, and publishes release        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"development/releasing/#pre-release-checklist","title":"Pre-Release Checklist","text":"<p>Before creating any release, complete these steps:</p>"},{"location":"development/releasing/#1-check-release-status","title":"1. Check Release Status","text":"<p>See which components have unreleased changes:</p> <pre><code>just release::status\n</code></pre> <p>This shows the number of commits since the last release for each component.</p>"},{"location":"development/releasing/#2-review-changes","title":"2. Review Changes","text":"<p>View the specific changes for the component you're releasing:</p> <pre><code># For MCP Server\njust release::changes-since mcp-server\n\n# For Workbench\njust release::changes-since workbench\n\n# For Macros\njust release::changes-since macro-magnets\njust release::changes-since macro-export\n</code></pre>"},{"location":"development/releasing/#3-run-all-quality-checks","title":"3. Run All Quality Checks","text":"<p>Ensure all tests and checks pass:</p> <pre><code>just all\n</code></pre> <p>For a more thorough check including integration tests:</p> <pre><code>just all-with-integration\n</code></pre>"},{"location":"development/releasing/#4-update-changelogmd","title":"4. Update CHANGELOG.md","text":"<p>The changelog uses a multi-component structure. Each release date section contains entries for each component that was released.</p>"},{"location":"development/releasing/#draft-release-notes","title":"Draft Release Notes","text":"<p>Use the <code>draft-notes</code> command to generate a starting point from conventional commits:</p> <pre><code># Generate draft notes for a component\njust release::draft-notes mcp-server\njust release::draft-notes workbench\njust release::draft-notes macro-magnets\njust release::draft-notes macro-export\n</code></pre> <p>This categorizes commits by type (feat, fix, refactor, etc.) to help you write the changelog entry.</p>"},{"location":"development/releasing/#changelog-structure","title":"Changelog Structure","text":"<p>Add entries under the appropriate component section in <code>CHANGELOG.md</code>:</p> <pre><code>## YYYY-MM-DD - Release Title (optional)\n\n### MCP Server vX.Y.Z\n\nBrief description of the release.\n\n#### Added\n- New feature description\n\n#### Changed\n- Changed behavior description\n\n#### Fixed\n- Bug fix description\n\n---\n\n### Robust MCP Bridge Workbench vX.Y.Z\n\n...\n</code></pre> <p>Important: The changelog section header format must match exactly for the GitHub Release workflow to extract it:</p> <ul> <li>MCP Server: <code>### MCP Server vX.Y.Z</code></li> <li>Workbench: <code>### Robust MCP Bridge Workbench vX.Y.Z</code></li> <li>Magnets Macro: <code>### Cut Object for Magnets Macro vX.Y.Z</code></li> <li>Export Macro: <code>### Multi Export Macro vX.Y.Z</code></li> </ul> <p>The release workflows automatically extract the changelog section and include it in the GitHub Release body.</p>"},{"location":"development/releasing/#releasing-each-component","title":"Releasing Each Component","text":""},{"location":"development/releasing/#mcp-server-release","title":"MCP Server Release","text":"<p>The MCP Server is the main Python package. It uses <code>setuptools-scm</code> to derive version from git tags at build time, so there's no version bump step needed.</p> <pre><code># 1. Ensure all changes are committed\ngit status  # Should show clean working tree\n\n# 2. Update CHANGELOG.md and commit\ngit add CHANGELOG.md\ngit commit -m \"docs: update changelog for MCP Server v1.0.0\"\n\n# 3. Create and push the release tag\njust release::tag-mcp-server 1.0.0\n</code></pre> <p>What happens automatically:</p> <ol> <li>GitHub Actions validates the tag format</li> <li>Builds Python wheel and source distribution (version from tag)</li> <li>Tests installation on Ubuntu and macOS</li> <li>Publishes to PyPI (or TestPyPI for alpha, beta, and rc versions)</li> <li>Builds multi-architecture Docker image (amd64 + arm64)</li> <li>Pushes to Docker Hub as <code>spkane/freecad-robust-mcp:1.0.0</code></li> <li>Creates GitHub Release with wheel and tar.gz artifacts</li> </ol> <p>Pre-release versions:</p> <pre><code># Alpha (goes to TestPyPI only)\njust release::tag-mcp-server 1.0.0-alpha.1\n\n# Beta (goes to TestPyPI only)\njust release::tag-mcp-server 1.0.0-beta.1\n\n# Release candidate (goes to TestPyPI only)\njust release::tag-mcp-server 1.0.0-rc.1\n</code></pre>"},{"location":"development/releasing/#robust-mcp-bridge-workbench-release","title":"Robust MCP Bridge Workbench Release","text":"<p>The workbench is a FreeCAD addon that provides the Robust MCP Bridge GUI.</p> <pre><code># 1. Bump version in source files\njust release::bump-workbench 1.0.0\n\n# 2. Review and commit the changes\ngit diff  # Review changes\ngit add -A\ngit commit -m \"chore: bump workbench to 1.0.0\"\n\n# 3. Create and push the release tag\njust release::tag-workbench 1.0.0\n</code></pre> <p>Files updated by <code>bump-workbench</code>:</p> <ul> <li><code>addon/FreecadRobustMCPBridge/freecad_mcp_bridge/__init__.py</code> (<code>__version__</code>)</li> <li><code>package.xml</code> (workbench section: <code>&lt;version&gt;</code> and <code>&lt;date&gt;</code>)</li> </ul> <p>What happens automatically:</p> <ol> <li>GitHub Actions validates the tag format</li> <li>Verifies version in source files matches tag</li> <li>Creates archive (tar.gz and zip)</li> <li>Creates GitHub Release with the archives</li> </ol>"},{"location":"development/releasing/#macro-releases","title":"Macro Releases","text":"<p>Each macro can be released independently.</p> <p>Cut Object for Magnets Macro:</p> <pre><code># 1. Bump version in source files\njust release::bump-macro-magnets 1.0.0\n\n# 2. Review and commit the changes\ngit diff  # Review changes\ngit add -A\ngit commit -m \"chore: bump Cut Object for Magnets macro to 1.0.0\"\n\n# 3. Create and push the release tag\njust release::tag-macro-magnets 1.0.0\n</code></pre> <p>Multi Export Macro:</p> <pre><code># 1. Bump version in source files\njust release::bump-macro-export 1.0.0\n\n# 2. Review and commit the changes\ngit diff  # Review changes\ngit add -A\ngit commit -m \"chore: bump Multi Export macro to 1.0.0\"\n\n# 3. Create and push the release tag\njust release::tag-macro-export 1.0.0\n</code></pre> <p>Files updated by macro bump commands:</p> <ul> <li><code>macros/&lt;MacroDir&gt;/&lt;Macro&gt;.FCMacro</code> (<code>__Version__</code> and <code>__Date__</code>)</li> <li><code>macros/&lt;MacroDir&gt;/README-&lt;Macro&gt;.md</code> (<code>**Version:**</code>)</li> <li><code>macros/&lt;MacroDir&gt;/wiki-source.txt</code> (<code>|Version=</code> and <code>|Date=</code>)</li> <li><code>package.xml</code> (macro section: <code>&lt;version&gt;</code> and <code>&lt;date&gt;</code>)</li> </ul> <p>What happens automatically:</p> <ol> <li>GitHub Actions validates the tag format</li> <li>Verifies version in source files matches tag</li> <li>Creates archive (tar.gz and zip)</li> <li>Creates GitHub Release with the archives</li> </ol>"},{"location":"development/releasing/#verifying-a-release","title":"Verifying a Release","text":""},{"location":"development/releasing/#check-github-actions","title":"Check GitHub Actions","text":"<p>After pushing a tag, monitor the release workflow:</p> <ol> <li>Go to GitHub Actions</li> <li>Find the workflow run triggered by your tag</li> <li>Verify all steps complete successfully</li> </ol>"},{"location":"development/releasing/#verify-published-artifacts","title":"Verify Published Artifacts","text":"<p>For MCP Server:</p> <pre><code># Check PyPI\npip index versions freecad-robust-mcp\n\n# Check Docker Hub\ndocker pull spkane/freecad-robust-mcp:1.0.0\n</code></pre> <p>For Workbench/Macros:</p> <ul> <li>Check the GitHub Releases page for the archive downloads</li> <li>Verify the <code>package.xml</code> version was updated</li> </ul>"},{"location":"development/releasing/#managing-release-tags","title":"Managing Release Tags","text":""},{"location":"development/releasing/#list-all-tags","title":"List All Tags","text":"<pre><code># All tags grouped by component\njust release::list-tags\n\n# Latest version of each component\njust release::latest-versions\n</code></pre>"},{"location":"development/releasing/#delete-a-tag-if-needed","title":"Delete a Tag (If Needed)","text":"<p>If a release has issues and needs to be removed:</p> <pre><code>just release::delete-tag robust-mcp-server-v1.0.0\n</code></pre> <p>Deleting Published Releases</p> <p>Deleting a tag does not unpublish from PyPI or Docker Hub. Contact the respective registries to remove published artifacts if necessary.</p>"},{"location":"development/releasing/#preview-a-release-dry-run","title":"Preview a Release (Dry Run)","text":"<p>To see what a release tag would look like without creating it:</p> <pre><code>just release::dry-run-tag mcp-server 1.0.0\njust release::dry-run-tag workbench 1.0.0\njust release::dry-run-tag macro-magnets 1.0.0\n</code></pre>"},{"location":"development/releasing/#troubleshooting","title":"Troubleshooting","text":""},{"location":"development/releasing/#release-workflow-failed","title":"Release Workflow Failed","text":"<ol> <li>Check the GitHub Actions logs for the specific error</li> <li>Common issues:</li> <li>Invalid version format (must be semver)</li> <li>Version mismatch between source files and tag</li> <li>Missing secrets (PyPI token, Docker credentials)</li> <li>Tests failing during the release build</li> </ol>"},{"location":"development/releasing/#version-mismatch-error","title":"Version Mismatch Error","text":"<p>If the workflow fails with \"Version mismatch\":</p> <pre><code># You forgot to bump the version before tagging\n# Delete the tag\njust release::delete-tag &lt;full-tag-name&gt;\n\n# Bump the version\njust release::bump-&lt;component&gt; X.Y.Z\n\n# Commit the changes\ngit add -A &amp;&amp; git commit -m \"chore: bump &lt;component&gt; to X.Y.Z\"\n\n# Create the tag again\njust release::tag-&lt;component&gt; X.Y.Z\n</code></pre>"},{"location":"development/releasing/#tag-already-exists","title":"Tag Already Exists","text":"<p>If you try to create a tag that already exists:</p> <pre><code># Delete the existing tag first\njust release::delete-tag robust-mcp-server-v1.0.0\n\n# Then create the new tag\njust release::tag-mcp-server 1.0.0\n</code></pre>"},{"location":"development/releasing/#wrong-version-released","title":"Wrong Version Released","text":"<ol> <li>Delete the tag: <code>just release::delete-tag &lt;tag&gt;</code></li> <li>Create a new release with the correct version</li> <li>For PyPI: you cannot re-upload the same version; increment the patch version instead</li> </ol>"},{"location":"development/releasing/#release-cadence-recommendations","title":"Release Cadence Recommendations","text":"<ul> <li>MCP Server: Release when there are significant new features or important bug fixes</li> <li>Workbench: Release in sync with server changes that affect the bridge protocol</li> <li>Macros: Release independently when macro functionality changes</li> </ul>"},{"location":"development/releasing/#updating-the-freecad-wiki","title":"Updating the FreeCAD Wiki","text":"<p>After releasing a macro, you should update its FreeCAD wiki page. The <code>wiki-source.txt</code> files are automatically updated by the <code>bump-macro-*</code> commands with the new version and date.</p>"},{"location":"development/releasing/#wiki-update-commands","title":"Wiki Update Commands","text":"<pre><code># Check differences between local and live wiki\njust release::wiki-diff macro-magnets\njust release::wiki-diff macro-export\n\n# View the wiki source content locally\njust release::wiki-show macro-magnets\njust release::wiki-show macro-export\n\n# Update the wiki (copies to clipboard and opens edit page)\njust release::wiki-update macro-magnets\njust release::wiki-update macro-export\n</code></pre>"},{"location":"development/releasing/#wiki-update-workflow","title":"Wiki Update Workflow","text":"<p>The <code>wiki-update</code> command provides a safe, assisted workflow:</p> <ol> <li>Copies the updated wiki-source.txt content to your clipboard</li> <li>Opens the FreeCAD wiki edit page in your browser</li> <li>Displays step-by-step instructions</li> </ol> <p>Manual steps after running the command:</p> <ol> <li>Log in to your FreeCAD wiki account if prompted</li> <li>Select all content in the edit box (Ctrl+A / Cmd+A)</li> <li>Paste the new content (Ctrl+V / Cmd+V)</li> <li>Add an edit summary like \"Update to version X.Y.Z\"</li> <li>Click \"Show preview\" to verify changes</li> <li>Click \"Save changes\" when satisfied</li> </ol> <p>Wiki Account Required</p> <p>You need a FreeCAD wiki account to edit pages. Register at wiki.freecad.org if you don't have one.</p>"},{"location":"development/releasing/#macro-shortcuts","title":"Macro Shortcuts","text":"<p>The wiki commands accept multiple aliases for convenience:</p> Macro Aliases Cut Object for Magnets <code>macro-magnets</code>, <code>magnets</code>, <code>cut</code> Multi Export <code>macro-export</code>, <code>export</code>, <code>multi</code>"},{"location":"development/releasing/#quick-reference","title":"Quick Reference","text":"<pre><code># Check what needs releasing\njust release::status\n\n# View changes for a component\njust release::changes-since mcp-server\n\n# Draft changelog entries from commits\njust release::draft-notes mcp-server\njust release::draft-notes workbench\njust release::draft-notes macro-magnets\njust release::draft-notes macro-export\n\n# Bump versions (for workbench and macros)\njust release::bump-workbench 1.0.0\njust release::bump-macro-magnets 1.0.0\njust release::bump-macro-export 1.0.0\n\n# Commit version changes\ngit add -A &amp;&amp; git commit -m \"chore: bump &lt;component&gt; to X.Y.Z\"\n\n# Create releases (verifies versions, creates and pushes tag)\njust release::tag-mcp-server 1.0.0\njust release::tag-workbench 1.0.0\njust release::tag-macro-magnets 1.0.0\njust release::tag-macro-export 1.0.0\n\n# List existing releases\njust release::list-tags\njust release::latest-versions\n\n# Extract changelog for a version (used by CI)\njust release::extract-changelog mcp-server 1.0.0\n\n# Update FreeCAD wiki for macros (after release)\njust release::wiki-diff macro-magnets   # Check differences\njust release::wiki-update macro-magnets # Copy to clipboard &amp; open edit page\njust release::wiki-update macro-export\n\n# Delete a tag if needed\njust release::delete-tag &lt;full-tag-name&gt;\n</code></pre>"},{"location":"getting-started/configuration/","title":"Configuration","text":""},{"location":"getting-started/configuration/#configuration","title":"Configuration","text":"<p>Configure the FreeCAD Robust MCP Server using environment variables and MCP client settings.</p>"},{"location":"getting-started/configuration/#environment-variables","title":"Environment Variables","text":"Variable Description Default <code>FREECAD_MODE</code> Connection mode: <code>xmlrpc</code>, <code>socket</code>, or <code>embedded</code> <code>xmlrpc</code> <code>FREECAD_PATH</code> Path to FreeCAD's lib directory (embedded mode only) Auto-detect <code>FREECAD_SOCKET_HOST</code> Socket/XML-RPC server hostname <code>localhost</code> <code>FREECAD_SOCKET_PORT</code> JSON-RPC socket server port <code>9876</code> <code>FREECAD_XMLRPC_PORT</code> XML-RPC server port <code>9875</code> <code>FREECAD_TIMEOUT_MS</code> Execution timeout in ms <code>30000</code>"},{"location":"getting-started/configuration/#connection-modes","title":"Connection Modes","text":"<p>The Robust MCP Server supports three connection modes:</p> Mode Description Platform Support <code>xmlrpc</code> Connects to FreeCAD via XML-RPC (port 9875) All platforms (recommended) <code>socket</code> Connects via JSON-RPC socket (port 9876) All platforms <code>embedded</code> Imports FreeCAD directly into process Linux only (crashes on macOS/Windows)"},{"location":"getting-started/configuration/#xml-rpc-mode-recommended","title":"XML-RPC Mode (Recommended)","text":"<p>The default and recommended mode. Works on all platforms.</p> <pre><code>export FREECAD_MODE=xmlrpc\nfreecad-mcp\n</code></pre>"},{"location":"getting-started/configuration/#socket-mode","title":"Socket Mode","text":"<p>Alternative to XML-RPC using JSON-RPC over TCP sockets.</p> <pre><code>export FREECAD_MODE=socket\nfreecad-mcp\n</code></pre>"},{"location":"getting-started/configuration/#embedded-mode-linux-only","title":"Embedded Mode (Linux Only)","text":"<p>Linux Only</p> <p>Embedded mode only works on Linux. On macOS and Windows, it will crash because FreeCAD's <code>FreeCAD.so</code> library links to its bundled Python, which conflicts with external Python interpreters.</p> <p>Embedded mode imports FreeCAD directly into the Robust MCP Server process for fastest execution.</p> <pre><code>export FREECAD_MODE=embedded\nexport FREECAD_PATH=/usr/lib/freecad/lib\nfreecad-mcp\n</code></pre> <p>Note: Embedded mode testing is minimal. For production use, prefer <code>xmlrpc</code> or <code>socket</code> modes.</p>"},{"location":"getting-started/configuration/#mcp-client-configuration","title":"MCP Client Configuration","text":""},{"location":"getting-started/configuration/#claude-code-claude-desktop","title":"Claude Code / Claude Desktop","text":"<p>Add to <code>~/.claude/claude_desktop_config.json</code> or a project <code>.mcp.json</code> file:</p> <pre><code>{\n  \"mcpServers\": {\n    \"freecad\": {\n      \"command\": \"freecad-mcp\",\n      \"env\": {\n        \"FREECAD_MODE\": \"xmlrpc\"\n      }\n    }\n  }\n}\n</code></pre> <p>If installed from source with mise/uv:</p> <pre><code>{\n  \"mcpServers\": {\n    \"freecad\": {\n      \"command\": \"/path/to/mise/shims/uv\",\n      \"args\": [\"run\", \"--project\", \"/path/to/freecad-robust-mcp-and-more\", \"freecad-mcp\"],\n      \"env\": {\n        \"FREECAD_MODE\": \"xmlrpc\"\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"getting-started/configuration/#docker-configuration","title":"Docker Configuration","text":"<pre><code>{\n  \"mcpServers\": {\n    \"freecad\": {\n      \"command\": \"docker\",\n      \"args\": [\n        \"run\", \"--rm\", \"-i\",\n        \"-e\", \"FREECAD_MODE=xmlrpc\",\n        \"-e\", \"FREECAD_SOCKET_HOST=host.docker.internal\",\n        \"spkane/freecad-robust-mcp\"\n      ]\n    }\n  }\n}\n</code></pre>"},{"location":"getting-started/configuration/#gui-vs-headless-mode","title":"GUI vs Headless Mode","text":"<p>FreeCAD can run in two modes, and the Robust MCP Server works with both:</p> Feature Headless Mode GUI Mode Object creation Yes Yes Boolean operations Yes Yes Export (STEP, STL, etc.) Yes Yes Save documents Yes Yes Screenshots No Yes Object colors No Yes Object visibility No Yes Camera control No Yes Interactive selection No Yes"},{"location":"getting-started/configuration/#starting-freecad","title":"Starting FreeCAD","text":"<p>GUI Mode (for interactive work with visual feedback):</p> <pre><code># Using just commands (from source)\njust freecad::run-gui\n\n# Or start FreeCAD normally and click \"Start Bridge\" in the workbench\n</code></pre> <p>Headless Mode (for automation, CI/CD, or when you don't need visual feedback):</p> <pre><code># Using just commands (from source)\njust freecad::run-headless\n\n# Or run directly with FreeCADCmd\nFreeCADCmd ~/.local/share/FreeCAD/Mod/FreecadRobustMCPBridge/freecad_mcp_bridge/blocking_bridge.py\n</code></pre>"},{"location":"getting-started/configuration/#next-steps","title":"Next Steps","text":"<ul> <li>Quick Start - Create your first model with AI assistance</li> <li>Connection Modes - Detailed guide on different connection modes</li> </ul>"},{"location":"getting-started/installation/","title":"Installation","text":""},{"location":"getting-started/installation/#installation","title":"Installation","text":"<p>This guide covers installing the FreeCAD Robust MCP Server and connecting it to your AI assistant.</p>"},{"location":"getting-started/installation/#requirements","title":"Requirements","text":"<ul> <li>FreeCAD 0.21+ or 1.0+ (with Python 3.11)</li> <li>Python 3.11 (must match FreeCAD's bundled Python version)</li> <li>An MCP-compatible AI assistant (Claude Code, Cursor, etc.)</li> </ul>"},{"location":"getting-started/installation/#installation-methods","title":"Installation Methods","text":""},{"location":"getting-started/installation/#method-1-pip-recommended","title":"Method 1: pip (Recommended)","text":"<p>The simplest way to install the Robust MCP Server:</p> <pre><code>pip install freecad-robust-mcp\n</code></pre>"},{"location":"getting-started/installation/#method-2-from-source-for-development","title":"Method 2: From Source (for Development)","text":"<pre><code>git clone https://github.com/spkane/freecad-robust-mcp-and-more.git\ncd freecad-robust-mcp-and-more\n\n# Install mise (if not already installed)\ncurl https://mise.run | sh\n\nmise trust\nmise install\njust setup\n</code></pre>"},{"location":"getting-started/installation/#method-3-docker","title":"Method 3: Docker","text":"<p>Run the Robust MCP Server in a container:</p> <pre><code># Pull from Docker Hub\ndocker pull spkane/freecad-robust-mcp\n\n# Or build locally\ndocker build -t freecad-robust-mcp .\n</code></pre> <p>Note: The Docker container runs the Robust MCP Server only\u2014it does not include FreeCAD itself. You must run FreeCAD with the Robust MCP Bridge workbench on your host machine (or in a separate container) and configure the Robust MCP Server to connect via <code>xmlrpc</code> or <code>socket</code> mode.</p> <p>Why embedded mode doesn't work with Docker: Embedded mode requires FreeCAD and the Robust MCP Server to run in the same process, which is impossible when FreeCAD runs on the host and the Robust MCP Server runs inside a Docker container. Additionally, embedded mode fails on macOS due to ABI incompatibility with FreeCAD's bundled Python libraries (<code>libpython3.11.dylib</code>). Always use <code>xmlrpc</code> or <code>socket</code> mode for Docker deployments.</p>"},{"location":"getting-started/installation/#installing-the-robust-mcp-bridge-workbench","title":"Installing the Robust MCP Bridge Workbench","text":"<p>The Robust MCP Bridge Workbench runs inside FreeCAD and provides the connection point for the Robust MCP Server.</p>"},{"location":"getting-started/installation/#via-freecad-addon-manager-recommended","title":"Via FreeCAD Addon Manager (Recommended)","text":"<ol> <li>Open FreeCAD</li> <li>Go to Tools &gt; Addon Manager</li> <li>Search for \"FreeCAD Robust MCP Suite\" or \"Robust MCP Bridge\"</li> <li>Click Install</li> <li>Restart FreeCAD</li> </ol>"},{"location":"getting-started/installation/#manual-installation","title":"Manual Installation","text":"<ol> <li>Download the latest release from GitHub Releases</li> <li>Extract to your FreeCAD Mod directory:</li> <li>Linux: <code>~/.local/share/FreeCAD/Mod/</code></li> <li>macOS: <code>~/Library/Application Support/FreeCAD/Mod/</code></li> <li>Windows: <code>%APPDATA%\\FreeCAD\\Mod\\</code></li> <li>Restart FreeCAD</li> </ol>"},{"location":"getting-started/installation/#verifying-installation","title":"Verifying Installation","text":"<p>After installation, verify everything is working:</p>"},{"location":"getting-started/installation/#step-1-start-freecad-with-the-robust-mcp-bridge","title":"Step 1: Start FreeCAD with the Robust MCP Bridge","text":"<ol> <li>Start FreeCAD and select the Robust MCP Bridge workbench from the workbench selector dropdown</li> <li>Click \"Start MCP Bridge\" in the toolbar (or use the MCP Bridge menu)</li> <li>Check the FreeCAD console for confirmation messages:</li> </ol> <pre><code>MCP Bridge started!\n  - XML-RPC: localhost:9875\n  - Socket:  localhost:9876\n</code></pre>"},{"location":"getting-started/installation/#step-2-verify-the-robust-mcp-server","title":"Step 2: Verify the Robust MCP Server","text":"<p>Test that the Robust MCP Server command is available:</p> <pre><code># With pip installation\nfreecad-mcp --help\n\n# With source installation\nuv run freecad-mcp --help\n</code></pre>"},{"location":"getting-started/installation/#step-3-test-the-connection","title":"Step 3: Test the Connection","text":"<p>With FreeCAD running and the bridge started, you can verify connectivity:</p> <pre><code># Quick connectivity test using curl (XML-RPC)\ncurl -X POST http://localhost:9875 \\\n  -H \"Content-Type: text/xml\" \\\n  -d '&lt;?xml version=\"1.0\"?&gt;&lt;methodCall&gt;&lt;methodName&gt;ping&lt;/methodName&gt;&lt;/methodCall&gt;'\n</code></pre> <p>A successful response indicates the bridge is working correctly.</p>"},{"location":"getting-started/installation/#next-steps","title":"Next Steps","text":"<ul> <li>Configuration - Set up environment variables and MCP client settings</li> <li>Quick Start - Create your first model with AI assistance</li> </ul>"},{"location":"getting-started/quickstart/","title":"Quick Start","text":""},{"location":"getting-started/quickstart/#quick-start","title":"Quick Start","text":"<p>Get up and running with AI-assisted FreeCAD modeling in minutes.</p>"},{"location":"getting-started/quickstart/#prerequisites","title":"Prerequisites","text":"<p>Before starting, ensure you have:</p> <ol> <li>FreeCAD installed with the Robust MCP Bridge workbench</li> <li>The MCP server installed (<code>pip install freecad-robust-mcp</code>)</li> <li>Your MCP client configured (see Configuration)</li> </ol>"},{"location":"getting-started/quickstart/#step-1-start-freecad-with-the-mcp-bridge","title":"Step 1: Start FreeCAD with the MCP Bridge","text":""},{"location":"getting-started/quickstart/#option-a-gui-mode-recommended-for-getting-started","title":"Option A: GUI Mode (Recommended for getting started)","text":"<ol> <li>Open FreeCAD</li> <li>Switch to the Robust MCP Bridge workbench</li> <li>Click Start Bridge in the toolbar</li> <li>You should see: \"MCP Bridge started! XML-RPC: localhost:9875, Socket: localhost:9876\"</li> </ol>"},{"location":"getting-started/quickstart/#option-b-headless-mode-for-automation","title":"Option B: Headless Mode (For automation)","text":"<pre><code># If installed via Addon Manager (Linux)\nFreeCADCmd ~/.local/share/FreeCAD/Mod/FreecadRobustMCPBridge/freecad_mcp_bridge/blocking_bridge.py\n\n# If working from source\njust freecad::run-headless\n</code></pre>"},{"location":"getting-started/quickstart/#step-2-connect-your-ai-assistant","title":"Step 2: Connect Your AI Assistant","text":"<p>With FreeCAD and the MCP server configured, open your AI assistant (Claude Code, Cursor, etc.) and verify the connection:</p> <pre><code>\"Check the FreeCAD connection status\"\n</code></pre> <p>The AI should respond with information about the connection mode, FreeCAD version, and whether GUI is available.</p>"},{"location":"getting-started/quickstart/#step-3-create-your-first-model","title":"Step 3: Create Your First Model","text":"<p>Try these example prompts with your AI assistant:</p>"},{"location":"getting-started/quickstart/#simple-box","title":"Simple Box","text":"<pre><code>\"Create a new FreeCAD document and add a box that is 20mm x 10mm x 5mm\"\n</code></pre>"},{"location":"getting-started/quickstart/#parametric-part-with-fillet","title":"Parametric Part with Fillet","text":"<pre><code>\"Create a parametric bracket:\n1. Start with a 50x30mm rectangular sketch\n2. Extrude it 10mm\n3. Add a 3mm fillet to all edges\"\n</code></pre>"},{"location":"getting-started/quickstart/#export-for-3d-printing","title":"Export for 3D Printing","text":"<pre><code>\"Export the current model to STL format for 3D printing\"\n</code></pre>"},{"location":"getting-started/quickstart/#step-4-explore-available-tools","title":"Step 4: Explore Available Tools","text":"<p>The MCP server provides 82+ tools organized into categories:</p> Category Examples Primitives <code>create_box</code>, <code>create_cylinder</code>, <code>create_sphere</code> PartDesign <code>create_sketch</code>, <code>pad_sketch</code>, <code>pocket_sketch</code> Operations <code>boolean_operation</code>, <code>fillet_edges</code>, <code>chamfer_edges</code> Export <code>export_stl</code>, <code>export_step</code>, <code>export_3mf</code> View (GUI) <code>get_screenshot</code>, <code>set_object_color</code> <p>See the Tools Reference for the complete list.</p>"},{"location":"getting-started/quickstart/#example-workflows","title":"Example Workflows","text":""},{"location":"getting-started/quickstart/#create-a-mounting-bracket","title":"Create a Mounting Bracket","text":"<pre><code>\"Help me create a mounting bracket with:\n- 60x40mm base plate, 5mm thick\n- Two mounting holes (5mm diameter) at the corners\n- A vertical wall 30mm tall on one edge\n- 2mm fillets on all external edges\"\n</code></pre>"},{"location":"getting-started/quickstart/#modify-an-existing-model","title":"Modify an Existing Model","text":"<pre><code>\"Open my_part.FCStd and:\n1. List all the objects in the document\n2. Change the height of the Pad feature from 10mm to 15mm\n3. Save the document\"\n</code></pre>"},{"location":"getting-started/quickstart/#debug-a-macro","title":"Debug a Macro","text":"<pre><code>\"Read the macro 'MyMacro' and explain what it does.\nThen run it and show me any errors.\"\n</code></pre>"},{"location":"getting-started/quickstart/#tips-for-effective-ai-assisted-modeling","title":"Tips for Effective AI-Assisted Modeling","text":"<ol> <li>Be specific about dimensions - Include units (mm, cm, inches) in your requests</li> <li>Use parametric approaches - Ask for PartDesign workflows instead of direct Part operations for parts you'll modify</li> <li>Check console output - If something goes wrong, ask the AI to check the FreeCAD console for errors</li> <li>Take screenshots - In GUI mode, ask for screenshots to verify the model looks correct</li> <li>Save frequently - Ask the AI to save your document after significant changes</li> </ol>"},{"location":"getting-started/quickstart/#next-steps","title":"Next Steps","text":"<ul> <li>Tools Reference - Complete API reference for all tools</li> <li>User Guide - Detailed workflows and best practices</li> <li>Connection Modes - Understanding connection modes</li> </ul>"},{"location":"guide/connection-modes/","title":"Connection Modes","text":""},{"location":"guide/connection-modes/#connection-modes","title":"Connection Modes","text":"<p>The FreeCAD Robust MCP Server supports multiple ways to connect to FreeCAD. Choose the mode that best fits your workflow.</p>"},{"location":"guide/connection-modes/#overview","title":"Overview","text":"Mode Description Platform Best For <code>xmlrpc</code> XML-RPC protocol (port 9875) All platforms Production use (recommended) <code>socket</code> JSON-RPC over TCP sockets All platforms Alternative to XML-RPC <code>embedded</code> FreeCAD imported into MCP process Linux only Fastest execution, CI/automation"},{"location":"guide/connection-modes/#xml-rpc-mode-recommended","title":"XML-RPC Mode (Recommended)","text":"<p>XML-RPC mode is the default and recommended connection method. It works on all platforms and provides robust, reliable communication.</p>"},{"location":"guide/connection-modes/#how-it-works","title":"How It Works","text":"<pre><code>MCP Client &lt;--stdio--&gt; Robust MCP Server &lt;--XML-RPC:9875--&gt; FreeCAD\n</code></pre> <p>The Robust MCP Server communicates with FreeCAD via XML-RPC protocol on port 9875.</p>"},{"location":"guide/connection-modes/#setup","title":"Setup","text":"<ol> <li>Start FreeCAD with the Robust MCP Bridge workbench</li> <li>Click Start Bridge (or it auto-starts if configured)</li> <li>Configure the Robust MCP Server:</li> </ol> <pre><code>export FREECAD_MODE=xmlrpc\nexport FREECAD_XMLRPC_PORT=9875  # default\nfreecad-mcp\n</code></pre>"},{"location":"guide/connection-modes/#advantages","title":"Advantages","text":"<ul> <li>Works on all platforms (macOS, Linux, Windows)</li> <li>Process isolation (FreeCAD crash doesn't affect Robust MCP Server)</li> <li>Supports both GUI and headless FreeCAD</li> </ul>"},{"location":"guide/connection-modes/#socket-mode","title":"Socket Mode","text":"<p>Socket mode uses JSON-RPC over TCP sockets instead of XML-RPC.</p>"},{"location":"guide/connection-modes/#how-it-works_1","title":"How It Works","text":"<pre><code>MCP Client &lt;--stdio--&gt; Robust MCP Server &lt;--JSON-RPC:9876--&gt; FreeCAD\n</code></pre>"},{"location":"guide/connection-modes/#setup_1","title":"Setup","text":"<pre><code>export FREECAD_MODE=socket\nexport FREECAD_SOCKET_HOST=localhost\nexport FREECAD_SOCKET_PORT=9876\nfreecad-mcp\n</code></pre>"},{"location":"guide/connection-modes/#advantages_1","title":"Advantages","text":"<ul> <li>JSON-based protocol (easier to debug)</li> <li>Lower overhead than XML-RPC</li> <li>Works on all platforms</li> </ul>"},{"location":"guide/connection-modes/#embedded-mode-linux-only","title":"Embedded Mode (Linux Only)","text":"<p>Platform Limitation</p> <p>Embedded mode only works on Linux. On macOS and Windows, it causes crashes due to Python ABI incompatibility.</p> <p>Embedded mode imports FreeCAD directly into the Robust MCP Server process, providing the fastest execution.</p>"},{"location":"guide/connection-modes/#why-it-crashes-on-macoswindows","title":"Why It Crashes on macOS/Windows","text":"<p>FreeCAD's <code>FreeCAD.so</code> library links to <code>@rpath/libpython3.11.dylib</code> (FreeCAD's bundled Python). When you try to import it from a different Python interpreter (even the same version), it causes a crash because the Python runtime state is incompatible.</p>"},{"location":"guide/connection-modes/#setup-linux-only","title":"Setup (Linux Only)","text":"<pre><code>export FREECAD_MODE=embedded\nexport FREECAD_PATH=/usr/lib/freecad/lib  # Adjust for your system\nfreecad-mcp\n</code></pre>"},{"location":"guide/connection-modes/#advantages_2","title":"Advantages","text":"<ul> <li>Fastest execution (no IPC overhead)</li> <li>No need to start FreeCAD separately</li> <li>Works in CI/CD environments on Linux</li> </ul>"},{"location":"guide/connection-modes/#limitations","title":"Limitations","text":"<ul> <li>Linux only - crashes on macOS and Windows</li> <li>Headless only (no GUI features)</li> <li>Minimal testing - embedded mode receives less testing than xmlrpc/socket modes</li> <li>Cannot access FreeCAD GUI features (screenshots, colors, etc.)</li> </ul>"},{"location":"guide/connection-modes/#testing-status","title":"Testing Status","text":"<p>Embedded mode is tested in the CI pipeline with unit tests that mock FreeCAD. However, full integration testing with actual FreeCAD is limited compared to the xmlrpc and socket modes which are tested with the FreeCAD AppImage.</p>"},{"location":"guide/connection-modes/#choosing-a-mode","title":"Choosing a Mode","text":"<pre><code>graph TD\n    A[Need FreeCAD Robust MCP?] --&gt; B{Platform?}\n    B --&gt;|macOS/Windows| C[Use xmlrpc or socket]\n    B --&gt;|Linux| D{Need GUI features?}\n    D --&gt;|Yes| C\n    D --&gt;|No| E{Need fastest execution?}\n    E --&gt;|Yes| F[Consider embedded]\n    E --&gt;|No| C</code></pre>"},{"location":"guide/connection-modes/#recommendations","title":"Recommendations","text":"Use Case Recommended Mode General development <code>xmlrpc</code> Interactive modeling with GUI <code>xmlrpc</code> CI/CD pipelines on Linux <code>embedded</code> Docker containers <code>xmlrpc</code> Remote FreeCAD instance <code>xmlrpc</code> Debugging connection issues <code>socket</code>"},{"location":"guide/connection-modes/#headless-vs-gui-mode","title":"Headless vs GUI Mode","text":"<p>Independent of connection mode, FreeCAD itself can run in GUI or headless mode:</p> Feature Headless GUI Object creation Yes Yes Boolean operations Yes Yes Export (STEP, STL, etc.) Yes Yes Screenshots No Yes Object colors/visibility No Yes Camera control No Yes"},{"location":"guide/connection-modes/#starting-freecad","title":"Starting FreeCAD","text":"<p>GUI Mode:</p> <pre><code># Using workbench - just start FreeCAD and click \"Start Bridge\"\njust freecad::run-gui  # From source\n</code></pre> <p>Headless Mode:</p> <pre><code>FreeCADCmd /path/to/blocking_bridge.py\njust freecad::run-headless  # From source\n</code></pre>"},{"location":"guide/connection-modes/#troubleshooting","title":"Troubleshooting","text":""},{"location":"guide/connection-modes/#connection-refused","title":"Connection Refused","text":"<pre><code>Error: Connection refused on localhost:9875\n</code></pre> <p>Solution: Ensure FreeCAD is running with the Robust MCP Bridge started. Check the bridge status in FreeCAD's toolbar.</p>"},{"location":"guide/connection-modes/#embedded-mode-crash-on-macos","title":"Embedded Mode Crash on macOS","text":"<pre><code>SIGSEGV: Segmentation fault\n</code></pre> <p>Solution: Embedded mode doesn't work on macOS. Switch to <code>xmlrpc</code> or <code>socket</code> mode.</p>"},{"location":"guide/connection-modes/#timeout-errors","title":"Timeout Errors","text":"<pre><code>Error: Execution timed out after 30000ms\n</code></pre> <p>Solution: Increase the timeout with <code>FREECAD_TIMEOUT_MS=60000</code> or optimize your operation.</p>"},{"location":"guide/connection-modes/#next-steps","title":"Next Steps","text":"<ul> <li>Tools Reference - Complete API for all 82+ tools</li> <li>MCP Resources - Query FreeCAD state via MCP resources</li> </ul>"},{"location":"guide/macros/","title":"FreeCAD Macros","text":""},{"location":"guide/macros/#freecad-macros","title":"FreeCAD Macros","text":"<p>This project includes standalone FreeCAD macros that work independently of the MCP server, plus MCP tools for creating and managing macros programmatically.</p>"},{"location":"guide/macros/#included-macros","title":"Included Macros","text":""},{"location":"guide/macros/#cutobjectformagnets","title":"CutObjectForMagnets","text":"<p>Cut an object along a plane and add aligned magnet holes with surface collision detection. Perfect for creating 3D printed parts that snap together with embedded magnets.</p> <p>Features:</p> <ul> <li>Interactive plane selection via GUI</li> <li>Automatic magnet hole placement with configurable grid</li> <li>Surface collision detection to avoid invalid hole positions</li> <li>Configurable magnet dimensions and tolerances</li> </ul> <p>Usage:</p> <ol> <li>Select an object in FreeCAD</li> <li>Run the macro</li> <li>Define the cutting plane interactively</li> <li>Configure magnet parameters</li> <li>The macro creates two halves with aligned magnet holes</li> </ol> <p>See CutObjectForMagnets documentation for detailed usage.</p>"},{"location":"guide/macros/#multiexport","title":"MultiExport","text":"<p>Export selected bodies to multiple file formats simultaneously with configurable mesh options.</p> <p>Supported Formats:</p> <ul> <li>STL (ASCII and Binary)</li> <li>STEP</li> <li>3MF</li> <li>OBJ</li> <li>IGES</li> <li>BREP</li> <li>PLY</li> <li>AMF</li> </ul> <p>Usage:</p> <ol> <li>Select one or more bodies/parts</li> <li>Run the macro</li> <li>Select output formats and configure mesh options</li> <li>Choose output directory</li> <li>All exports are created with consistent naming</li> </ol> <p>See MultiExport documentation for detailed usage.</p>"},{"location":"guide/macros/#installing-macros","title":"Installing Macros","text":""},{"location":"guide/macros/#via-freecad-addon-manager","title":"Via FreeCAD Addon Manager","text":"<p>When you install the \"FreeCAD Robust MCP Suite\" addon, the macros are installed automatically.</p>"},{"location":"guide/macros/#manual-installation","title":"Manual Installation","text":"<ol> <li>Download macros from GitHub Releases</li> <li>Copy <code>.FCMacro</code> files to your macro directory:</li> <li>Linux: <code>~/.local/share/FreeCAD/Macro/</code></li> <li>macOS: <code>~/Library/Application Support/FreeCAD/Macro/</code></li> <li>Windows: <code>%APPDATA%\\FreeCAD\\Macro\\</code></li> </ol>"},{"location":"guide/macros/#mcp-macro-tools","title":"MCP Macro Tools","text":"<p>The MCP server provides tools for working with macros programmatically:</p>"},{"location":"guide/macros/#list_macros","title":"list_macros","text":"<p>List available macros in FreeCAD's macro directories.</p> <pre><code>list_macros() -&gt; list[dict]\n</code></pre> <p>Returns: List of macros with name, path, description, and whether it's a system macro.</p>"},{"location":"guide/macros/#run_macro","title":"run_macro","text":"<p>Execute a macro by name with optional arguments.</p> <pre><code>run_macro(\n    macro_name: str,\n    args: dict | None = None\n) -&gt; dict\n</code></pre> <p>Example prompt:</p> <pre><code>\"Run the MultiExport macro\"\n</code></pre>"},{"location":"guide/macros/#create_macro","title":"create_macro","text":"<p>Create a new macro programmatically.</p> <pre><code>create_macro(\n    name: str,\n    code: str,\n    description: str = \"\"\n) -&gt; dict\n</code></pre> <p>Example prompt:</p> <pre><code>\"Create a macro called 'CreateBox' that makes a 10x10x10 box\"\n</code></pre>"},{"location":"guide/macros/#read_macro","title":"read_macro","text":"<p>Read the source code of an existing macro.</p> <pre><code>read_macro(macro_name: str) -&gt; dict\n</code></pre> <p>Example prompt:</p> <pre><code>\"Show me the code for the MultiExport macro\"\n</code></pre>"},{"location":"guide/macros/#delete_macro","title":"delete_macro","text":"<p>Delete a user macro (system macros are protected).</p> <pre><code>delete_macro(macro_name: str) -&gt; dict\n</code></pre>"},{"location":"guide/macros/#create_macro_from_template","title":"create_macro_from_template","text":"<p>Create a macro from predefined templates.</p> <pre><code>create_macro_from_template(\n    name: str,\n    template: str = \"basic\",\n    description: str = \"\"\n) -&gt; dict\n</code></pre> <p>Available templates:</p> Template Description <code>basic</code> Minimal macro with imports <code>part</code> Part workbench operations <code>sketch</code> Sketcher operations <code>gui</code> GUI/dialog template <code>selection</code> Selection handling template <p>Example prompt:</p> <pre><code>\"Create a new macro from the 'sketch' template called 'DrawGear'\"\n</code></pre>"},{"location":"guide/macros/#macro-development-with-ai","title":"Macro Development with AI","text":"<p>The MCP server excels at helping develop FreeCAD macros. Example workflows:</p>"},{"location":"guide/macros/#debugging-an-existing-macro","title":"Debugging an Existing Macro","text":"<pre><code>\"Read the macro 'MyMacro' and explain what it does\"\n</code></pre> <pre><code>\"Run the macro and show me any errors from the FreeCAD console\"\n</code></pre>"},{"location":"guide/macros/#creating-a-new-macro","title":"Creating a New Macro","text":"<pre><code>\"Create a macro that:\n1. Gets all selected objects\n2. Calculates their combined bounding box\n3. Creates a box around them with 5mm clearance\"\n</code></pre>"},{"location":"guide/macros/#modifying-a-macro","title":"Modifying a Macro","text":"<pre><code>\"Read the 'ExportSTL' macro and modify it to also export STEP files\"\n</code></pre>"},{"location":"guide/macros/#best-practices-for-macro-development","title":"Best Practices for Macro Development","text":"<ol> <li>Use templates - Start from <code>create_macro_from_template</code> for proper imports</li> <li>Test incrementally - Use <code>execute_python</code> for testing snippets before creating full macros</li> <li>Check console output - Use <code>get_console_output</code> to debug issues</li> <li>Document your macros - Add docstrings that explain parameters and usage</li> <li>Handle errors gracefully - Wrap operations in try/except blocks</li> </ol>"},{"location":"guide/macros/#next-steps","title":"Next Steps","text":"<ul> <li>Tools Reference - Complete API for all MCP tools</li> <li>Workbench - Robust MCP Bridge Workbench details</li> </ul>"},{"location":"guide/resources/","title":"MCP Resources","text":""},{"location":"guide/resources/#mcp-resources","title":"MCP Resources","text":"<p>The FreeCAD Robust MCP Server exposes several resources that allow AI assistants to query FreeCAD's state without executing code.</p>"},{"location":"guide/resources/#overview","title":"Overview","text":"<p>MCP Resources are read-only endpoints that provide context about FreeCAD's current state. They're useful for:</p> <ul> <li>Understanding what documents and objects exist</li> <li>Getting system information</li> <li>Discovering available capabilities</li> </ul>"},{"location":"guide/resources/#available-resources","title":"Available Resources","text":"<p>The Robust MCP Server provides 12 resources for querying FreeCAD state:</p>"},{"location":"guide/resources/#freecadcapabilities","title":"freecad://capabilities","text":"<p>Returns a comprehensive JSON catalog of all available tools, resources, and prompts.</p> <p>Use case: Understanding what the Robust MCP Server can do.</p> <p>Example response:</p> <pre><code>{\n  \"tools\": {\n    \"execution\": [\"execute_python\", \"get_freecad_version\", ...],\n    \"documents\": [\"create_document\", \"open_document\", ...],\n    ...\n  },\n  \"resources\": [\"freecad://capabilities\", \"freecad://documents\", ...],\n  \"prompts\": [\"freecad-help\", \"create-parametric-part\", ...]\n}\n</code></pre>"},{"location":"guide/resources/#freecadversion","title":"freecad://version","text":"<p>Gets FreeCAD version and build information.</p> <p>Use case: Checking FreeCAD compatibility and environment.</p> <p>Example response:</p> <pre><code>{\n  \"version\": \"1.0.0\",\n  \"build_date\": \"2024-01-15\",\n  \"python_version\": \"3.11.6\",\n  \"gui_available\": true\n}\n</code></pre>"},{"location":"guide/resources/#freecadstatus","title":"freecad://status","text":"<p>Gets current FreeCAD connection and runtime status.</p> <p>Use case: Verifying connection health and mode.</p> <p>Example response:</p> <pre><code>{\n  \"connected\": true,\n  \"mode\": \"xmlrpc\",\n  \"freecad_version\": \"1.0.0\",\n  \"gui_available\": true,\n  \"last_ping_ms\": 12.5,\n  \"error\": null\n}\n</code></pre>"},{"location":"guide/resources/#freecaddocuments","title":"freecad://documents","text":"<p>Lists all open FreeCAD documents with basic information.</p> <p>Use case: Seeing what documents are currently open.</p> <p>Example response:</p> <pre><code>[\n  {\n    \"name\": \"MyPart\",\n    \"label\": \"My Part Design\",\n    \"path\": \"/home/user/projects/mypart.FCStd\",\n    \"is_modified\": true,\n    \"object_count\": 15,\n    \"active_object\": \"Pad\"\n  }\n]\n</code></pre>"},{"location":"guide/resources/#freecaddocumentsname","title":"freecad://documents/{name}","text":"<p>Gets detailed information about a specific document.</p> <p>Use case: Examining a document's contents.</p> <p>Example response:</p> <pre><code>{\n  \"name\": \"MyPart\",\n  \"label\": \"My Part Design\",\n  \"path\": \"/home/user/projects/mypart.FCStd\",\n  \"objects\": [\"Body\", \"Sketch\", \"Pad\", \"Fillet\"],\n  \"is_modified\": true,\n  \"active_object\": \"Fillet\"\n}\n</code></pre>"},{"location":"guide/resources/#freecaddocumentsnameobjects","title":"freecad://documents/{name}/objects","text":"<p>Gets list of objects in a specific document.</p> <p>Use case: Listing all objects in a document with their types.</p> <p>Example response:</p> <pre><code>[\n  {\n    \"name\": \"Body\",\n    \"label\": \"Body\",\n    \"type_id\": \"PartDesign::Body\",\n    \"visibility\": true\n  },\n  {\n    \"name\": \"Sketch\",\n    \"label\": \"Sketch\",\n    \"type_id\": \"Sketcher::SketchObject\",\n    \"visibility\": false\n  }\n]\n</code></pre>"},{"location":"guide/resources/#freecadobjectsdoc_nameobj_name","title":"freecad://objects/{doc_name}/{obj_name}","text":"<p>Gets detailed information about a specific object including properties and shape data.</p> <p>Use case: Inspecting object properties and geometry.</p> <p>Example response:</p> <pre><code>{\n  \"name\": \"Pad\",\n  \"label\": \"Pad\",\n  \"type_id\": \"PartDesign::Pad\",\n  \"properties\": {\n    \"Length\": 10.0,\n    \"Type\": \"Length\",\n    \"Symmetric\": false\n  },\n  \"shape_info\": {\n    \"shape_type\": \"Solid\",\n    \"volume\": 1000.0,\n    \"area\": 600.0,\n    \"is_valid\": true\n  },\n  \"children\": [],\n  \"parents\": [\"Sketch\"],\n  \"visibility\": true\n}\n</code></pre>"},{"location":"guide/resources/#freecadactive-document","title":"freecad://active-document","text":"<p>Gets the currently active document.</p> <p>Use case: Quick access to the document the user is working on.</p> <p>Example response:</p> <pre><code>{\n  \"name\": \"MyPart\",\n  \"label\": \"My Part Design\",\n  \"path\": \"/home/user/projects/mypart.FCStd\",\n  \"objects\": [\"Body\", \"Sketch\", \"Pad\"],\n  \"is_modified\": false,\n  \"active_object\": \"Pad\"\n}\n</code></pre>"},{"location":"guide/resources/#freecadworkbenches","title":"freecad://workbenches","text":"<p>Gets list of available FreeCAD workbenches.</p> <p>Use case: Understanding what workbenches are available.</p> <p>Example response:</p> <pre><code>[\n  {\n    \"name\": \"PartDesignWorkbench\",\n    \"label\": \"Part Design\",\n    \"is_active\": true\n  },\n  {\n    \"name\": \"SketcherWorkbench\",\n    \"label\": \"Sketcher\",\n    \"is_active\": false\n  }\n]\n</code></pre>"},{"location":"guide/resources/#freecadworkbenchesactive","title":"freecad://workbenches/active","text":"<p>Gets the currently active workbench.</p> <p>Use case: Knowing which workbench context is active.</p> <p>Example response:</p> <pre><code>{\n  \"name\": \"PartDesignWorkbench\",\n  \"label\": \"Part Design\"\n}\n</code></pre>"},{"location":"guide/resources/#freecadmacros","title":"freecad://macros","text":"<p>Gets list of available FreeCAD macros.</p> <p>Use case: Discovering available automation macros.</p> <p>Example response:</p> <pre><code>[\n  {\n    \"name\": \"MultiExport\",\n    \"path\": \"/home/user/.local/share/FreeCAD/Macro/MultiExport.FCMacro\",\n    \"description\": \"Export objects to multiple formats\",\n    \"is_system\": false\n  }\n]\n</code></pre>"},{"location":"guide/resources/#freecadconsole","title":"freecad://console","text":"<p>Gets recent FreeCAD console output.</p> <p>Use case: Debugging and seeing FreeCAD messages.</p> <p>Example response:</p> <pre><code>{\n  \"lines\": [\n    \"MCP Bridge started!\",\n    \"  - XML-RPC: localhost:9875\",\n    \"  - Socket: localhost:9876\",\n    \"Document created: MyPart\"\n  ],\n  \"count\": 4\n}\n</code></pre>"},{"location":"guide/resources/#using-resources-in-prompts","title":"Using Resources in Prompts","text":"<p>When talking to an AI assistant connected via MCP, resources are automatically available. The AI can read them to understand context.</p> <p>Example conversation:</p> <pre><code>User: \"What documents do I have open?\"\n\nAI: [Reads freecad://documents resource]\n    \"You have two documents open:\n     1. 'Bracket' - modified, 12 objects\n     2. 'Housing' - saved, 8 objects\"\n</code></pre>"},{"location":"guide/resources/#resources-vs-tools","title":"Resources vs Tools","text":"Aspect Resources Tools Purpose Query state (read-only) Perform actions Side effects None May modify documents Response Data/text Operation result Example <code>freecad://documents</code> <code>create_document()</code>"},{"location":"guide/resources/#resource-uri-summary","title":"Resource URI Summary","text":"URI Description <code>freecad://capabilities</code> All available tools, resources, prompts <code>freecad://version</code> FreeCAD version and build info <code>freecad://status</code> Connection status and mode <code>freecad://documents</code> List of open documents <code>freecad://documents/{name}</code> Single document details <code>freecad://documents/{name}/objects</code> Objects in a document <code>freecad://objects/{doc_name}/{obj_name}</code> Detailed object information <code>freecad://active-document</code> Currently active document <code>freecad://workbenches</code> Available workbenches <code>freecad://workbenches/active</code> Currently active workbench <code>freecad://macros</code> Available macros <code>freecad://console</code> Recent console output"},{"location":"guide/resources/#implementing-custom-resources","title":"Implementing Custom Resources","text":"<p>If you're extending the Robust MCP Server, you can add custom resources:</p> <pre><code>@mcp.resource(\"freecad://custom/{param}\")\nasync def my_custom_resource(param: str) -&gt; str:\n    \"\"\"Return custom data based on param.\"\"\"\n    # Query FreeCAD and return data\n    result = await bridge.execute_python(f\"...\")\n    return json.dumps(result)\n</code></pre>"},{"location":"guide/resources/#next-steps","title":"Next Steps","text":"<ul> <li>Tools Reference - Complete API for MCP tools</li> <li>Connection Modes - How to connect to FreeCAD</li> </ul>"},{"location":"guide/tools/","title":"Tools Overview","text":""},{"location":"guide/tools/#tools-reference","title":"Tools Reference","text":"<p>The FreeCAD Robust MCP Server provides 82+ tools for CAD operations. This page provides a quick reference organized by category.</p> <p>For detailed documentation including parameters and examples, see MCP Tools Reference.</p>"},{"location":"guide/tools/#tool-categories","title":"Tool Categories","text":"Category Tools Description Execution 5 Python execution, debugging Documents 7 Document management Primitives 8 Basic 3D shapes Objects 12 Object manipulation PartDesign 19 Parametric modeling View &amp; Display 11 View control, screenshots (GUI only) Export/Import 7 File format conversion Macros 6 Macro management Utility 7 Undo/redo, parts library"},{"location":"guide/tools/#execution-tools","title":"Execution Tools","text":"Tool Description <code>execute_python</code> Execute arbitrary Python in FreeCAD <code>get_freecad_version</code> Get FreeCAD version and build info <code>get_connection_status</code> Check MCP bridge connection <code>get_console_output</code> Get recent console output <code>get_mcp_server_environment</code> Get Robust MCP Server environment info"},{"location":"guide/tools/#document-tools","title":"Document Tools","text":"Tool Description <code>list_documents</code> List all open documents <code>get_active_document</code> Get currently active document <code>create_document</code> Create a new document <code>open_document</code> Open an existing .FCStd file <code>save_document</code> Save a document <code>close_document</code> Close a document <code>recompute_document</code> Recompute all features"},{"location":"guide/tools/#primitive-tools","title":"Primitive Tools","text":"Tool Description <code>create_box</code> Create a parametric box <code>create_cylinder</code> Create a parametric cylinder <code>create_sphere</code> Create a parametric sphere <code>create_cone</code> Create a parametric cone <code>create_torus</code> Create a torus (donut) <code>create_wedge</code> Create a tapered wedge <code>create_helix</code> Create a helix curve <code>create_object</code> Create any object by type ID"},{"location":"guide/tools/#object-tools","title":"Object Tools","text":"Tool Description <code>list_objects</code> List objects in a document <code>inspect_object</code> Get detailed object information <code>edit_object</code> Modify object properties <code>delete_object</code> Delete an object <code>boolean_operation</code> Union, cut, or intersect objects <code>set_placement</code> Set position and rotation <code>rotate_object</code> Rotate around an axis <code>scale_object</code> Scale uniformly or non-uniformly <code>copy_object</code> Create a copy <code>mirror_object</code> Mirror across a plane <code>get_selection</code> Get selected objects (GUI) <code>set_selection</code> Select objects (GUI) <code>clear_selection</code> Clear selection (GUI)"},{"location":"guide/tools/#partdesign-tools","title":"PartDesign Tools","text":""},{"location":"guide/tools/#bodies-and-sketches","title":"Bodies and Sketches","text":"Tool Description <code>create_partdesign_body</code> Create a PartDesign body <code>create_sketch</code> Create a sketch on a plane/face"},{"location":"guide/tools/#sketch-geometry","title":"Sketch Geometry","text":"Tool Description <code>add_sketch_rectangle</code> Add rectangle to sketch <code>add_sketch_circle</code> Add circle to sketch <code>add_sketch_line</code> Add line to sketch <code>add_sketch_arc</code> Add arc to sketch <code>add_sketch_point</code> Add point to sketch"},{"location":"guide/tools/#additive-features","title":"Additive Features","text":"Tool Description <code>pad_sketch</code> Extrude sketch (additive) <code>revolution_sketch</code> Revolve sketch around axis <code>loft_sketches</code> Loft through multiple sketches <code>sweep_sketch</code> Sweep profile along path"},{"location":"guide/tools/#subtractive-features","title":"Subtractive Features","text":"Tool Description <code>pocket_sketch</code> Cut by extruding sketch <code>groove_sketch</code> Cut by revolving sketch <code>create_hole</code> Create parametric holes"},{"location":"guide/tools/#edge-operations-patterns","title":"Edge Operations &amp; Patterns","text":"Tool Description <code>fillet_edges</code> Add rounded edges <code>chamfer_edges</code> Add beveled edges <code>linear_pattern</code> Repeat feature linearly <code>polar_pattern</code> Repeat feature circularly <code>mirrored_feature</code> Mirror feature across plane"},{"location":"guide/tools/#view-tools","title":"View Tools","text":"<p>GUI Mode Required</p> <p>Tools marked with GUI only work when FreeCAD is running in GUI mode.</p> Tool Mode Description <code>get_screenshot</code> GUI Capture 3D view screenshot <code>set_view_angle</code> Both Set camera angle <code>fit_all</code> Both Fit all objects in view <code>zoom_in</code> GUI Zoom in <code>zoom_out</code> GUI Zoom out <code>set_camera_position</code> GUI Set exact camera position <code>set_object_visibility</code> GUI Show/hide objects <code>set_display_mode</code> GUI Set display mode (wireframe, etc.) <code>set_object_color</code> GUI Change object color <code>list_workbenches</code> Both List available workbenches <code>activate_workbench</code> Both Switch workbench"},{"location":"guide/tools/#export-tools","title":"Export Tools","text":"Tool Description <code>export_step</code> Export to STEP format <code>export_stl</code> Export to STL (3D printing) <code>export_3mf</code> Export to 3MF (modern 3D printing) <code>export_obj</code> Export to OBJ format <code>export_iges</code> Export to IGES format <code>import_step</code> Import STEP files <code>import_stl</code> Import STL files"},{"location":"guide/tools/#macro-tools","title":"Macro Tools","text":"Tool Description <code>list_macros</code> List available macros <code>run_macro</code> Execute a macro <code>create_macro</code> Create a new macro <code>read_macro</code> Read macro source code <code>delete_macro</code> Delete a user macro <code>create_macro_from_template</code> Create from predefined template"},{"location":"guide/tools/#utility-tools","title":"Utility Tools","text":"Tool Description <code>undo</code> Undo last operation <code>redo</code> Redo undone operation <code>get_undo_redo_status</code> Get undo/redo availability <code>recompute</code> Force recompute all objects <code>get_console_log</code> Get console log with levels <code>list_parts_library</code> List parts library <code>insert_part_from_library</code> Insert part from library"},{"location":"guide/tools/#gui-vs-headless-mode","title":"GUI vs Headless Mode","text":"<p>When running in headless mode, GUI-only tools return structured errors instead of crashing:</p> <pre><code>{\n  \"success\": false,\n  \"error\": \"GUI not available - screenshots cannot be captured in headless mode\"\n}\n</code></pre> <p>To check the current mode programmatically:</p> <pre><code>result = await execute_python(\"_result_ = FreeCAD.GuiUp\")\nis_gui_mode = result[\"result\"]\n</code></pre>"},{"location":"guide/tools/#next-steps","title":"Next Steps","text":"<ul> <li>MCP Tools Reference - Detailed documentation with parameters and examples</li> <li>MCP Resources - Query FreeCAD state via MCP resources</li> </ul>"},{"location":"guide/workbench/","title":"Robust MCP Bridge Workbench","text":""},{"location":"guide/workbench/#robust-mcp-bridge-workbench","title":"Robust MCP Bridge Workbench","text":"<p>The Robust MCP Bridge Workbench is a FreeCAD addon that provides the server-side connection point for the Robust MCP Server. It runs inside FreeCAD and exposes XML-RPC and JSON-RPC interfaces.</p>"},{"location":"guide/workbench/#overview","title":"Overview","text":"<p>The workbench provides:</p> <ul> <li>Toolbar controls for starting/stopping the MCP bridge</li> <li>Status indicator showing connection state</li> <li>XML-RPC server on port 9875 (default)</li> <li>JSON-RPC socket server on port 9876 (default)</li> <li>Headless mode support for automation and CI/CD</li> </ul>"},{"location":"guide/workbench/#installation","title":"Installation","text":""},{"location":"guide/workbench/#via-freecad-addon-manager-recommended","title":"Via FreeCAD Addon Manager (Recommended)","text":"<ol> <li>Open FreeCAD</li> <li>Go to Tools &gt; Addon Manager</li> <li>Search for \"FreeCAD Robust MCP Suite\" or \"Robust MCP Bridge\"</li> <li>Click Install</li> <li>Restart FreeCAD</li> </ol>"},{"location":"guide/workbench/#manual-installation","title":"Manual Installation","text":"<p>Download from GitHub Releases and extract to your FreeCAD Mod directory:</p> <ul> <li>Linux: <code>~/.local/share/FreeCAD/Mod/FreecadRobustMCPBridge/</code></li> <li>macOS: <code>~/Library/Application Support/FreeCAD/Mod/FreecadRobustMCPBridge/</code></li> <li>Windows: <code>%APPDATA%\\FreeCAD\\Mod\\FreecadRobustMCPBridge\\</code></li> </ul>"},{"location":"guide/workbench/#gui-mode-usage","title":"GUI Mode Usage","text":""},{"location":"guide/workbench/#starting-the-bridge","title":"Starting the Bridge","text":"<ol> <li>Switch to the MCP Bridge workbench in FreeCAD</li> <li>Click Start Bridge in the toolbar</li> <li>The status indicator turns green when running</li> </ol> <p>You'll see a confirmation message:</p> <pre><code>MCP Bridge started!\n  - XML-RPC: localhost:9875\n  - Socket: localhost:9876\n</code></pre>"},{"location":"guide/workbench/#stopping-the-bridge","title":"Stopping the Bridge","text":"<p>Click Stop Bridge in the toolbar. The status indicator turns red.</p>"},{"location":"guide/workbench/#status-indicator","title":"Status Indicator","text":"Color Status Green Bridge running, accepting connections Red Bridge stopped Yellow Bridge starting/stopping"},{"location":"guide/workbench/#headless-mode-usage","title":"Headless Mode Usage","text":"<p>The workbench includes a blocking bridge script for running in server mode (keeps FreeCAD running).</p>"},{"location":"guide/workbench/#starting-headless-mode","title":"Starting Headless Mode","text":"<p>Linux:</p> <pre><code>freecadcmd ~/.local/share/FreeCAD/Mod/FreecadRobustMCPBridge/freecad_mcp_bridge/blocking_bridge.py\n</code></pre> <p>macOS:</p> <pre><code>/Applications/FreeCAD.app/Contents/Resources/bin/freecadcmd \\\n    ~/Library/Application\\ Support/FreeCAD/Mod/FreecadRobustMCPBridge/freecad_mcp_bridge/blocking_bridge.py\n</code></pre> <p>Using just commands (from source):</p> <pre><code>just freecad::run-headless\n</code></pre>"},{"location":"guide/workbench/#headless-output","title":"Headless Output","text":"<pre><code>FreeCAD version: 1.0.0\n============================================================\nMCP Bridge started in headless mode!\n  - XML-RPC: localhost:9875\n  - Socket: localhost:9876\n\nNote: Screenshot and view features are not available in headless mode.\nPress Ctrl+C to stop.\n============================================================\n</code></pre>"},{"location":"guide/workbench/#features-available-by-mode","title":"Features Available by Mode","text":"Feature GUI Mode Headless Mode Object creation Yes Yes Boolean operations Yes Yes Export (STEP, STL, etc.) Yes Yes Macro execution Yes Yes Document management Yes Yes Screenshots Yes No Object colors Yes No Object visibility Yes No Camera/view control Yes No Interactive selection Yes No <p>GUI-Only Features</p> <p>When a GUI-only feature is requested in headless mode, the Robust MCP Server returns a structured error response instead of crashing: <code>{\"success\": false, \"error\": \"GUI not available - screenshots cannot be captured in headless mode\"}</code></p>"},{"location":"guide/workbench/#configuration","title":"Configuration","text":""},{"location":"guide/workbench/#workbench-preferences-freecad-side","title":"Workbench Preferences (FreeCAD Side)","text":"<p>The workbench has its own preferences that control how the bridge runs inside FreeCAD. Access them via:</p> <ul> <li>Edit \u2192 Preferences \u2192 Robust MCP Bridge (in FreeCAD's main Preferences dialog)</li> <li>Robust MCP Bridge \u2192 MCP Bridge Preferences... (from the workbench menu)</li> </ul> Setting Description Default Auto-start bridge Start bridge automatically on FreeCAD launch Disabled Show status indicator Display status in FreeCAD's status bar Enabled XML-RPC Port Port for XML-RPC connections 9875 Socket Port Port for JSON-RPC socket connections 9876 <p>Port Configuration</p> <p>If you change the ports in the workbench preferences while the bridge is running, it will automatically restart with the new configuration.</p>"},{"location":"guide/workbench/#mcp-server-configuration-client-side","title":"MCP Server Configuration (Client Side)","text":"<p>The external Robust MCP Server (used by Claude Code, etc.) is configured separately using environment variables. These must match the workbench ports:</p> Environment Variable Description Default <code>FREECAD_MODE</code> Connection mode: <code>xmlrpc</code>, <code>socket</code>, <code>embedded</code> <code>xmlrpc</code> <code>FREECAD_XMLRPC_PORT</code> XML-RPC server port 9875 <code>FREECAD_SOCKET_PORT</code> JSON-RPC socket server port 9876 <code>FREECAD_SOCKET_HOST</code> Socket/XML-RPC server hostname <code>localhost</code> <p>Example MCP client configuration with custom ports:</p> <pre><code>{\n  \"mcpServers\": {\n    \"freecad\": {\n      \"command\": \"freecad-mcp\",\n      \"env\": {\n        \"FREECAD_MODE\": \"xmlrpc\",\n        \"FREECAD_XMLRPC_PORT\": \"9877\"\n      }\n    }\n  }\n}\n</code></pre> <p>Choosing a Connection Mode</p> <ul> <li><code>xmlrpc</code> (recommended): Most reliable, works on all platforms. Connects to FreeCAD via XML-RPC protocol.</li> <li><code>socket</code>: Alternative protocol using JSON-RPC over TCP sockets. Also works on all platforms.</li> <li><code>embedded</code>: Direct Python import of FreeCAD (Linux only). Does not require the workbench but crashes on macOS due to library linking issues. Not recommended for production use.</li> </ul> <p>Port Matching Required</p> <p>The ports configured in the MCP Server (via environment variables) must match the ports configured in the FreeCAD workbench preferences. If they don't match, the server won't be able to connect to FreeCAD.</p>"},{"location":"guide/workbench/#architecture","title":"Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    FreeCAD (GUI or Headless)                \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502           Robust MCP Bridge Workbench/Plugin          \u2502  \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510             \u2502  \u2502\n\u2502  \u2502  \u2502 XML-RPC Server  \u2502  \u2502 Socket Server   \u2502             \u2502  \u2502\n\u2502  \u2502  \u2502   (port 9875)   \u2502  \u2502   (port 9876)   \u2502             \u2502  \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518             \u2502  \u2502\n\u2502  \u2502           \u2502                    \u2502                       \u2502  \u2502\n\u2502  \u2502           \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                       \u2502  \u2502\n\u2502  \u2502                    \u2502                                   \u2502  \u2502\n\u2502  \u2502           \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                          \u2502  \u2502\n\u2502  \u2502           \u2502 FreecadMCPPlugin\u2502                          \u2502  \u2502\n\u2502  \u2502           \u2502 (Thread-safe    \u2502                          \u2502  \u2502\n\u2502  \u2502           \u2502  queue system)  \u2502                          \u2502  \u2502\n\u2502  \u2502           \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                          \u2502  \u2502\n\u2502  \u2502                    \u2502                                   \u2502  \u2502\n\u2502  \u2502           \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                          \u2502  \u2502\n\u2502  \u2502           \u2502 FreeCAD Python  \u2502                          \u2502  \u2502\n\u2502  \u2502           \u2502     Console     \u2502                          \u2502  \u2502\n\u2502  \u2502           \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                          \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                           \u25b2\n                           \u2502 Network (localhost)\n                           \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502           FreeCAD Robust MCP Server (External Process)      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>The workbench uses a queue-based thread safety system to ensure FreeCAD operations run on the main GUI thread, preventing crashes from thread-unsafe operations.</p>"},{"location":"guide/workbench/#troubleshooting","title":"Troubleshooting","text":""},{"location":"guide/workbench/#bridge-wont-start","title":"Bridge Won't Start","text":"<p>Problem: Clicking \"Start Bridge\" does nothing or shows an error.</p> <p>Solution:</p> <ol> <li>Check the FreeCAD Python console for error messages</li> <li>Ensure no other process is using ports 9875/9876</li> <li>Try restarting FreeCAD</li> </ol>"},{"location":"guide/workbench/#connection-refused-from-robust-mcp-server","title":"Connection Refused from Robust MCP Server","text":"<p>Problem: Robust MCP Server reports \"Connection refused\"</p> <p>Solution:</p> <ol> <li>Verify the bridge is running (green status indicator)</li> <li>Check that ports match between workbench and Robust MCP Server config</li> <li>If using Docker, ensure you're using <code>host.docker.internal</code> as the host</li> </ol>"},{"location":"guide/workbench/#headless-mode-hangs","title":"Headless Mode Hangs","text":"<p>Problem: <code>FreeCADCmd</code> with headless server never outputs anything</p> <p>Solution:</p> <ol> <li>Ensure you're using <code>FreeCADCmd</code> (not <code>freecad</code>)</li> <li>Check the script path is correct</li> <li>Try running with <code>-c \"print('test')\"</code> first to verify FreeCAD works</li> </ol>"},{"location":"guide/workbench/#included-macros","title":"Included Macros","text":"<p>The addon bundle also includes standalone FreeCAD macros:</p> <ul> <li>MultiExport - Export objects to multiple formats simultaneously</li> <li>CutObjectForMagnets - Cut objects with aligned magnet holes for 3D printing</li> </ul> <p>See Macros for details.</p>"}]}